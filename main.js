(()=>{var __createBinding=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("utils",["require","exports"],(function(e,t){"use strict";function r(e,t,r,i){let o=e/i;return-r*o*(o-2)+t}function i(e,t,r,i,o){return i+(e-t)*(o-i)/(r-t)}function o(e,t,r,o,a){let n=i(e,t,r,o,a);return o<a?n>a?n=a:n<o&&(n=o):n<a?n=a:n>o&&(n=o),n}Object.defineProperty(t,"__esModule",{value:!0}),t.toFixedPrecision=t.createPolygonFromRect=t.getAngleFromVector=t.radiansToDegrees=t.getNormalizedVec=t.getAngleTowards=t.circleRectCollision=t.circleCircleCollision=t.calculateDistance=t.removeIfPresent=t.getRandBetween=t.timeoutPromise=t.normalizeEaseOutClamp=t.normalizeEaseOut=t.normalizeClamp=t.normalize=t.extrapolatePoint=t.truncatePoint3d=t.removeFileExtension=t.pixelToIsoCoords=t.isoToPixelCoords=void 0,t.isoToPixelCoords=(e,t,r)=>[e-t,(e+t)/2-(null!=r?r:0)/2],t.pixelToIsoCoords=(e,t)=>[(2*t+e)/2,(2*t-e)/2],t.removeFileExtension=e=>{let t=e.lastIndexOf(".");return t>-1&&(e=e.slice(0,t)),e},t.truncatePoint3d=e=>[e[0],e[1]],t.extrapolatePoint=e=>[e[0],e[1],0],t.normalize=i,t.normalizeClamp=o,t.normalizeEaseOut=function(e,t,o,a,n){return r(i(e,t,o,0,1),a,n-a,1)},t.normalizeEaseOutClamp=function(e,t,i,a,n){return r(o(e,t,i,0,1),a,n-a,1)},t.timeoutPromise=e=>new Promise(t=>{setTimeout(t,e)}),t.getRandBetween=(e,t)=>Math.floor(Math.random()*(t-e))+e,t.removeIfPresent=(e,t)=>{let r=e.indexOf(t);return r>-1&&(e.splice(r,1),!0)},t.calculateDistance=(e,t)=>{let[r,i,o]=e,[a,n,s]=t;return Math.sqrt(Math.pow(a-r,2)+Math.pow(n-i,2)+Math.pow(s-o,2))},t.circleCircleCollision=(e,r)=>{let[i,o,a]=e,[n,s,A]=r;return t.calculateDistance([i,o,0],[n,s,0])<=a+A},t.circleRectCollision=(e,t)=>{let[r,i,o]=e,a=[r-o,i-o,2*o,2*o],[n,s,A,l]=a,[c,d,u,h]=t,g=n+A/2-(c+u/2),m=s+l/2-(d+h/2),p=(A+u)/2,E=(l+h)/2,f=p*m,w=E*g,C="none";return Math.abs(g)<=p&&Math.abs(m)<=E&&(C=f>w?f>-w?"bottom":"left":f>-w?"right":"top",r<=c&&i<=d?C="top-left":r>=c+u&&i<=d?C="top-right":r<=c&&i>=d+h?C="bottom-left":r>=c+u&&i>=d+h&&(C="bottom-right")),C},t.getAngleTowards=function(e,t){let[r,i]=e,[o,a]=t,n=a-i,s=o-r,A=Math.sqrt(s*s+n*n),l=0;return l=a>=i&&o>=r?180*Math.asin(n/A)/Math.PI+90:a>=i&&o<r?180*Math.asin(n/-A)/Math.PI-90:a<i&&o>r?180*Math.asin(n/A)/Math.PI+90:180*Math.asin(-n/A)/Math.PI-90,l>=360&&(l=360-l),l<0&&(l=360+l),l},t.getNormalizedVec=(e,t)=>{let r=Math.sqrt(e*e+t*t);return[e/r,t/r]},t.radiansToDegrees=e=>e*(180/Math.PI),t.getAngleFromVector=(e,r)=>{if(0==e)return r>0?90:0==r?0:270;if(0==r)return e>=0?0:180;let i=t.radiansToDegrees(Math.atan(r/e));return e<0&&r<0||e<0?i=180+i:r<0&&(i=270+(90+i)),i},t.createPolygonFromRect=e=>{let[t,r,i,o]=e;return[[t,r],[t+i,r],[t+i,r+o],[t,r+o]]},t.toFixedPrecision=(e,t)=>parseFloat(e.toFixed(t))})),define("view/style",["require","exports","preact","picostyle"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyframes=t.style=t.MEDIA_QUERY_PHONE_WIDTH=t.colors=void 0;let o=(i=__importStar(i)).default(r.h);t.colors={BLACK:"#111",WHITE:"#F8F8F8",GREY:"#999",DARKGREY:"#2E3740",BGGREY:"#333",RED:"#BE2633",PINK:"#FFAEB6",GREEN:"#44891A",BROWN:"#A46422",ORANGE:"#FAB40B",PURPLE:"#9964F9",BLUE:"#31A2F2",YELLOW:"#F4B41B",DARKBLUE:"#243F72"},t.MEDIA_QUERY_PHONE_WIDTH="@media (max-width: 850px)",t.style=function(e,t){return o(e)(t)},t.keyframes=e=>i.keyframes(e)})),define("controller/ui-actions",["require","exports","view/ui","model/store","model/generics","model/overworld"],(function(e,t,r,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hideArcadeGame=t.setArcadeGameRunning=t.showArcadeGame=t.setCutsceneText=t.startConversation2=t.startConversation=t.showConversation=t.hideConversation=t.showSections=t.showSection=t.hideSections=t.battleSetChButtonsStatus=t.appReducer=void 0;let n={battleSetChButtonsStatus:(e,t)=>{e.battle.chButtonsEnabled=t},hideSections:e=>{e.sections=[]},showSection:(e,t)=>{e.sections.includes(t)||e.sections.push(t)},setCutsceneState:(e,t)=>{Object.assign(e.cutscene,t)},setArcadeGameState:(e,t)=>{Object.assign(e.arcadeGame,t)}};t.appReducer=function(e,t){let r=Object.assign({},e),i=n[t.action];return i?i(r,t.payload,e):console.error(`Action without a reducer mutation: "${t.action}"`,t),r},t.battleSetChButtonsStatus=e=>{r.getUiInterface().dispatch({action:"battleSetChButtonsStatus",payload:e})},t.hideSections=()=>{r.getUiInterface().dispatch({action:"hideSections"})},t.showSection=(e,i)=>{i&&t.hideSections(),r.getUiInterface().dispatch({action:"showSection",payload:e})},t.showSections=(e,i)=>{i&&t.hideSections(),e.forEach(e=>{r.getUiInterface().dispatch({action:"showSection",payload:e})})},t.hideConversation=()=>{r.getUiInterface().dispatch({action:"setCutsceneState",payload:{visible:!1,portraitLeft:"",portraitLeft2:"",portraitRight:"",portraitRight2:"",portraitCenter:"",portraitLeftEmotion:"",portraitLeft2Emotion:"",portraitRightEmotion:"",portraitRight2Emotion:"",portraitCenterEmotion:""}})},t.showConversation=()=>{r.getUiInterface().dispatch({action:"setCutsceneState",payload:{visible:!0}})},t.startConversation=e=>{t.showSection(i.AppSection.Cutscene,!0),r.getUiInterface().dispatch({action:"setCutsceneState",payload:{portraitCenter:e,portraitLeft:"",portraitRight:"",portraitLeft2:"",portraitRight2:"",portraitLeftEmotion:"",portraitLeft2Emotion:"",portraitRightEmotion:"",portraitRight2Emotion:"",portraitCenterEmotion:"",speaker:i.CutsceneSpeaker.None,visible:!0}})},t.startConversation2=(e,o)=>{t.showSection(i.AppSection.Cutscene,!0),r.getUiInterface().dispatch({action:"setCutsceneState",payload:{portraitLeft:e,portraitRight:o,portraitLeft2:"",portraitRight2:"",portraitCenter:"",portraitLeftEmotion:"",portraitLeft2Emotion:"",portraitRightEmotion:"",portraitRight2Emotion:"",portraitCenterEmotion:"",speaker:i.CutsceneSpeaker.None,speakerName:"",visible:!0}})},t.setCutsceneText=(e,t,i)=>{let o={text:e,visible:!0,speakerName:""};t&&(o.speaker=t,o.speakerName=i),r.getUiInterface().dispatch({action:"setCutsceneState",payload:o})},t.showArcadeGame=e=>{let o={path:e,isGameRunning:!1};r.getUiInterface().dispatch({action:"setArcadeGameState",payload:o}),t.showSection(i.AppSection.ArcadeCabinet,!0)},t.setArcadeGameRunning=e=>{let t={isGameRunning:e};r.getUiInterface().dispatch({action:"setArcadeGameState",payload:t})},t.hideArcadeGame=()=>{r.getUiInterface().dispatch({action:"setArcadeGameState",payload:{path:"",isGameRunning:!1}}),t.showSection(i.AppSection.Debug,!0);let e=o.getCurrentOverworld();a.overworldShow(e)}})),define("controller/arcade-iframe-actions",["require","exports","utils","controller/ui-actions"],(function(e,t,r,i){"use strict";var o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.beginCurrentArcadeGame=t.setScaleWindow=t.setScaleOriginal=t.setButtonUp=t.setButtonDown=t.unmuteAudio=t.muteAudio=t.showControls=t.hideControls=void 0,function(e){e.HIDE_CONTROLS="HIDE_CONTROLS",e.SHOW_CONTROLS="SHOW_CONTROLS",e.MUTE_AUDIO="MUTE_AUDIO",e.UNMUTE_AUDIO="UNMUTE_AUDIO",e.BUTTON_DOWN="BUTTON_DOWN",e.BUTTON_UP="BUTTON_UP",e.SCALE_ORIGINAL="SCALE_ORIGINAL",e.SCALE_WINDOW="SCALE_WINDOW",e.BEGIN_GAME="BEGIN_GAME"}(o||(o={})),function(e){e.GAME_READY="GAME_READY",e.GAME_STARTED="GAME_STARTED",e.GAME_CONCLUDED="GAME_CONCLUDED",e.GAME_CANCELLED="GAME_CANCELLED"}(a||(a={}));let n=window.location.origin;window.addEventListener("message",e=>{try{let t=JSON.parse(e.data);t.action===a.GAME_READY||(t.action===a.GAME_STARTED?i.setArcadeGameRunning(!0):(t.action===a.GAME_CONCLUDED||t.action===a.GAME_CANCELLED)&&i.setArcadeGameRunning(!1))}catch(e){}});let s=async()=>{let e=document.getElementById("arcade-iframe");if(e){let t=e;if(!t.contentWindow)for(let e=0;e<100&&(await r.timeoutPromise(33),!t.contentWindow);e++);return t.contentWindow}return console.error("Cannot get iframe contentWindow."),null},A=async(e,t)=>{e.postMessage(JSON.stringify(t),n)};t.hideControls=async()=>{let e=await s();e&&A(e,{action:o.HIDE_CONTROLS})},t.showControls=async()=>{let e=await s();e&&A(e,{action:o.SHOW_CONTROLS})},t.muteAudio=async()=>{let e=await s();e&&A(e,{action:o.MUTE_AUDIO})},t.unmuteAudio=async()=>{let e=await s();e&&A(e,{action:o.UNMUTE_AUDIO})},t.setButtonDown=async e=>{let t=await s();t&&A(t,{action:o.BUTTON_DOWN,payload:e})},t.setButtonUp=async e=>{let t=await s();t&&A(t,{action:o.BUTTON_UP,payload:e})},t.setScaleOriginal=async()=>{let e=await s();e&&A(e,{action:o.SCALE_ORIGINAL})},t.setScaleWindow=async()=>{let e=await s();e&&A(e,{action:o.SCALE_WINDOW})},t.beginCurrentArcadeGame=async()=>{let e=await s();e&&A(e,{action:o.BEGIN_GAME})}})),define("view/elements/Button",["require","exports","view/style"],(function(e,t,r){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonType=void 0,function(e){e[e.PRIMARY=0]="PRIMARY",e[e.SECONDARY=1]="SECONDARY",e[e.CANCEL=2]="CANCEL",e[e.TOKEN=3]="TOKEN"}(i=t.ButtonType||(t.ButtonType={}));let o={[i.PRIMARY]:r.colors.GREEN,[i.SECONDARY]:r.colors.GREY,[i.CANCEL]:r.colors.RED,[i.TOKEN]:r.colors.ORANGE},a=r.style("div",e=>({textAlign:"center",borderRadius:"0.25rem",padding:"0.5rem",fontSize:"1rem",background:e.disabled?r.colors.DARKGREY:o[e.type],cursor:e.disabled?"default":"pointer",pointerEvents:e.disabled?"none":"all","&:hover":{filter:e.disabled?"unset":"brightness(120%)"},"&:active":{filter:e.disabled?"unset":"brightness(80%)"}}));t.default=a})),define("view/elements/IframeShim",["require","exports","preact","view/style"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let o=i.style("div",e=>({border:"20px solid black",transition:"width 0.25s, height 0.25s, marginTop 0.25s",borderImage:`url(${e.borderImageUrl}) 20 round`,width:e.expanded?"calc(100% - 40px)":e.width,height:e.expanded?"calc(100% - 40px - 4rem)":e.height,marginTop:e.expanded?"4rem":"0",display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:"all",[i.MEDIA_QUERY_PHONE_WIDTH]:{width:e.expanded?"calc(100% - 40px)":e.width,height:e.expanded?"calc(100% - 40px - 7.75rem)":e.height,marginTop:e.expanded?"7.75rem":"0"}}));t.default=e=>r.h(o,{expanded:e.expanded,borderImageUrl:"res/img/arcade-border-1.png",width:e.width,height:e.height},r.h("iframe",{id:e.id,ref:e.ref,src:e.src,style:{border:"0px",width:e.width,height:e.height}}))})),define("view/icons/Arrow",["require","exports","preact"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>r.h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:"left"===e.direction?"transform: rotate(180deg)":""},r.h("g",{transform:"translate(0,0)"},r.h("path",{d:"M106.854 106.002a26.003 26.003 0 0 0-25.64 29.326c16 124 16 117.344 0 241.344a26.003 26.003 0 0 0 35.776 27.332l298-124a26.003 26.003 0 0 0 0-48.008l-298-124a26.003 26.003 0 0 0-10.136-1.994z",fill:e.color,"fill-opacity":"1"})))})),define("view/icons/Help",["require","exports","preact"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>r.h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:"width:100%"},r.h("g",{class:"",transform:"translate(0,0)",style:""},r.h("path",{d:"M256 16C123.45 16 16 123.45 16 256s107.45 240 240 240 240-107.45 240-240S388.55 16 256 16zm0 60c99.41 0 180 80.59 180 180s-80.59 180-180 180S76 355.41 76 256 156.59 76 256 76zm0 30c-66.274 0-120 40.294-120 90 0 30 60 30 60 0 0-16.57 26.862-30 60-30 33.138 0 60 13.43 60 30s-30 15-60 30c-1.875.938-3.478 2.126-4.688 3.28C226.53 244.986 226 271.926 226 286v15c0 16.62 13.38 30 30 30 16.62 0 30-13.38 30-30v-15c0-45 90-40.294 90-90s-53.726-90-120-90zm0 240a30 30 0 0 0-30 30 30 30 0 0 0 30 30 30 30 0 0 0 30-30 30 30 0 0 0-30-30z",fill:e.color,"fill-opacity":"1"})))})),define("view/components/ArcadeCabinet",["require","exports","preact","preact/hooks","view/style","controller/arcade-iframe-actions","view/elements/Button","view/elements/IframeShim","view/icons/Arrow","view/icons/Help","controller/ui-actions","model/generics","view/ui"],(function(e,t,r,i,o,a,n,s,A,l,c,d,u){"use strict";var h;Object.defineProperty(t,"__esModule",{value:!0}),t.ArcadeGamePath=void 0,n=__importStar(n),s=__importDefault(s),A=__importDefault(A),l=__importDefault(l),function(e){e.PRESIDENT="iframes/president/president.html",e.TIC_TAC_TOE="iframes/tic-tac-toe/tic-tac-toe.html",e.INVADERZ="iframes/invaderz/Invaderz.html",e.ELASTICITY="iframes/elasticity/elasticity.html"}(h=t.ArcadeGamePath||(t.ArcadeGamePath={}));let g={default:{title:"No Game Specified",tokensRequired:99,controls:()=>r.h("div",null)},[h.PRESIDENT]:{title:"President",tokensRequired:1,controls:()=>r.h("div",null)},[h.TIC_TAC_TOE]:{title:"Tic Tac Toe",tokensRequired:1,controls:e=>r.h(r.Fragment,null,r.h(Q,{width:"48px",height:"48px",type:"text",onClick:()=>{e.setHelpDialogOpen(!0)}},r.h(l.default,{color:o.colors.YELLOW}))),help:e=>r.h(x,{setOpen:e.setHelpDialogOpen,title:"Tic Tac Toe Help"},r.h("p",null,"On this machine you can play Tic Tac Toe."),r.h("p",null,"Insert a Token to start: 1 token = 5 games"),r.h("p",null,"You are the 'X' player for each game."),r.h("p",null,"Place an 'X' by tapping/clicking the grid area where you wish to play."),r.h("p",null,"Place three 'X' in a row to win the game. You lose if there are three 'O' in a row."),r.h("p",null,"Tickets are awarded based off of the number of times you beat the AI."))},[h.INVADERZ]:{title:"INVADERZ",tokensRequired:1,controls:()=>r.h(r.Fragment,null,r.h(Q,Object.assign({width:"48px",height:"48px"},p(m.Left)),r.h(A.default,{color:o.colors.GREEN,direction:"left"})),r.h(Q,Object.assign({width:"48px",height:"48px"},p(m.Right)),r.h(A.default,{color:o.colors.GREEN,direction:"right"})),r.h(Q,Object.assign({width:"48px",height:"48px",type:"text"},p(m.Space)),"FIRE"),r.h(Q,Object.assign({width:"48px",height:"48px",type:"text"},p(m.Enter)),"START"))},[h.ELASTICITY]:{title:"ELASTICITY",tokensRequired:2,controls:()=>r.h(r.Fragment,null,r.h(Q,Object.assign({width:"48px",height:"48px"},p(m.Left)),r.h(A.default,{color:o.colors.GREEN,direction:"left"})),r.h(Q,Object.assign({width:"48px",height:"48px"},p(m.Right)),r.h(A.default,{color:o.colors.GREEN,direction:"right"})),r.h(Q,Object.assign({width:"48px",height:"48px",type:"text"},p(m.Enter)),"START"))}};var m;!function(e){e[e.Enter=13]="Enter",e[e.Space=32]="Space",e[e.Left=1073741904]="Left",e[e.Right=1073741903]="Right"}(m||(m={}));let p=e=>({onMouseDown:()=>{a.setButtonDown(e)},onMouseUp:()=>{a.setButtonUp(e)},onTouchStart:()=>{a.setButtonDown(e)},onTouchEnd:()=>{a.setButtonUp(e)}}),E=o.style("div",()=>({background:"rgba(0, 0, 0, 0.5)",position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"2",pointerEvents:"all"})),f=o.style("div",()=>({margin:"4px",padding:"4px",minWidth:"50%",maxWidth:"90%",border:"2px solid "+o.colors.BLUE,background:o.colors.BGGREY,color:o.colors.WHITE})),w=o.style("div",()=>({margin:"8px",padding:"8px",fontSize:"32px",textTransform:"uppercase",borderBottom:"2px solid "+o.colors.BLACK})),C=o.style("div",()=>({margin:"8px",padding:"8px",fontSize:"16px"})),y=o.style("div",()=>({display:"flex",justifyContent:"flex-end",padding:"8px",margin:"8px"})),x=e=>r.h(E,null,r.h(f,null,r.h(w,null,e.title),r.h(C,null,e.children),r.h(y,null,r.h(n.default,{type:n.ButtonType.PRIMARY,style:{marginRight:"1rem"},onClick:()=>{e.setOpen(!1)}},"Close")))),B=o.style("div",()=>({background:o.colors.BGGREY,position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"})),b=o.style("div",e=>({position:"fixed",left:"0px",top:"0px",padding:"1rem",width:"100%",background:o.colors.BLACK,display:"flex",justifyContent:"flex-start",alignItems:"center",[o.MEDIA_QUERY_PHONE_WIDTH]:{padding:"2rem"}})),S=o.style("div",()=>({display:"flex",justifyContent:"space-between"})),I=o.style("div",()=>({display:"flex"})),T=o.style("div",()=>({display:"flex",justifyContent:"space-between",alignItems:"center"})),v=o.style("div",()=>({padding:"0px 8px"})),M=o.style("div",()=>({position:"relative",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"100%",pointerEvents:"none"})),R=o.style("div",e=>({border:"20px solid "+o.colors.BLACK,background:o.colors.DARKBLUE,color:o.colors.WHITE,fontSize:"4rem",width:"646px",boxSizing:"border-box",textAlign:"center"})),_=o.style("div",()=>({backgroundImage:"url(res/img/arcade-cabinet.png)",width:"646px",height:"712px",position:"absolute",left:"0px",top:"0px",zIndex:"-1"})),k=o.style("div",e=>({minHeight:"96px",width:"548px",background:o.colors.GREY,textAlign:"center",zIndex:"1",display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:"all",transform:"perspective(512px) rotateX(24deg) translateY(12px)",border:"2px solid "+o.colors.WHITE})),Q=o.style("div",e=>{var t,r;return{tapHighlightColor:"rgba(0, 0, 0, 0)",webkitTapHighlightColor:"rgba(0, 0, 0, 0)",padding:"16px",fontSize:"16px",minWidth:e.width?"unset":"48px",width:e.width,height:e.height,margin:"16px 4px",background:null!==(t=e.backgroundColor)&&void 0!==t?t:o.colors.DARKBLUE,color:null!==(r=e.color)&&void 0!==r?r:o.colors.WHITE,cursor:"pointer",borderRadius:"8px",border:"2px solid "+o.colors.GREY,textAlign:"center",fontFamily:"monospace",userSelect:"none",display:"text"===e.type?"flex":"",justifyContent:"center",touchAction:"manipulate",alignItems:"center","&:hover":{filter:"brightness(120%)"},"&:active":{filter:"brightness(80%)"}}});t.default=e=>{var t;let[o,A]=i.useState(!1),[l,h]=i.useState(!1),[m,p]=i.useState(!1),[E,f]=i.useState(0),w=null!==(t=g[e.game])&&void 0!==t?t:g.default,C=d.getCurrentPlayer().tokens,y=d.getCurrentPlayer().tickets,x=w.tokensRequired,Q=u.getUiInterface().appState.arcadeGame.isGameRunning;return r.h(B,null,r.h(b,null,r.h(S,null,r.h(I,null,r.h(n.default,{type:n.ButtonType.CANCEL,onClick:()=>{c.hideArcadeGame()},style:{marginRight:"1rem"}},"Back"),r.h(n.default,{type:n.ButtonType.PRIMARY,style:{marginRight:"1rem"},onClick:()=>{let e=!o;A(e),e?(a.showControls(),a.setScaleWindow()):(a.hideControls(),a.setScaleOriginal())}},o?"Contract":"Expand"),r.h(n.default,{type:n.ButtonType.PRIMARY,style:{marginRight:"1rem"},onClick:()=>{let e=!l;h(e),e?a.muteAudio():a.unmuteAudio()}},l?"Unmute":"Mute")),r.h(T,null,r.h(v,null,"TOKENS: ",C-E),r.h(v,null,"TICKETS: ",y),r.h(v,null,r.h(n.default,{disabled:Q||C<=0,style:{width:"140px"},type:E===x?n.ButtonType.PRIMARY:n.ButtonType.TOKEN,onClick:()=>{E===x?(f(0),a.beginCurrentArcadeGame()):f(E+1)}},E===x?"PLAY":"Insert Token")),r.h(v,null,r.h(n.default,{disabled:0===E,type:n.ButtonType.CANCEL,onClick:()=>{f(0)}},"Eject Tokens")),r.h(v,null,"TOKENS INSERTED: ",E,"/",x)))),r.h(M,null,o?null:r.h(R,null,w.title),r.h("div",{style:{transition:"height 0.25s",height:o?"0px":"32px",width:"646px",position:"relative"}},o?null:r.h(_,null)),e.game?r.h(s.default,{id:"arcade-iframe",src:e.game+"?cabinet=true&mute=true",width:o?"100%":"512px",height:o?"100%":"512px",expanded:o}):r.h("div",null,"No game was specified."),o?null:r.h(k,{id:"controls-arcade"},r.h(w.controls,{setHelpDialogOpen:p})),(null==w?void 0:w.help)&&m?r.h(w.help,{setHelpDialogOpen:p}):null))}})),define("model/store",["require","exports"],(function(e,t){"use strict";var r,i;Object.defineProperty(t,"__esModule",{value:!0}),t.AppStateInitial=t.CutsceneSpeaker=t.AppSection=void 0,function(e){e.BattleUI="battleMenu",e.BattleVictory="battleVictory",e.BattleDefeated="battleDefeated",e.Cutscene="cutscene",e.Debug="debug",e.ArcadeCabinet="arcadeCabinet"}(r=t.AppSection||(t.AppSection={})),function(e){e.Left="left",e.Left2="left2",e.Right="right",e.Right2="right2",e.Center="center",e.None="none"}(i=t.CutsceneSpeaker||(t.CutsceneSpeaker={})),t.AppStateInitial={sections:[r.Debug],cutscene:{text:"",speaker:i.None,speakerName:"",visible:!0,portraitLeft:"",portraitLeftEmotion:"",portraitLeft2:"",portraitLeft2Emotion:"",portraitRight:"",portraitRightEmotion:"",portraitRight2:"",portraitRight2Emotion:"",portraitCenter:"",portraitCenterEmotion:""},battle:{chButtonsEnabled:!0},arcadeGame:{path:"",isGameRunning:!1}}})),define("lib/webgl-canvas",["require","exports"],(function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){function i(e){return e>0&&0==(e-1&e)}function o(e){return this.clearStack(e)}var a=[1,0,0,0,1,0,0,0,1],n=function(e,t){var r=e[0],i=e[1],o=e[2],a=e[3],n=e[4],s=e[5],A=e[6],l=e[7],c=e[8],d=t[0],u=t[1],h=t[2],g=t[3],m=t[4],p=t[5],E=t[6],f=t[7],w=t[8];t[0]=d*r+g*i+E*o,t[1]=u*r+m*i+f*o,t[2]=h*r+p*i+w*o,t[3]=d*a+g*n+E*s,t[4]=u*a+m*n+f*s,t[5]=h*a+p*n+w*s,t[6]=d*A+g*l+E*c,t[7]=u*A+m*l+f*c,t[8]=h*A+p*l+w*c};o.prototype.clearStack=function(e){this.m_stack=[],this.m_cache=[],this.c_stack=0,this.valid=0,this.result=null;for(var t=0;t<16;t++)this.m_stack[t]=this.getIdentity();void 0!==e?this.m_stack[0]=e:this.setIdentity()},o.prototype.setIdentity=function(){this.m_stack[this.c_stack]=this.getIdentity(),this.valid===this.c_stack&&this.c_stack&&this.valid--},o.prototype.getIdentity=function(){return[1,0,0,0,1,0,0,0,1]},o.prototype.getResult=function(){if(!this.c_stack)return this.m_stack[0];var e=a;this.valid>this.c_stack-1&&(this.valid=this.c_stack-1);for(var t=this.valid;t<this.c_stack+1;t++)e=n(this.m_stack[t],e),this.m_cache[t]=e;return this.valid=this.c_stack-1,this.result=this.m_cache[this.c_stack],this.result},o.prototype.pushMatrix=function(){this.c_stack++,this.m_stack[this.c_stack]=this.getIdentity()},o.prototype.popMatrix=function(){0!==this.c_stack&&this.c_stack--};var s=o.prototype.getIdentity();o.prototype.translate=function(e,t){s[6]=e,s[7]=t,n(s,this.m_stack[this.c_stack])};var A=o.prototype.getIdentity();o.prototype.scale=function(e,t){A[0]=e,A[4]=t,n(A,this.m_stack[this.c_stack])};var l,c,d=o.prototype.getIdentity();o.prototype.rotate=function(t){var r,i;r=e.sin(-t),i=e.cos(-t),d[0]=i,d[3]=r,d[1]=-r,d[4]=i,n(d,this.m_stack[this.c_stack])},(r=function(e,t){var r;this.canvas=e,this.options=t||{},this.gl=void 0,this.fs=void 0,this.vs=void 0,this.shaderProgram=void 0,this.transform=new o,this.shaderPool=[],this.maxTextureSize=void 0,e.gl2d=this,e.$getContext=e.getContext,e.getContext=(r=this,function(t){if(!r.options.force&&"webgl-2d"!==t||0===e.width||0===e.height)return r.canvas.$getContext(t);if(r.gl)return r.gl;var i=r.gl=r.canvas.$getContext("experimental-webgl");return r.initShaders(),r.initBuffers(),r.initCanvas2DAPI(),i.viewport(0,0,r.canvas.width,r.canvas.height),i.clearColor(0,0,0,1),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),r.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),i}),this.postInit()}).enable=function(e,t){return e.gl2d||new r(e,t)},r.prototype.getFragmentShaderSource=function(e){return["#ifdef GL_ES\nprecision highp float;\n#endif","#define hasTexture "+(1&e?"1":"0"),"#define hasCrop "+(2&e?"1":"0"),"varying vec4 vColor;\n#if hasTexture\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n#if hasCrop\nuniform vec4 uCropSource;\n#endif\n#endif\nvoid main(void) {\n#if hasTexture\n#if hasCrop\n//gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x * uCropSource.z, vTextureCoord.y * uCropSource.w) + uCropSource.xy) / vec4(0.9, 0.9, 0.9, 1);\ngl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x * uCropSource.z, vTextureCoord.y * uCropSource.w) + uCropSource.xy);\n#else\ngl_FragColor = texture2D(uSampler, vTextureCoord);\n#endif\n#else\ngl_FragColor = vColor;\n#endif\n}"].join("\n")},r.prototype.getVertexShaderSource=function(e,t){return["#define hasTexture "+(1&t?"1":"0"),"attribute vec4 aVertexPosition;\n#if hasTexture\nvarying vec2 vTextureCoord;\n#endif\nuniform vec4 uColor;","uniform mat3 uTransforms["+(e=e||1)+"];","varying vec4 vColor;","let mat4 pMatrix = mat4("+2/this.canvas.width+",0,0,0, 0,"+-2/this.canvas.height+",0,0, 0,0,1.0,1.0, -1.0,1.0,0,0);","mat3 crunchStack(void) {\nmat3 result = uTransforms[0];","for (int i = 1; i < "+e+"; ++i) {","result = uTransforms[i] * result;\n}\nreturn result;\n}\nvoid main(void) {\nvec3 position = crunchStack() * vec3(aVertexPosition.x, aVertexPosition.y, 1.0);\ngl_Position = pMatrix * vec4(position, 1.0);\nvColor = uColor;\n#if hasTexture\nvTextureCoord = aVertexPosition.zw;\n#endif\n}"].join("\n")},r.prototype.initShaders=function(e,t){var r=this.gl;t=t||0;var i=this.shaderPool[e=e||1];if(i||(i=this.shaderPool[e]=[]),i=i[t])return r.useProgram(i),this.shaderProgram=i,i;var o=this.fs=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(this.fs,this.getFragmentShaderSource(t)),r.compileShader(this.fs),!r.getShaderParameter(this.fs,r.COMPILE_STATUS))throw"fragment shader error: "+r.getShaderInfoLog(this.fs);var a=this.vs=r.createShader(r.VERTEX_SHADER);if(r.shaderSource(this.vs,this.getVertexShaderSource(e,t)),r.compileShader(this.vs),!r.getShaderParameter(this.vs,r.COMPILE_STATUS))throw"vertex shader error: "+r.getShaderInfoLog(this.vs);var n=this.shaderProgram=r.createProgram();if(n.stackDepth=e,r.attachShader(n,o),r.attachShader(n,a),r.linkProgram(n),!r.getProgramParameter(n,r.LINK_STATUS))throw"Could not initialise shaders.";r.useProgram(n),n.vertexPositionAttribute=r.getAttribLocation(n,"aVertexPosition"),r.enableVertexAttribArray(n.vertexPositionAttribute),n.uColor=r.getUniformLocation(n,"uColor"),n.uSampler=r.getUniformLocation(n,"uSampler"),n.uCropSource=r.getUniformLocation(n,"uCropSource"),n.uTransforms=[];for(var s=0;s<e;++s)n.uTransforms[s]=r.getUniformLocation(n,"uTransforms["+s+"]");return this.shaderPool[e][t]=n,n};var u=new Float32Array([0,0,0,0,0,1,0,1,1,1,1,1,1,0,1,0]);r.prototype.initBuffers=function(){var e=this.gl;l=e.createBuffer(),e.createBuffer(),c=e.createBuffer(),e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW)},r.instances=[],r.prototype.postInit=function(){r.instances.push(this)},r.prototype.initCanvas2DAPI=function(){function e(t){var r,i,o,a,n,s,A=[];if(r=u.exec(t)){if(a=r[1],n=parseFloat(r[8]),a&&isNaN(n)||!a&&!isNaN(n))return!1;s=r[3];for(var l=2;l<8;l+=2){if(i=r[l],(o=r[l+1])!==s)return!1;i=o?(i=i>100?1:i/100)<0?0:i:(i=i>255?1:i/255)<0?0:i,A.push(i)}A.push(a?n:1)}else if(r=h.exec(t))a=r[1],n=parseFloat(r[5]),A=function(e,t,r,i){function o(e){return 6*e<1?a+(n-a)*e*6:2*e<1?n:3*e<2?a+(n-a)*(2/3-e)*6:a}var a,n;return t=(t=t>100?1:t/100)<0?0:t,a=2*(r=(r=r>100?1:r/100)<0?0:r)-(n=r<=.5?r*(t+1):r+t-r*t),[o((e=(e%360+360)%360/360)+1/3),o(e),o(e-1/3),i]}(r[2],r[3],r[4],parseFloat(a&&n?n:1));else if(r=g.exec(t)){var c=parseInt(r[1],16);A=[((16711680&c)>>16)/255,((65280&c)>>8)/255,(255&c)/255,1]}else if(r=m.exec(t))A=e("#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]);else if(t.toLowerCase()in p)A=e(p[t.toLowerCase()]);else{if("transparent"!==t.toLowerCase())return!1;A=[0,0,0,0]}return A}function t(e){return"rgba("+255*e[0]+", "+255*e[1]+", "+255*e[2]+", "+parseFloat(e[3])+")"}function r(e){for(var t=n.transform.m_stack,r=0,i=n.transform.c_stack+1;r<i;++r)s.uniformMatrix3fv(e.uTransforms[r],!1,t[i-1-r])}function o(e,t){this.closed=!1,this.verts=[e,t,0,0]}function a(e){if(this.obj=s.createTexture(),this.index=x.push(this),y.push(e),e.width>n.maxTextureSize||e.height>n.maxTextureSize){var t=document.createElement("canvas");t.width=e.width>n.maxTextureSize?n.maxTextureSize:e.width,t.height=e.height>n.maxTextureSize?n.maxTextureSize:e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),e=t}s.bindTexture(s.TEXTURE_2D,this.obj),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),i(e.width)&&i(e.height)?(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR_MIPMAP_LINEAR),s.generateMipmap(s.TEXTURE_2D)):s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.bindTexture(s.TEXTURE_2D,null)}var n=this,s=this.gl,A=document.createElement("canvas");A.width=n.canvas.width,A.height=n.canvas.height;var d=A.getContext("2d"),u=/^rgb(a)?\(\s*(-?[\d]+)(%)?\s*,\s*(-?[\d]+)(%)?\s*,\s*(-?[\d]+)(%)?\s*,?\s*(-?[\d\.]+)?\s*\)$/,h=/^hsl(a)?\(\s*(-?[\d\.]+)\s*,\s*(-?[\d\.]+)%\s*,\s*(-?[\d\.]+)%\s*,?\s*(-?[\d\.]+)?\s*\)$/,g=/^#([0-9A-Fa-f]{6})$/,m=/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/,p={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},E={},f=[];E.fillStyle=[0,0,0,1],Object.defineProperty(s,"fillStyle",{get:function(){return t(E.fillStyle)},set:function(t){E.fillStyle=e(t)||E.fillStyle}}),E.strokeStyle=[0,0,0,1],Object.defineProperty(s,"strokeStyle",{get:function(){return t(E.strokeStyle)},set:function(t){E.strokeStyle=e(t)||drawStyle.strokeStyle}}),s.$lineWidth=s.lineWidth,E.lineWidth=1,Object.defineProperty(s,"lineWidth",{get:function(){return E.lineWidth},set:function(e){s.$lineWidth(e),E.lineWidth=e}}),E.lineCap="butt",Object.defineProperty(s,"lineCap",{get:function(){return E.lineCap},set:function(e){E.lineCap=e}}),E.lineJoin="miter",Object.defineProperty(s,"lineJoin",{get:function(){return E.lineJoin},set:function(e){E.lineJoin=e}}),E.miterLimit=10,Object.defineProperty(s,"miterLimit",{get:function(){return E.miterLimit},set:function(e){E.miterLimit=e}}),E.shadowOffsetX=0,Object.defineProperty(s,"shadowOffsetX",{get:function(){return E.shadowOffsetX},set:function(e){E.shadowOffsetX=e}}),E.shadowOffsetY=0,Object.defineProperty(s,"shadowOffsetY",{get:function(){return E.shadowOffsetY},set:function(e){E.shadowOffsetY=e}}),E.shadowBlur=0,Object.defineProperty(s,"shadowBlur",{get:function(){return E.shadowBlur},set:function(e){E.shadowBlur=e}}),E.shadowColor="rgba(0, 0, 0, 0.0)",Object.defineProperty(s,"shadowColor",{get:function(){return E.shadowColor},set:function(e){E.shadowColor=e}}),E.font="10px sans-serif",Object.defineProperty(s,"font",{get:function(){return E.font},set:function(e){d.font=e,E.font=e}}),E.textAlign="start",Object.defineProperty(s,"textAlign",{get:function(){return E.textAlign},set:function(e){E.textAlign=e}}),E.textBaseline="alphabetic",Object.defineProperty(s,"textBaseline",{get:function(){return E.textBaseline},set:function(e){E.textBaseline=e}}),E.globalAlpha=1,Object.defineProperty(s,"globalAlpha",{get:function(){return E.globalAlpha},set:function(e){E.globalAlpha=e}}),E.globalCompositeOperation="source-over",Object.defineProperty(s,"globalCompositeOperation",{get:function(){return E.globalCompositeOperation},set:function(e){E.globalCompositeOperation=e}}),s.fillText=function(e,t,r){},s.strokeText=function(){},s.measureText=function(){return 1};var w=document.createElement("canvas").getContext("2d");s.save=function(){n.transform.pushMatrix(),f.push({fillStyle:[E.fillStyle[0],E.fillStyle[1],E.fillStyle[2],E.fillStyle[3]],strokeStyle:[E.strokeStyle[0],E.strokeStyle[1],E.strokeStyle[2],E.strokeStyle[3]],globalAlpha:E.globalAlpha,globalCompositeOperation:E.globalCompositeOperation,lineCap:E.lineCap,lineJoin:E.lineJoin,lineWidth:E.lineWidth,miterLimit:E.miterLimit,shadowColor:E.shadowColor,shadowBlur:E.shadowBlur,shadowOffsetX:E.shadowOffsetX,shadowOffsetY:E.shadowOffsetY,textAlign:E.textAlign,font:E.font,textBaseline:E.textBaseline})},s.restore=function(){n.transform.popMatrix(),f.length&&(E=f.pop())},s.translate=function(e,t){n.transform.translate(e,t)},s.rotate=function(e){n.transform.rotate(e)},s.scale=function(e,t){n.transform.scale(e,t)},s.createImageData=function(e,t){return w.createImageData(e,t)},s.getImageData=function(e,t,r,i){var o=w.createImageData(r,i),a=new Uint8Array(r*i*4);s.readPixels(e,t,r,i,s.RGBA,s.UNSIGNED_BYTE,a);for(var n=4*r,A=i,l=0,c=A/2;l<c;++l)for(var d=0,u=n;d<u;++d){var h=l*n+d,g=(A-l-1)*n+d;o.data[h]=a[g],o.data[g]=a[h]}return o},s.putImageData=function(e,t,r){s.drawImage(e,t,r)},s.transform=function(e,t,r,i,o,a){var s=n.transform.m_stack[n.transform.c_stack];s[0]*=e,s[1]*=r,s[2]*=o,s[3]*=t,s[4]*=i,s[5]*=a,s[6]=0,s[7]=0},s.setTransform=function(e,t,r,i,o,a){n.transform.setIdentity(),s.transform.apply(this,arguments)},s.fillRect=function(e,t,i,o){var a=n.transform,A=n.initShaders(a.c_stack+2,0);s.bindBuffer(s.ARRAY_BUFFER,l),s.vertexAttribPointer(A.vertexPositionAttribute,4,s.FLOAT,!1,0,0),a.pushMatrix(),a.translate(e,t),a.scale(i,o),r(A),s.uniform4f(A.uColor,E.fillStyle[0],E.fillStyle[1],E.fillStyle[2],E.fillStyle[3]),s.drawArrays(s.TRIANGLE_FAN,0,4),a.popMatrix()},s.strokeRect=function(e,t,i,o){var a=n.transform,A=n.initShaders(a.c_stack+2,0);s.bindBuffer(s.ARRAY_BUFFER,l),s.vertexAttribPointer(A.vertexPositionAttribute,4,s.FLOAT,!1,0,0),a.pushMatrix(),a.translate(e,t),a.scale(i,o),r(A),s.uniform4f(A.uColor,E.strokeStyle[0],E.strokeStyle[1],E.strokeStyle[2],E.strokeStyle[3]),s.drawArrays(s.LINE_LOOP,0,4),a.popMatrix()},s.clearRect=function(e,t,r,i){};var C=[];s.beginPath=function(){C.length=0},s.closePath=function(){if(C.length){var e=C[C.length-1],t=e.verts[0],r=e.verts[1];e.closed=!0;var i=new o(t,r);C.push(i)}},s.moveTo=function(e,t){C.push(new o(e,t))},s.lineTo=function(e,t){C.length?C[C.length-1].verts.push(e,t,0,0):s.moveTo(e,t)},s.quadraticCurveTo=function(e,t,r,i){},s.bezierCurveTo=function(e,t,r,i,o,a){},s.arcTo=function(){},s.rect=function(e,t,r,i){s.moveTo(e,t),s.lineTo(e+r,t),s.lineTo(e+r,t+i),s.lineTo(e,t+i),s.closePath()},s.arc=function(e,t,r,i,o,a){},s.fill=function(){for(var e=0;e<C.length;e++)t=e,i=void 0,o=n.initShaders((i=n.transform).c_stack+2,0),a=C[t].verts,s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(a),s.STATIC_DRAW),s.vertexAttribPointer(o.vertexPositionAttribute,4,s.FLOAT,!1,0,0),i.pushMatrix(),r(o),s.uniform4f(o.uColor,E.fillStyle[0],E.fillStyle[1],E.fillStyle[2],E.fillStyle[3]),s.drawArrays(s.TRIANGLE_FAN,0,a.length/4),i.popMatrix();var t,i,o,a},s.stroke=function(){for(var e=0;e<C.length;e++)t=e,i=void 0,o=n.initShaders((i=n.transform).c_stack+2,0),A=(a=C[t]).verts,s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(A),s.STATIC_DRAW),s.vertexAttribPointer(o.vertexPositionAttribute,4,s.FLOAT,!1,0,0),i.pushMatrix(),r(o),s.uniform4f(o.uColor,E.strokeStyle[0],E.strokeStyle[1],E.strokeStyle[2],E.strokeStyle[3]),s.drawArrays(a.closed?s.LINE_LOOP:s.LINE_STRIP,0,A.length/4),i.popMatrix();var t,i,o,a,A},s.clip=function(){},s.isPointInPath=function(){},s.drawFocusRing=function(){};var y=[],x=[];s.drawImage=function(e,t,i,o,A,c,d,u,h){var g=n.transform;g.pushMatrix();var m=1,p=!1;3===arguments.length?(g.translate(t,i),g.scale(e.width,e.height)):5===arguments.length?(g.translate(t,i),g.scale(o,A)):9===arguments.length&&(g.translate(c,d),g.scale(u,h),m|=2,p=!0);var E,f=n.initShaders(g.c_stack,m),w=y.indexOf(e);E=-1!==w?x[w]:new a(e),p&&s.uniform4f(f.uCropSource,t/e.width,i/e.height,o/e.width,A/e.height),s.bindBuffer(s.ARRAY_BUFFER,l),s.vertexAttribPointer(f.vertexPositionAttribute,4,s.FLOAT,!1,0,0),s.bindTexture(s.TEXTURE_2D,E.obj),s.activeTexture(s.TEXTURE0),s.uniform1i(f.uSampler,0),r(f),s.drawArrays(s.TRIANGLE_FAN,0,4),g.popMatrix()}}}(Math),t.default=r})),define("model/canvas",["require","exports","lib/webgl-canvas"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getScreenSize=t.getDrawScale=t.setDrawScale=t.getCtx=t.getCanvas=t.createCanvas=t.CANVAS_ID_OUTER=t.CANVAS_ID=t.SCREEN_WIDTH=void 0,r=__importDefault(r),t.SCREEN_WIDTH=512,t.CANVAS_ID="canv",t.CANVAS_ID_OUTER="canv-outer";let i=null,o=null,a=1;t.createCanvas=(e,t,i)=>{let o,a=document.createElement("canvas");return a.width=e||1,a.height=t||1,i?(r.default.enable(a),o=a.getContext("webgl-2d")):o=a.getContext("2d"),[a,o,e,t]},t.getCanvas=e=>{if("outer"===e&&o)return o;if(i)return i;{let[e,r]=t.createCanvas(t.SCREEN_WIDTH,t.SCREEN_WIDTH);e.id=t.CANVAS_ID,r.imageSmoothingEnabled=!1;let o=document.getElementById("canvas-container");if(o){o.appendChild(e);let[r,i]=t.createCanvas(t.SCREEN_WIDTH,t.SCREEN_WIDTH);r.id=t.CANVAS_ID_OUTER,i.imageSmoothingEnabled=!1,o.appendChild(r)}return i=e,e}},t.getCtx=e=>{var r;let i=t.getCanvas(e);return null!==(r=i.getContext("2d"))&&void 0!==r?r:i.getContext("webgl-2d")};let n=(e,r)=>{a=r,e&&(e.style.width=t.SCREEN_WIDTH*a+"",e.style.height=t.SCREEN_WIDTH*a+"",r>2&&(e.style.position="relative",e.style.left=-parseInt(e.style.width)/4+"px",e.style.top=-parseInt(e.style.height)/4+"px"))};t.setDrawScale=e=>{a=e;let r=document.getElementById(t.CANVAS_ID);r&&n(r,e);let i=document.getElementById(t.CANVAS_ID_OUTER);i&&(n(i,e),i.style.position="absolute",i.style.left="0px",i.style.top="0px",o=i)},t.getDrawScale=()=>a,t.getScreenSize=()=>t.SCREEN_WIDTH})),define("view/icons/Cursor",["require","exports","preact"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>r.h("svg",{style:"transform: rotate(75deg)",stroke:e.color,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.h("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M21.1568 4.15379C21.5068 3.32658 20.6734 2.49321 19.8462 2.84319L3.46966 9.77172C2.60871 10.136 2.67381 11.3772 3.56814 11.6494L8.7707 13.2327C9.72737 13.5239 10.4761 14.2726 10.7672 15.2293L12.3506 20.4318C12.6228 21.3262 13.864 21.3913 14.2283 20.5303L21.1568 4.15379ZM19.0669 1.00125C21.5485 -0.048667 24.0486 2.45145 22.9987 4.93307L16.0702 21.3096C14.9775 23.8924 11.2538 23.6971 10.4373 21.0142L8.85389 15.8116C8.75683 15.4927 8.50727 15.2432 8.18837 15.1461L2.98581 13.5627C0.302836 12.7462 0.107539 9.02252 2.69038 7.92979L19.0669 1.00125Z",fill:e.color}))})),define("view/icons/Close",["require","exports","preact"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>r.h("svg",{xmlns:"http://www.w3.org/2000/svg",id:"svg2",viewBox:"0 0 84.853 84.853",version:"1.0"},r.h("g",{id:"layer1",transform:"translate(-153.29 -132.79)"},r.h("g",{id:"g2762",transform:"matrix(.70711 -.70711 .70711 .70711 -66.575 189.71)",fill:e.color},r.h("rect",{id:"rect1872",y:"165.22",width:"100",x:"145.71",height:"20"}),r.h("rect",{id:"rect1874",transform:"rotate(90)",height:"20",width:"100",y:"-205.71",x:"125.22"}))))})),define("view/elements/VerticalMenu",["require","exports","preact","preact/hooks","view/style","view/icons/Cursor","view/icons/Close"],(function(e,t,r,i,o,a,n){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.MenuLineHeight=void 0,a=__importDefault(a),n=__importDefault(n),function(e){e[e.SMALL=0]="SMALL",e[e.MEDIUM=1]="MEDIUM",e[e.LARGE=2]="LARGE"}(s=t.MenuLineHeight||(t.MenuLineHeight={}));let A={backgroundColor:o.colors.BLACK,borderColor:o.colors.WHITE,lineHeight:s.MEDIUM,startingIndex:0},l=e=>{switch(e){case s.SMALL:return{fontSize:"12px",padding:"0.25rem",minHeight:"12px"};case s.MEDIUM:return{fontSize:"16px",padding:"0.5rem",minHeight:"16px"};case s.LARGE:return{fontSize:"24px",padding:"1rem",minHeight:"24px"}}},c=o.style("div",e=>({background:e.backgroundColor,position:"relative",width:e.width||"100%",border:"4px double "+e.borderColor,boxSizing:"border-box",transition:e.open?"transform 0.15s ease-out":"unset",transform:e.open?"scale(1.0)":"scale(0.0)"})),d=o.style("div",e=>({position:"relative","&:not(:last-child)":{borderBottom:"2px solid "+e.borderColor}})),u=o.style("div",e=>Object.assign(Object.assign({textAlign:"center"},l(e.lineHeight)),{color:"white",backgroundColor:e.backgroundColor,cursor:"pointer",filter:e.active?"brightness(80%)":"",transform:e.active?"translateY(2px)":""})),h=o.keyframes({"0%":{transform:"translateX(-5px)"},"20%":{transform:"translateX(0px)"},"100%":{transform:"translateX(-5px)"}}),g=o.style("div",()=>({color:o.colors.WHITE,position:"absolute",top:"0px",left:"-32px",animation:h+" 500ms linear infinite"})),m=()=>r.h(g,null,r.h(a.default,{color:o.colors.BLUE})),p=o.style("div",e=>({textAlign:"center",position:"relative",background:o.colors.DARKBLUE,display:"flex",justifyContent:e.title?"space-around":"center",alignItems:"baseline"})),E=o.style("div",e=>Object.assign(Object.assign({},l(e.lineHeight)),{width:"1rem",cursor:"pointer",background:e.backgroundColor,borderRight:"2px solid "+o.colors.WHITE,marginTop:"0.15rem","&:hover":{filter:"brightness(120%)"},"&:active":{filter:"brightness(80%)"}})),f=o.style("div",e=>Object.assign(Object.assign({},l(e.lineHeight)),{width:"calc(100% - 34px)"})),w=e=>{var t;let i=null!==(t=e.lineHeight)&&void 0!==t?t:s.MEDIUM;return r.h(p,{title:e.title},e.onClick?r.h(E,{backgroundColor:e.backgroundColor,onClick:e.onClick,lineHeight:i},r.h(n.default,{color:o.colors.RED})):null,r.h(f,{lineHeight:i},e.title||""))},C=function(e){var t,a,n;let[{cursorIndex:A,active:l},h]=i.useReducer(({cursorIndex:t,active:r},i)=>{var o;let a=t,n=r;return"Increment"===i.type?a=(a+1)%e.items.length:"Decrement"===i.type?a=(a-1+e.items.length)%e.items.length:"Set"===i.type?r||(a=null!==(o=i.payload)&&void 0!==o?o:0):"Select"===i.type?r||(n=!0,setTimeout(()=>{h({type:"SelectInactive"})},100)):"SelectInactive"===i.type&&(e.onItemClick(e.items[t].value),n=!1),{cursorIndex:a,active:n}},{cursorIndex:null!==(t=e.startingIndex)&&void 0!==t?t:0,active:!1});i.useEffect(()=>{let t=t=>{if(e.open&&!e.isInactive){let r=A;"ArrowDown"===t.code?h({type:"Increment"}):"ArrowUp"===t.code?(h({type:"Decrement"}),r=(r-1+e.items.length)%e.items.length):"Enter"===t.code?h({type:"Select"}):"Escape"===t.code&&e.onClose&&e.onClose()}};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[e.open,e.isInactive]);let g=e.lineHeight||s.MEDIUM;return r.h(c,{backgroundColor:null!==(a=e.backgroundColor)&&void 0!==a?a:o.colors.BLACK,borderColor:null!==(n=e.borderColor)&&void 0!==n?n:o.colors.WHITE,width:e.width,open:e.open},r.h(d,{key:"title",borderColor:e.borderColor},r.h(w,{backgroundColor:e.backgroundColor||o.colors.BLACK,onClick:e.onClose,lineHeight:e.lineHeight,title:e.title})),e.items.map((t,i)=>r.h(d,{key:i,borderColor:e.borderColor},r.h(u,{key:i,backgroundColor:e.backgroundColor,highlighted:A===i,lineHeight:g,active:l&&A===i,onClick:()=>{h({type:"Set",payload:i}),setTimeout(()=>{h({type:"Select"})})},onMouseOver:()=>{h({type:"Set",payload:i})}},t.label),A===i?r.h(m,null):null)))};C.defaultProps=A,t.default=C})),define("model/player",["require","exports","model/character","model/battle","utils"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playerModifyTickets=t.playerModifyTokens=t.playerHasItem=t.playerRemoveItem=t.playerAddItem=t.playerGetCameraOffset=t.playerGetBattlePosition=t.playerSetBattlePosition=t.playerCreate=void 0,t.playerCreate=e=>{let t=r.characterCreateFromTemplate(e);return{leader:t,tokens:99,tickets:99,backpack:["Haptic Bracer"],party:[t],battlePositions:{[i.BattlePosition.FRONT]:[t],[i.BattlePosition.MIDDLE]:[],[i.BattlePosition.BACK]:[]}}},t.playerSetBattlePosition=(e,t,r)=>{if(o.removeIfPresent(e.battlePositions[i.BattlePosition.FRONT],t),o.removeIfPresent(e.battlePositions[i.BattlePosition.MIDDLE],t),o.removeIfPresent(e.battlePositions[i.BattlePosition.BACK],t),!e.party.includes(t))throw console.error(e,t,r),Error("Cannot set battle position for player, the given character is not in the party.");e.battlePositions[r].push(t)},t.playerGetBattlePosition=(e,t)=>{if(e.battlePositions[i.BattlePosition.FRONT].includes(t))return i.BattlePosition.FRONT;if(e.battlePositions[i.BattlePosition.MIDDLE].includes(t))return i.BattlePosition.MIDDLE;if(e.battlePositions[i.BattlePosition.BACK].includes(t))return i.BattlePosition.BACK;throw Error("Cannot get battle position for party member who isn't in the player's party: "+JSON.stringify(t))},t.playerGetCameraOffset=e=>{let t=e.leader,[r,i]=o.isoToPixelCoords(t.x,t.y);return[256-r-16,256-i]},t.playerAddItem=(e,t)=>(e.backpack.push(t),!0),t.playerRemoveItem=(e,t)=>{let r=e.backpack.indexOf(t);return r>-1&&(e.backpack.splice(r,1),!0)},t.playerHasItem=(e,t)=>e.backpack.indexOf(t)>-1,t.playerModifyTokens=(e,t)=>{e.tokens+=t,e.tokens<0&&(e.tokens=0)},t.playerModifyTickets=(e,t)=>{e.tickets+=t,e.tickets<0&&(e.tickets=0)}})),define("model/utility",["require","exports","model/generics","utils","model/room"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Transform=t.transformOffsetJumpFar=t.transformOffsetJumpMedium=t.transformOffsetJumpShort=t.transformOffsetFlat=t.TransformEase=t.Gauge=t.Timer=void 0;class a{constructor(e){this.timestampStart=r.getNow(),this.timestampPause=0,this.duration=e,this.shouldRemove=!1,this.isPaused=!1,this.awaits=[]}start(e){this.timestampStart=r.getNow(),this.duration=null!=e?e:this.duration}pause(){this.isPaused||(this.isPaused=!0,this.timestampPause=r.getNow())}unpause(){this.isPaused&&(this.isPaused=!1,this.updateStart(r.getNow()-this.timestampPause))}updateStart(e){this.timestampStart+=e}update(){this.isComplete()&&(this.awaits.forEach(e=>e()),this.awaits=[])}isComplete(){return r.getNow()-this.timestampStart>=this.duration}onCompletion(){return new Promise(e=>{this.isComplete()||this.awaits.push(e)})}getPctComplete(){let e=r.getNow();this.isPaused&&(e-=e-this.timestampPause);let t=e-this.timestampStart;return t>this.duration?t=this.duration:t<0&&(t=0),t/this.duration}markForRemoval(){this.shouldRemove=!0}}var n;t.Timer=a,t.Gauge=class{constructor(e,t){this.max=e,this.current=0,this.decayRate=t}fill(e){this.current+=e,this.current>this.max&&(this.current=this.max)}empty(){this.current=0}isFull(){return this.current>=this.max}getPct(){return this.current/this.max}update(){this.current-=this.decayRate*r.getFrameMultiplier(),this.current<0&&(this.current=0)}},function(e){e.LINEAR="linear",e.EASE_OUT="ease_out"}(n=t.TransformEase||(t.TransformEase={})),t.transformOffsetFlat=e=>[0*e,0*e,0*e],t.transformOffsetJumpShort=e=>[0,0,o.TILE_HEIGHT*Math.sin(e*Math.PI)],t.transformOffsetJumpMedium=e=>[0,0,2*o.TILE_HEIGHT*Math.sin(e*Math.PI)],t.transformOffsetJumpFar=e=>[0,0,4*o.TILE_HEIGHT*Math.sin(e*Math.PI)];class s{constructor(e,r,i,o,n){this.startX=e[0],this.startY=e[1],this.startZ=e[2],this.endX=r[0],this.endY=r[1],this.endZ=r[2],this.timer=new a(i),this.ease=o,this.shouldRemove=!1,this.offsetFunc=n||t.transformOffsetFlat,this.timer.start()}start(){return[this.startX,this.startY,this.endZ]}end(){return[this.endX,this.endY,this.endZ]}current(){let[e,t,r]=this.offsetFunc(this.timer.getPctComplete(),this),o=this.timer.getPctComplete(),a=this.ease===n.EASE_OUT?i.normalizeEaseOutClamp:i.normalizeClamp;return[a(o,0,1,this.startX,this.endX)+e,a(o,0,1,this.startY,this.endY)+t,a(o,0,1,this.startZ,this.endZ)+r]}update(){this.timer.update()}createInverse(){return new s([this.endX,this.endY,this.endZ],[this.startX,this.startY,this.startZ],this.timer.duration,this.ease,this.offsetFunc)}markForRemoval(){this.shouldRemove=!0}}t.Transform=s})),define("model/particle",["require","exports","model/utility","model/animation","utils","model/sprite","model/room"],(function(e,t,r,i,o,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.particleUpdate=t.particleGetSize=t.particleGetPos=t.particleCreateFromTemplate=t.createDamageParticle=t.EFFECT_TEMPLATE_SWORD_LEFT=void 0,t.EFFECT_TEMPLATE_SWORD_LEFT={animName:"effect_sword_left"},t.createDamageParticle=(e,t,i,a)=>{let s={anim:void 0,text:e,textParams:{size:16,color:null!=a?a:"white",align:"center",strokeColor:"black"},timer:new r.Timer(1e3),shouldRemove:!1,transform:new r.Transform([t,i,0],[t+o.getRandBetween(-n.TILE_WIDTH/2,n.TILE_WIDTH/2),i-n.TILE_HEIGHT,0],1e3,r.TransformEase.EASE_OUT),x:t,y:i};return s.timer.start(),s},t.particleCreateFromTemplate=(e,t)=>{var o;let n=i.createAnimation(t.animName+(t.flipped?a.SpriteModification.FLIPPED:a.SpriteModification.NORMAL)),[s,A]=n.getSpriteSize(1),l={anim:n,timer:new r.Timer(null!==(o=t.duration)&&void 0!==o?o:n.getDurationMs()),shouldRemove:!1,x:e[0]-s/2,y:e[1]-A/2};return n.start(),l.timer.start(),l},t.particleGetPos=e=>e.transform?o.truncatePoint3d(e.transform.current()):[e.x,e.y],t.particleGetSize=e=>{let t=e.anim;return(null==t?void 0:t.getSpriteSize(0))||[0,0]},t.particleUpdate=e=>{e.timer.isComplete()&&(e.shouldRemove=!0)}})),define("controller/battle-management",["require","exports","model/battle","model/character","model/room","db/overworlds","model/generics","model/player","model/particle","utils","model/store","controller/ui-actions","model/generics"],(function(e,t,r,i,o,a,n,s,A,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.completeCast=t.interruptCast=t.setCasting=t.calculateStaggerDamage=t.resetCooldownTimer=t.applyWeaponDamage=t.endAction=t.beginAction=t.updateBattleCharacter=t.updateBattle=t.initiateBattle=void 0,t.initiateBattle=(e,A)=>{let l=a.getRoom(A.roomName);l.characters=[];let c=A.enemies.map(e=>{let t=i.characterCreateFromTemplate(e.chTemplate);return o.roomAddCharacter(l,t),r.battleCharacterCreateEnemy(t,e)}),d={room:l,isCompleted:!1,enemies:c,defeated:[],allies:e.party.map(t=>(o.roomAddCharacter(l,t),r.battleCharacterCreateAlly(t,{position:s.playerGetBattlePosition(e,t)})))};return d.allies.forEach(t.resetCooldownTimer),d.enemies.forEach(t.resetCooldownTimer),r.battleSetActorPositions(d),u.setCurrentPlayer(e),n.setCurrentBattle(d),n.setCurrentRoom(l),d},t.updateBattle=e=>{for(let r=0;r<e.allies.length;r++){let i=e.allies[r];t.updateBattleCharacter(e,i),i.shouldRemove&&(e.allies.splice(r,1),r--)}for(let r=0;r<e.enemies.length;r++){let i=e.enemies[r];t.updateBattleCharacter(e,i),i.shouldRemove&&(e.enemies.splice(r,1),r--)}if(!e.isCompleted)if(r.battleIsVictory(e)){e.isCompleted=!0,d.showSection(c.AppSection.BattleVictory,!0);for(let t in e.allies)i.characterSetAnimationState(e.allies[t].ch,i.AnimationState.BATTLE_FLOURISH);setTimeout(()=>{d.showSection(c.AppSection.Debug,!0)},2e3)}else r.battleIsLoss(e)&&(e.isCompleted=!0,d.showSection(c.AppSection.BattleDefeated,!0),setTimeout(()=>{d.showSection(c.AppSection.Debug,!0)},2e3))},t.updateBattleCharacter=(e,o)=>{o.ch.hp<=0?o.isDefeated||(o.isDefeated=!0,i.characterSetAnimationState(o.ch,i.AnimationState.BATTLE_DEFEATED),i.characterOnAnimationCompletion(o.ch,()=>{let t=e.enemies.indexOf(o);if(t>-1)return o.shouldRemove=!0,void e.defeated.push(o);t=e.allies.indexOf(o),t>-1&&(o.shouldRemove=!0,e.defeated.push(o))})):e.isCompleted||(o.isStaggered&&o.staggerTimer.isComplete()&&(o.isStaggered=!1,i.characterSetAnimationState(o.ch,i.AnimationState.BATTLE_IDLE)),o.isCasting&&o.castTimer.isComplete()&&t.completeCast(o),o.staggerGauge.update(),o.canAct?o.canAct=r.battleCharacterCanAct(e,o):r.battleCharacterCanAct(e,o)&&(o.canAct=!0,o.onCanActCb(),o.ai&&o.ai(e,o)))},t.beginAction=(e,t)=>{t.isActing=!0,t.actionTimer.start(),t.actionTimer.pause()},t.endAction=(e,r)=>{r.isActing=!1,t.resetCooldownTimer(r),r.actionTimer.unpause()},t.applyWeaponDamage=(e,a,n,s,c)=>{let d=s+a.ch.stats.POW+a.ch.stats.ACC/4;s=l.getRandBetween(d/2+d/2*a.ch.stats.ACC/100,d),n.isStaggered?(n.staggerTimer.start(),s*=2):(n.staggerGauge.fill(c),n.staggerGauge.isFull()&&r.battleCharacterSetStaggered(n)),n.isCasting&&t.interruptCast(n),s=Math.max(1,Math.floor(s));let[u,h]=i.characterGetPosCenterPx(n.ch);o.roomAddParticle(e.room,A.createDamageParticle(s+"",u,h)),r.battleCharacterApplyDamage(n,s)},t.resetCooldownTimer=e=>{let t=e.ch.skills[e.ch.skillIndex];t&&(e.actionTimer.duration=Math.max(t.cooldown-t.cooldown*(1-1/(1+e.ch.stats.SPD/100)),1e3))},t.calculateStaggerDamage=e=>Math.max(e.stats.STAGGER,1),t.setCasting=(e,t)=>{var r,i;e.isCasting=!0,e.castTimer.duration=t.castTime,e.castTimer.start(),e.onCast=null!==(r=t.onCast)&&void 0!==r?r:function(){},e.onCastInterrupted=null!==(i=t.onInterrupt)&&void 0!==i?i:function(){}},t.interruptCast=e=>{e.isCasting=!1,e.onCastInterrupted()},t.completeCast=e=>{e.isCasting=!1,e.onCast()}})),define("view/components/BattleSelectMenu",["require","exports","preact","view/elements/VerticalMenu","view/style","model/player","model/battle","model/character","controller/battle-management","controller/battle-actions","controller/ui-actions","model/store"],(function(e,t,r,i,o,a,n,s,A,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);let u=o.style("div",()=>({display:"flex",justifyContent:"center",alignItems:"center",height:"100%"})),h=o.style("div",()=>({display:"flex",justifyContent:"center",alignItems:"center"}));t.default=e=>r.h(u,null,r.h(i.default,{title:"SELECT BATTLE",width:"256px",open:!0,items:e.battles.map(({template:e,label:t})=>({label:r.h(h,null,r.h("span",null,t)),value:e})),onItemClick:e=>{(e=>{let t=a.playerCreate({name:"Ada",spriteBase:"ada",stats:n.battleStatsCreate(),facing:s.Facing.RIGHT,animationState:s.AnimationState.BATTLE_IDLE,skills:[l.BattleActions.Swing,l.BattleActions.Defend]}),r=s.characterCreateFromTemplate({name:"Conscience",spriteBase:"conscience",stats:n.battleStatsCreate(),facing:s.Facing.RIGHT,animationState:s.AnimationState.BATTLE_IDLE,skills:[l.BattleActions.Swing,l.BattleActions.Defend]});t.party.push(r),a.playerSetBattlePosition(t,r,n.BattlePosition.BACK),A.initiateBattle(t,e),c.showSection(d.AppSection.BattleUI,!0)})(e)}}))})),define("db/enemies",["require","exports","model/battle","model/character","controller/battle-actions"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.get=void 0;let a={};t.get=e=>{let t=a[e];if(!t)throw Error("No enemy template exists with name: "+e);return Object.assign(Object.assign({},t),{stats:Object.assign({},t.stats)})},t.init=()=>{a.ENEMY_GUY={name:"guy",spriteBase:"guy",stats:r.battleStatsCreate(),facing:i.Facing.LEFT,animationState:i.AnimationState.BATTLE_IDLE,skills:[o.BattleActions.SwingSlow]}}})),define("db/encounters",["require","exports","model/battle","controller/battle-ai","db/enemies"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.get=t.varyStats=void 0,t.varyStats=e=>{let t=e.stats,r=Object.keys(t);for(let e=0;e<r.length;e++){let i=r[e];"STAGGER"!==i&&Math.random()>.5&&(t[i]++,e--)}return e};let a={};t.get=e=>{let t=a[e];if(!t)throw Error("No encounter exists with name: "+e);return t},t.init=()=>{a.ENCOUNTER_ONE_VS_ONE={roomName:"battle1",enemies:[{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:r.BattlePosition.FRONT,ai:i.BATTLE_AI_ATTACK}]},a.ENCOUNTER_ONE_VS_TWO={roomName:"battle1",enemies:[{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:r.BattlePosition.FRONT,ai:i.BATTLE_AI_ATTACK},{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:r.BattlePosition.FRONT,ai:i.BATTLE_AI_ATTACK}]},a.ENCOUNTER_ONE_VS_THREE={roomName:"battle1",enemies:[{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:r.BattlePosition.FRONT,ai:i.BATTLE_AI_ATTACK},{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:r.BattlePosition.FRONT,ai:i.BATTLE_AI_ATTACK},{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:r.BattlePosition.MIDDLE,ai:i.BATTLE_AI_ATTACK}]}},t.default=a})),define("controller/events",["require","exports","model/generics","model/canvas"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.popKeyHandler=t.pushKeyHandler=t.getCurrentKeyHandler=t.initEvents=void 0,t.initEvents=()=>{let e=document.getElementById(i.CANVAS_ID),{left:o,top:a,width:n,height:s}=(null==e?void 0:e.getBoundingClientRect())||{left:0,top:0,width:0,height:0};window.addEventListener("mousemove",e=>{let{clientX:t,clientY:i}=e,A=t-o,l=i-a;A>n&&(A=n),l>s&&(l=s),r.setMousePos(A,l)}),window.addEventListener("keydown",e=>{r.setKeyDown(e.key);let i=t.getCurrentKeyHandler();i&&i(e)}),window.addEventListener("keyup",e=>{r.setKeyUp(e.key)}),t.pushKeyHandler(async e=>{})};let o=[];t.getCurrentKeyHandler=()=>o[o.length-1],t.pushKeyHandler=e=>{o.push(e)},t.popKeyHandler=e=>{let t=o.indexOf(e);t>-1&&o.splice(t,1)}})),define("db/tiles",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.getReplacementTemplate=t.getIfExists=t.get=void 0;let r={},i={};t.get=e=>{let t=r[e];if(!t)throw Error("No tile template exists with name: "+e);return Object.assign({},t)},t.getIfExists=e=>{let t=r[e];return t?Object.assign({},t):null},t.getReplacementTemplate=e=>{let r=i[e];if(!r)return null;let o=t.get(r);return Object.assign({},o)},t.init=()=>{r.RED_DOOR_BCK_CLOSED1={baseSprite:"walls_14",animName:"walls-anims_red_door_bck_close1",isWall:!0},i.walls_14="RED_DOOR_BCK_CLOSED1",r.RED_DOOR_BCK_CLOSED2={baseSprite:"walls_14",animName:"walls-anims_red_door_bck_close2",isWall:!0},r.RED_DOOR_FWD_CLOSED1={baseSprite:"walls_13",animName:"walls-anims_red_door_fwd_close1",isWall:!0},i.walls_13="RED_DOOR_FWD_CLOSED1",r.RED_DOOR_FWD_CLOSED2={baseSprite:"walls_13",animName:"walls-anims_red_door_fwd_close2",isWall:!0},r.RED_DOOR_BCK_OPEN1={baseSprite:"walls_14",animName:"walls-anims_red_door_bck_open1",isWall:!1},r.RED_DOOR_BCK_OPEN2={baseSprite:"walls_14",animName:"walls-anims_red_door_bck_open2",isWall:!1},r.RED_DOOR_FWD_OPEN1={baseSprite:"walls_13",animName:"walls-anims_red_door_fwd_open1",isWall:!1},r.RED_DOOR_FWD_OPEN2={baseSprite:"walls_13",animName:"walls-anims_red_door_fwd_open2",isWall:!1},r.ELEVATOR_BCK_CLOSED1={baseSprite:"walls_7",animName:"walls-anims_elevator_bck_close1",isWall:!0},r.ELEVATOR_BCK_CLOSED2={baseSprite:"walls_7",animName:"walls-anims_elevator_bck_close2",isWall:!0},r.ELEVATOR_FWD_CLOSED1={baseSprite:"walls_6",animName:"walls-anims_elevator_fwd_close1",isWall:!0},r.ELEVATOR_FWD_CLOSED2={baseSprite:"walls_6",animName:"walls-anims_elevator_fwd_close2",isWall:!0},r.ELEVATOR_BCK_OPEN1={baseSprite:"walls_7",animName:"walls-anims_elevator_bck_open1",isWall:!1},r.ELEVATOR_BCK_OPEN2={baseSprite:"walls_7",animName:"walls-anims_elevator_bck_open2",isWall:!1},r.ELEVATOR_FWD_OPEN1={baseSprite:"walls_6",animName:"walls-anims_elevator_fwd_open1",isWall:!1},r.ELEVATOR_FWD_OPEN2={baseSprite:"walls_6",animName:"walls-anims_elevator_fwd_open2",isWall:!1}}})),define("db/characters",["require","exports","model/character"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.getIfExists=t.get=void 0;let i={};t.get=e=>{let t=i[e];if(!t)throw Error("No character template exists with name: "+e);return Object.assign({},t)},t.getIfExists=e=>{let t=i[e];return t?Object.assign({},t):null},t.init=()=>{i.Skye={name:"Skye",spriteBase:"skye",talkTrigger:"",facing:r.Facing.LEFT_UP,animationState:r.AnimationState.IDLE},i.Conscience={name:"Conscience",spriteBase:"conscience",talkTrigger:"",facing:r.Facing.LEFT_UP,animationState:r.AnimationState.IDLE},i.Roger={name:"Roger",spriteBase:"guy2",talkTrigger:"test-roger",facing:r.Facing.LEFT_DOWN,animationState:r.AnimationState.IDLE,tags:["A"],overworldAi:"WALK_BETWEEN_MARKERS_ABC"},i.Rho={name:"Rho",spriteBase:"rho",talkTrigger:"test-rho",facing:r.Facing.DOWN,animationState:r.AnimationState.IDLE},i.Sigma={name:"Sigma",spriteBase:"sigma",talkTrigger:"test-sigma",facing:r.Facing.LEFT,animationState:r.AnimationState.IDLE},i.Floor1AtriumDeskEmployee={name:"Atrium Desk Employee",spriteBase:"employee-girl",talkTrigger:"floor1-atrium-desk-employee",facing:r.Facing.RIGHT_UP,animationState:r.AnimationState.IDLE},i.Floor1AtriumElevatorEmployee={name:"Atrium Elevator Employee",spriteBase:"employee-guy",talkTrigger:"floor1-atrium-elevator-employee",facing:r.Facing.LEFT_DOWN,animationState:r.AnimationState.IDLE},i.Floor1AtriumTicTacToeGirl={name:"Tic Tac Toe Girl",nameLabel:"Girl",spriteBase:"girl",talkTrigger:"floor1-atrium-TicTacToeGirl",facing:r.Facing.RIGHT_DOWN,animationState:r.AnimationState.IDLE}}})),define("controller/scene-commands",["require","exports","view/ui","controller/ui-actions","model/store","controller/events","model/character","model/room","model/generics","controller/scene-management","utils","model/animation","controller/overworld-management","db/tiles","db/characters","db/overworlds","model/player","model/utility","view/components/ArcadeCabinet","model/overworld"],(function(e,t,r,i,o,a,n,s,A,l,c,d,u,h,g,m,p,E,f,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetAi=t.setAnimationState=t.setAnimation=t.setAnimationAndWait=t.runArcadeCabinetGame=t.applyZTransform=t.jump=t.modifyTickets=t.modifyTokens=t.removeItem=t.acquireItem=t.changeRoom=t.fadeIn=t.fadeOut=t.despawnCharacter=t.spawnCharacterAtMarker=t.spawnCharacterAtCharacter=t.changeTileAtMarker=t.setCharacterAtMarker=t.walkToOffset=t.walkToMarker=t.setCharacterAt=t.shakeScreen=t.setFacing=t.lookAtEachOther=t.lookAtMarker=t.lookAtCharacter=t.callScript=t.setStorage=t.waitMSPreemptible=t.waitMS=t.setConversationSpeaker=t.endConversation=t.setConversation=t.setConversation2=t.playDialogue=void 0,t.playDialogue=(e,t,a)=>{let{cutscene:n}=r.getUiInterface().appState;if(!n.visible)return void console.error("Tried to play dialog while cutscene was not visible",e,t);let l=o.CutsceneSpeaker.None,c=e.toLowerCase();n.portraitLeft===c?l=o.CutsceneSpeaker.Left:n.portraitLeft2===c?l=o.CutsceneSpeaker.Left2:n.portraitRight===c?l=o.CutsceneSpeaker.Right:n.portraitRight2===c?l=o.CutsceneSpeaker.Right2:n.portraitCenter===c&&(l=o.CutsceneSpeaker.Center);let d=e,u=A.getCurrentRoom(),h=s.roomGetCharacterByName(u,e);return h&&(d=h.nameLabel),i.setCutsceneText(t,l,"narrator"!==c?d:""),y()},t.setConversation2=(e,r)=>{if(e){if(r)return i.startConversation2(""+e.toLowerCase(),""+r.toLowerCase()),t.waitMS(500);console.error("No right actor specified.")}else console.error("No left actor specified.")},t.setConversation=e=>(i.startConversation(""+e.toLowerCase()),t.waitMS(100)),t.endConversation=e=>(i.setCutsceneText(""),i.hideConversation(),t.waitMS(null!=e?e:500)),t.setConversationSpeaker=e=>{i.setCutsceneText("",e)},t.waitMS=(e,t)=>{let r=A.getCurrentScene();return r.isWaitingForTime=!0,clearTimeout(r.waitTimeoutId),r.waitTimeoutId=setTimeout(()=>{r.isWaitingForTime=!1,t&&t()},e),!0},t.waitMSPreemptible=(e,t)=>{let r=A.getCurrentScene(),i=e=>{switch(e.key){case"Return":case"Enter":case" ":clearTimeout(r.waitTimeoutId),a.popKeyHandler(i),o()}};a.pushKeyHandler(i);let o=()=>{r.isWaitingForTime=!1,t&&t(),a.popKeyHandler(i)};return r.isWaitingForTime=!0,clearTimeout(r.waitTimeoutId),r.waitTimeoutId=setTimeout(o,e),!0};let C=()=>{let e=A.getCurrentScene();return e.isWaitingForTime=!0,()=>{e.isWaitingForTime=!1}},y=e=>{let t=A.getCurrentScene();t.isWaitingForInput=!0;let r=e=>{switch(e.key){case"Return":case"Enter":case" ":clearTimeout(t.waitTimeoutId),a.popKeyHandler(r),i()}};a.pushKeyHandler(r);let i=()=>{t.isWaitingForInput=!1,e&&e(),a.popKeyHandler(r)};return i};t.setStorage=(e,t)=>{A.getCurrentScene()[e]=t},t.callScript=e=>{let t=A.getCurrentScene();return l.callScript(t,e),!0},t.lookAtCharacter=(e,t)=>{let r=A.getCurrentRoom(),i=s.roomGetCharacterByName(r,e),o=s.roomGetCharacterByName(r,t);if(i)if(o){if(i&&o){let e=n.characterGetPosCenterPx(i),t=n.characterGetPosCenterPx(o),r=c.getAngleTowards(e,t);n.characterSetFacingFromAngle(i,r)}}else console.error("Could not find target character with name: "+t);else console.error("Could not find character with name: "+e)},t.lookAtMarker=(e,t)=>{let r=A.getCurrentRoom(),i=s.roomGetCharacterByName(r,e),o=r.markers[t];if(i)if(o){if(i&&o){let e=n.characterGetPosCenterPx(i),t=c.getAngleTowards(e,[o.x,o.y]);n.characterSetFacingFromAngle(i,t)}}else console.error("Could not find target marker with name: "+t);else console.error("Could not find character with name: "+e)},t.lookAtEachOther=(e,r)=>{t.lookAtCharacter(e,r),t.lookAtCharacter(r,e)},t.setFacing=(e,t)=>{let r=s.roomGetCharacterByName(A.getCurrentRoom(),e);r?(t===n.Facing.RIGHT2?t=n.Facing.RIGHT:t===n.Facing.RIGHT_UP2?t=n.Facing.RIGHT_UP:t===n.Facing.RIGHT_DOWN2&&(t=n.Facing.RIGHT_DOWN),n.characterSetFacing(r,t)):console.error("Cannot set facing, no character named:",e,"facing=",t)},t.shakeScreen=e=>{let r=document.getElementById("canvas-container");return r&&(r.className="shake"),t.waitMS(null!=e?e:1e3,()=>{r&&(r.className="")})},t.setCharacterAt=(e,t,r,i)=>{let o=A.getCurrentRoom(),a=s.roomGetCharacterByName(o,e);a?n.characterSetPos(a,[t,r,null!=i?i:0]):console.error("Could not find character with name: "+e)},t.walkToMarker=(e,t,r,i,o)=>{let a=A.getCurrentRoom(),l=s.roomGetCharacterByName(a,e),c=a.markers[t];if(!l)return void console.error("Could not find character with name: "+e);if(!c)return void console.error("Could not find target marker with name: "+t);let d=[c.x+(null!=r?r:0),c.y+(null!=i?i:0)];if(!o)return n.characterSetWalkTarget(l,d,C()),!0;n.characterSetWalkTarget(l,d,()=>{})},t.walkToOffset=(e,t,r,i)=>{let o=A.getCurrentRoom(),a=s.roomGetCharacterByName(o,e);if(!a)return void console.error("Could not find character with name: "+e);let l=[a.x+t,a.y+r];if(!i)return n.characterSetWalkTarget(a,l,C()),!0;n.characterSetWalkTarget(a,l,()=>{})},t.setCharacterAtMarker=(e,t,r,i)=>{let o=A.getCurrentRoom(),a=s.roomGetCharacterByName(o,e),l=o.markers[t];a?l?a&&l&&n.characterSetPos(a,c.extrapolatePoint([l.x+(null!=r?r:0),l.y+(null!=i?i:0)])):console.error("Could not find target marker with name: "+t):console.error("Could not find character with name: "+e)},t.changeTileAtMarker=(e,t,r,i)=>{var o;let a=A.getCurrentRoom(),n=a.markers[e],l=h.getIfExists(t);if(l)if(n){if(n){let t=s.roomGetTileBelow(a,[n.x+(null!=r?r:0),n.y+(null!=i?i:0)]);if(!t)return void console.error("Could not get a tile below the provided marker: "+e);if(t.isWall=null!==(o=l.isWall)&&void 0!==o?o:t.isWall,t.ro&&(t.ro.sprite=l.baseSprite,t.animName!==l.animName))if(t.animName=l.animName,l.animName){let e=d.createAnimation(l.animName);e.start(),t.ro.anim=e}else t.ro.anim=void 0}}else console.error("Could not find target marker with name: "+e);else console.error("Could not get a tile template with name: "+t)},t.spawnCharacterAtCharacter=(e,t,r,i)=>{let o=A.getCurrentRoom(),a=s.roomGetCharacterByName(o,t),l=g.getIfExists(e);if(!l)return void console.error("Could not get a character template with name: "+e);if(!a)return void console.error("Could not find target character with name: "+t);if(s.roomGetCharacterByName(o,l.name))return void console.error("The character to be spawned already exists in the current room: "+l.name);let c=[a.x+(null!=r?r:0),a.y+(null!=i?i:0),0],d=n.characterCreateFromTemplate(l);n.characterSetPos(d,c),s.roomAddCharacter(o,d)},t.spawnCharacterAtMarker=(e,t,r,i)=>{let o=A.getCurrentRoom(),a=o.markers[t],l=g.getIfExists(e);if(!l)return void console.error("Could not get a character template with name: "+e);if(!a)return void console.error("Could not find target marker with name: "+t);if(s.roomGetCharacterByName(o,l.name))return void console.error("The character to be spawned already exists in the current room: "+l.name);let c=[a.x+(null!=r?r:0),a.y+(null!=i?i:0),0],d=n.characterCreateFromTemplate(l);n.characterSetPos(d,c),s.roomAddCharacter(o,d)},t.despawnCharacter=e=>{let t=A.getCurrentRoom(),r=s.roomGetCharacterByName(t,e);r?s.roomRemoveCharacter(t,r):console.error("Could not find character with name: "+e)},t.fadeOut=(e,r)=>{let i=null!=e?e:750,o=document.getElementById("fade");if(o&&(o.style.transition=`background-color ${i}ms`,o.style["background-color"]="rgba(0, 0, 0, 255)"),!r)return t.waitMS(i)},t.fadeIn=(e,r)=>{let i=null!=e?e:1e3,o=document.getElementById("fade");if(o&&(o.style.transition=`background-color ${i}ms`,o.style["background-color"]="rgba(0, 0, 0, 0)"),!r)return t.waitMS(i)},t.changeRoom=(e,t)=>{let r=A.getCurrentPlayer(),i=m.getIfExists(e);r?i?u.initiateOverworld(r,i,t):console.error("No overworld template exists with name:",e):console.error("Player has not been initialized.")},t.acquireItem=(e,r)=>{let i=A.getCurrentPlayer();if(p.playerAddItem(i,e))return t.playDialogue("Narrator",null!=r?r:"Acquired: "+e)},t.removeItem=(e,r)=>{let i=A.getCurrentPlayer();if(p.playerRemoveItem(i,e))return t.playDialogue("Narrator",null!=r?r:"Removed: "+e)},t.modifyTokens=e=>{let r=A.getCurrentPlayer();return p.playerModifyTokens(r,e),t.playDialogue("Narrator",e>0?`Gained ${e} Regem Ludos Tokens.`:`Removed ${-e} Regem Ludos Tokens.`)},t.modifyTickets=e=>{let r=A.getCurrentPlayer();return p.playerModifyTickets(r,e),t.playDialogue("Narrator",e>0?`Gained ${e} Prize Tickets.`:`Removed ${-e} Prize Tickets.`)},t.jump=e=>{let r=A.getCurrentRoom(),i=s.roomGetCharacterByName(r,e);if(!i)return void console.error("Could not find character with name: "+e);let o=e=>new Promise(r=>{t.waitMS(33,()=>{let t=n.characterGetPos(i);t[2]=e,n.characterSetPos(i,t),r()})});return(async()=>{await o(8),await o(16),await o(20),await o(22),await o(20),await o(16),await o(8),await o(0),t.waitMS(500)})(),!0},t.applyZTransform=(e,r,i)=>{let o=A.getCurrentRoom(),a=s.roomGetCharacterByName(o,e);if(!a)return void console.error("Could not find character with name: "+e);let l=n.characterGetPos(a),c=[...l];c[2]+=r;let d=null!=i?i:1e3,u=new E.Transform(l,c,d,E.TransformEase.LINEAR);return n.characterSetTransform(a,u),t.waitMS(d,()=>{n.characterSetPos(a,c),a.transform=null})},t.runArcadeCabinetGame=e=>{let t=f.ArcadeGamePath[e];t?(w.overworldHide(A.getCurrentOverworld()),i.showArcadeGame(t)):console.error("No game exists with name:",e)},t.setAnimationAndWait=(e,r,i)=>{let o=A.getCurrentRoom(),a=s.roomGetCharacterByName(o,e);if(!a)return void console.error("Could not find character with name: "+e);if(!d.hasAnimation(r))return void console.error("Could not find animation with name: "+r);let l=d.createAnimation(r);n.characterOverrideAnimation(a,l);let c=l.getDurationMs();return t.waitMS(c+(null!=i?i:0),()=>{t.setAnimationState(e,n.AnimationState.IDLE)})},t.setAnimation=(e,t)=>{let r=A.getCurrentRoom(),i=s.roomGetCharacterByName(r,e);if(!i)return void console.error("Could not find character with name: "+e);if(!d.hasAnimation(t))return void console.error("Could not find animation with name: "+t);let o=d.createAnimation(t);n.characterOverrideAnimation(i,o)},t.setAnimationState=(e,t)=>{let r=A.getCurrentRoom(),i=s.roomGetCharacterByName(r,e);i?n.characterSetAnimationState(i,t):console.error("Could not find character with name: "+e)},t.resetAi=e=>{let t=A.getCurrentRoom(),r=s.roomGetCharacterByName(t,e);r?n.characterStartAi(r):console.error("Could not find character with name: "+e)},t.default={playDialogue:t.playDialogue,setConversation2:t.setConversation2,setConversation:t.setConversation,endConversation:t.endConversation,setConversationSpeaker:t.setConversationSpeaker,waitMS:t.waitMS,waitMSPreemptible:t.waitMSPreemptible,waitUntil:C,waitForUserInput:y,setStorage:t.setStorage,callScript:t.callScript,lookAtCharacter:t.lookAtCharacter,lookAtMarker:t.lookAtMarker,lookAtEachOther:t.lookAtEachOther,setFacing:t.setFacing,shakeScreen:t.shakeScreen,setCharacterAt:t.setCharacterAt,walkToMarker:t.walkToMarker,walkToOffset:t.walkToOffset,setCharacterAtMarker:t.setCharacterAtMarker,changeTileAtMarker:t.changeTileAtMarker,spawnCharacterAtCharacter:t.spawnCharacterAtCharacter,spawnCharacterAtMarker:t.spawnCharacterAtMarker,despawnCharacter:t.despawnCharacter,fadeOut:t.fadeOut,fadeIn:t.fadeIn,changeRoom:t.changeRoom,acquireItem:t.acquireItem,removeItem:t.removeItem,modifyTokens:t.modifyTokens,modifyTickets:t.modifyTickets,jump:t.jump,applyZTransform:t.applyZTransform,runArcadeCabinetGame:t.runArcadeCabinetGame,setAnimationAndWait:t.setAnimationAndWait,setAnimation:t.setAnimation,setAnimationState:t.setAnimationState}})),define("lib/hud-gamepad",["require","exports"],(function(require,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let GamePad=function(){function setup(config){document.addEventListener("touchmove",(function(e){e.preventDefault()}),!1),css();let length=Object.keys(config).length;length>0?(config.canvas?stage.assign(config.canvas):stage.create(),Object.keys(config).forEach((prop,i)=>{switch(prop){case"debug":case"trace":case"layout":case"start":case"select":case"hidden":case"joystick":case"hint":switch(typeof config[prop]){case"string":eval(`${prop} = '${config[prop]}'`);break;case"boolean":case"number":eval(`${prop} = ${config[prop]}`);break;case"object":switch(prop){case"start":case"select":eval(prop+" = true"),eval(`${prop}_button.key = '${config[prop].key}'`)}}break;case"buttons":buttons=config[prop].length-1,config[prop].length>buttons_layout.length&&(buttons=buttons_layout.length-1),buttons_layout=buttons_layout[buttons];for(var n=0;n<buttons+1;n++){var button=config[prop][n];button.name&&(buttons_layout[n].name=button.name),button.color&&(buttons_layout[n].color=button.color),button.key&&(buttons_layout[n].key=button.key),buttons_layout_built=!0}break;case"observerFunction":observerFunction=config[prop]}})):stage.create(),buttons_layout_built||(buttons_layout=buttons_layout[buttons]),start&&buttons_layout.push(start_button),select&&buttons_layout.push(select_button),events.bind(),controller.init(),init()}function init(){ctx.fillStyle="rgba(0,0,0,0.5)",ctx.textAlign="center",ctx.textBaseline="middle",ctx.font=bit.small,ctx.fillText("loading",width/2,height/2),joystick&&controller.stick.draw(),controller.buttons.draw(),setTimeout((function(){ready=!0}),250)}function draw(){ctx.clearRect(0,0,canvas.width,canvas.height),hidden||(debug&&helper.debug(),trace&&helper.trace(),joystick&&controller.stick.draw(),controller.buttons.draw())}function invert(e){}function css(){var e=document.createElement("style");e.innerHTML=`\n      @font-face {\n        font-family: 'bit';\n        src: url(${bit}) format('truetype');\n        font-weight: normal;\n        font-style: normal;\n      }\n      * {\n        padding: 0;\n        margin: 0;\n        -webkit-touch-callout: none;\n        -webkit-user-select: none;\n      }\n      html {\n        -ms-touch-action: manipulation;\n        touch-action: manipulation;\n      }\n      body {\n        width:  100%;\n        height: 100%;\n        margin: 0px;\n        padding:0px;\n        touch-action: none;\n        -ms-touch-action: none;\n        overflow: hidden;\n      }\n      canvas#controls {\n        image-rendering: optimizeSpeed;\n        image-rendering: -moz-crisp-edges;\n        image-rendering: -webkit-optimize-contrast;\n        image-rendering: -o-crisp-edges;\n        image-rendering: crisp-edges;\n        -ms-interpolation-mode: nearest-neighbor;\n         touch-action-delay: none;\n        touch-action: none;\n        -ms-touch-action: none;\n        position:fixed;\n      }\n      .touch {\n        display:flex;\n        position:fixed;\n        left:-1000rem;\n        top:-1000rem;\n        width:10px;\n        height:10px;\n      }\n      @media (any-pointer: coarse) {\n        .touch {\n          display:none;\n        }\n      }\n    `,document.head.appendChild(e),bit={button:"18px 'bit'",small:"12px 'bit'",medium:"16px 'bit'",large:"24px 'bit'",huge:"48px 'bit'"}}var canvas,ctx,px=0,py=0,width=window.innerWidth,height=window.innerHeight,scale=[window.innerWidth/width,window.innerHeight/height],bit="data:font/truetype;charset=utf-8;base64,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",font={},touches={},map={},observerFunction,toggle=!1,ready=!1,hint=!1,debug=!1,trace=!1,hidden=!1,layout="BOTTOM_RIGHT",radius=25,opacity=.4,colors={red:`rgba(255,0,0,${opacity})`,green:`rgba(0,255,0,${opacity})`,blue:`rgba(0,0,255,${opacity})`,purple:`rgba(255,0,255,${opacity})`,yellow:`rgba(255,255,0,${opacity})`,cyan:`rgba(0,255,255,${opacity})`,black:`rgba(0,0,0,${opacity})`,white:`rgba(255,255,255,${opacity})`,joystick:{base:`rgba(0,0,0,${opacity})`,dust:`rgba(0,0,0,${opacity})`,stick:"rgba(204,204,204,1)",ball:"rgba(255,255,255,1)"}},buttons=0,buttons_layout=[[{x:0,y:0,r:radius,color:colors.red,name:"a"}],[{x:-radius/4,y:radius+radius/2,r:radius,color:colors.red,name:"a"},{x:radius+radius/.75,y:radius/2-radius,r:radius,color:colors.green,name:"b"}],[{x:.75*-radius,y:2*radius,r:radius,color:colors.red,name:"a"},{x:1.75*radius,y:radius,r:radius,color:colors.green,name:"b"},{x:3.5*radius,y:-radius,r:radius,color:colors.blue,name:"c"}],[{x:-radius,y:radius,r:radius,color:colors.red,name:"a"},{x:2*radius-radius,y:-(radius+radius)+radius,r:radius,color:colors.green,name:"b"},{x:2*radius-radius,y:radius+radius+radius,r:radius,color:colors.blue,name:"x"},{x:3*radius,y:0+radius,r:radius,color:colors.purple,name:"y"}]],button_offset={x:3*radius,y:3*radius},buttons_layout_built=!1,start=!0,start_button={x:width/2,y:-15,w:50,h:15,color:colors.black,name:"start"},select=!1,select_button={x:width/2,y:-15,w:50,h:15,color:colors.black,name:"select"},joystick=!0,stage={create:function(e){e=e||"GamePad",(canvas=document.createElement("canvas")).setAttribute("id",e);var t=document.createElement("div");t.setAttribute("class","touch"),document.querySelector(".App")?(document.querySelector(".App").appendChild(canvas),document.querySelector(".App").appendChild(t)):(document.body.appendChild(canvas),document.body.appendChild(t)),stage.assign(e)},assign:function(e){document.getElementById(e)||stage.create(e),canvas=document.getElementById(e),stage.adjust()},adjust:function(){(ctx=canvas.getContext("2d")).canvas.width=width*scale[0],ctx.canvas.height=height*scale[1],ctx.scale(scale[0],scale[1])}},controller={init:function(){var e=layout;switch(layout={x:0,y:0},e){case"TOP_LEFT":for(var t=0,r=0;r<buttons_layout.length;r++)buttons_layout[r].r&&(t+=buttons_layout[r].r,buttons_layout[r].y-=2*buttons_layout[r].r);layout.x=t+button_offset.x,layout.y=0+button_offset.y;break;case"TOP_RIGHT":layout.x=width-button_offset.x,layout.y=0+button_offset.y;break;case"BOTTOM_LEFT":for(t=0,r=0;r<buttons_layout.length;r++)buttons_layout[r].r&&(t+=buttons_layout[r].r);layout.x=t+button_offset.x,layout.y=height-button_offset.y;break;case"BOTTOM_RIGHT":layout.x=width-button_offset.x,layout.y=height-button_offset.y}controller.buttons.init(),joystick&&controller.stick.init()},buttons:{init:function(){for(var e=0;e<buttons_layout.length;e++){var t=buttons_layout[e],r=layout.x-t.x,i=layout.y-t.y;if(t.r){var o=t.r;buttons_layout[e].hit={x:[r-o,r+2*o],y:[i-o,i+2*o],active:!1}}else{if(t.x=width/2-t.w,start&&select)switch(t.name){case"select":t.x=width/2-t.w-2*t.h;break;case"start":t.x=width/2}buttons_layout[e].hit={x:[r=t.x,r+t.w],y:[i=layout.y-t.y,i+t.h],active:!1}}map[t.name]=0}},draw:function(){for(var e=0;e<buttons_layout.length;e++){var t=buttons_layout[e],r=t.color,i=layout.y-t.y;if(t.dx=s=layout.x-t.x,t.dy=i,t.r){var o=t.r;t.hit&&t.hit.active&&(ctx.fillStyle=r,ctx.beginPath(),ctx.arc(s,i,o+5,0,2*Math.PI,!1),ctx.fill(),ctx.closePath()),ctx.fillStyle=r,ctx.beginPath(),ctx.arc(s,i,o,0,2*Math.PI,!1),ctx.fill(),ctx.closePath(),ctx.strokeStyle=r,ctx.lineWidth=2,ctx.stroke(),ctx.fillStyle="rgba(255,255,255,1)",ctx.textAlign="center",ctx.textBaseline="middle",ctx.font=bit.button,ctx.fillText(t.name,s,i)}else{var a=t.w,n=t.h,s=t.x;i=t.dy,o=10,ctx.fillStyle=r,t.hit&&t.hit.active&&ctx.roundRect(s-5,i-5,a+10,n+10,2*o).fill(),ctx.roundRect(s,i,a,n,o).fill(),ctx.strokeStyle=r,ctx.lineWidth=2,ctx.stroke(),ctx.fillStyle="rgba(0,0,0,0.5)",ctx.textAlign="center",ctx.textBaseline="middle",ctx.font=bit.button,ctx.fillText(t.name,s+a/2,i+2*n)}t.key&&hint&&(ctx.fillStyle="rgba(0,0,0,0.25)",ctx.textAlign="center",ctx.textBaseline="middle",ctx.font=bit.button,"start"!=t.name&&"select"!=t.name||(s+=a/2),ctx.fillText(t.key,s,i-1.5*o))}},state:function(e,t,r){if("stick"!=touches[e].id){var i={x:touches[e].x,y:touches[e].y},o=buttons_layout[t],a=o.name,n=parseInt(i.x-o.dx),s=parseInt(i.y-o.dy),A=width;if(o.r?A=parseInt(Math.sqrt(n*n+s*s)):i.x>o.hit.x[0]&&i.x<o.hit.x[1]&&i.y>o.hit.y[0]&&i.y<o.hit.y[1]&&(A=0),A<radius&&"stick"!=touches[e].id)if(r)switch(r){case"mousedown":touches[e].id=a;break;case"mouseup":delete touches[e].id,controller.buttons.reset(t)}else touches[e].id=a;touches[e].id==a&&(map[a]=1,o.hit.active=!0,A>radius&&(o.hit.active=!1,map[a]=0,delete touches[e].id),"function"==typeof observerFunction&&observerFunction())}},reset:function(e){var t=buttons_layout[e],r=t.name;t.hit.active=!1,map[r]=0}},stick:{radius:40,x:0,y:0,dx:0,dy:0,init:function(){this.radius=40,this.x=width-layout.x,this.y=layout.y,this.dx=this.x,this.dy=this.y,map["x-dir"]=0,map["y-dir"]=0,map["x-axis"]=0,map["y-axis"]=0},draw:function(){ctx.fillStyle=colors.joystick.base,ctx.beginPath(),ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),ctx.fill(),ctx.closePath(),ctx.fillStyle=colors.joystick.dust,ctx.beginPath(),ctx.arc(this.x,this.y,this.radius-5,0,2*Math.PI,!1),ctx.fill(),ctx.closePath(),ctx.fillStyle=colors.joystick.stick,ctx.beginPath(),ctx.arc(this.x,this.y,10,0,2*Math.PI,!1),ctx.fill(),ctx.closePath(),ctx.fillStyle=colors.joystick.ball,ctx.beginPath(),ctx.arc(this.dx,this.dy,this.radius-10,0,2*Math.PI,!1),ctx.fill(),ctx.closePath()},state:function(e,t){var r=touches[e].y,i=parseInt(touches[e].x-this.x),o=parseInt(r-this.y),a=parseInt(Math.sqrt(i*i+o*o));if(a<1.5*this.radius)if(t)switch(t){case"mousedown":touches[e].id="stick";break;case"mouseup":delete touches[e].id,controller.stick.reset()}else touches[e].id="stick";"stick"==touches[e].id&&(Math.abs(parseInt(i))<this.radius/2&&(this.dx=this.x+i),Math.abs(parseInt(o))<this.radius/2&&(this.dy=this.y+o),map["x-axis"]=(this.dx-this.x)/(this.radius/2),map["y-axis"]=(this.dy-this.y)/(this.radius/2),map["x-dir"]=Math.round(map["x-axis"]),map["y-dir"]=Math.round(map["y-axis"]),a>1.5*this.radius&&(controller.stick.reset(),delete touches[e].id),"function"==typeof observerFunction&&observerFunction())},reset:function(){this.dx=this.x,this.dy=this.y,map["x-dir"]=0,map["y-dir"]=0,map["x-axis"]=0,map["y-axis"]=0}}},events={bind:function(){var e={browser:["mousedown","mouseup","mousemove"],app:["touchstart","touchend","touchmove"]};for(var t in document.querySelector(".touch"),e=""===document.querySelector(".touch").style.display?e.app:e.browser)canvas.addEventListener(e[t],GamePad.events,!1)},listen:function(e){if(e.type){var t=e.type;-1!=e.type.indexOf("mouse")&&(e.identifier="desktop",e={touches:[e]});for(var r=0;r<(e.touches.length>5?5:e.touches.length);r++)touches[i=e.touches[r].identifier]?(touches[i].x=e.touches[r].pageX,touches[i].y=e.touches[r].pageY):touches[i]={x:e.touches[r].pageX,y:e.touches[r].pageY};for(var i in touches)switch(t){case"touchstart":case"touchmove":for(controller.stick.state(i),r=0;r<buttons_layout.length;r++)controller.buttons.state(i,r);break;case"mousedown":case"mousemove":case"mouseup":for(controller.stick.state(i,t),r=0;r<buttons_layout.length;r++)controller.buttons.state(i,r,t)}if("touchend"==e.type){for("stick"==touches[i=e.changedTouches[0].identifier].id&&controller.stick.reset(),r=0;r<buttons_layout.length;r++)touches[i].id==buttons_layout[r].name&&controller.buttons.reset(r);if(touches[i]&&delete touches[i],e.changedTouches.length>e.touches.length){var o=0,a=e.changedTouches.length-e.touches.length;for(var i in touches)o>=a&&delete touches[i],o++}if(0==e.touches.length){for(touches={},r=0;r<buttons_layout.length;r++)controller.buttons.reset(r);controller.stick.reset()}}}else{var n=e,s=0;for(var A in n){switch(A){case"%":n[A]&&(s+=1);break;case"&":n[A]&&(s+=2);break;case"'":n[A]&&(s+=4);break;case"(":n[A]&&(s+=8);break;default:if(n[A])for(r=0;r<buttons_layout.length;r++)buttons_layout[r].key&&buttons_layout[r].key==A&&(touches[buttons_layout[r].name]={id:buttons_layout[r].name,x:buttons_layout[r].hit.x[0]+buttons_layout[r].w/2,y:buttons_layout[r].hit.y[0]+buttons_layout[r].h/2},controller.buttons.state(buttons_layout[r].name,r,"mousedown"));else if(!n[A]){for(r=0;r<buttons_layout.length;r++)buttons_layout[r].key&&buttons_layout[r].key==A&&(controller.buttons.reset(r),delete touches[buttons_layout[r].name]);delete n[A]}}switch(controller.stick.dx=controller.stick.x,controller.stick.dy=controller.stick.y,s){case 1:controller.stick.dx=controller.stick.x-controller.stick.radius/2;break;case 2:controller.stick.dy=controller.stick.y-controller.stick.radius/2;break;case 3:controller.stick.dx=controller.stick.x-controller.stick.radius/2,controller.stick.dy=controller.stick.y-controller.stick.radius/2;break;case 4:controller.stick.dx=controller.stick.x+controller.stick.radius/2;break;case 6:controller.stick.dx=controller.stick.x+controller.stick.radius/2,controller.stick.dy=controller.stick.y-controller.stick.radius/2;break;case 8:controller.stick.dy=controller.stick.y+controller.stick.radius/2;break;case 9:controller.stick.dx=controller.stick.x-controller.stick.radius/2,controller.stick.dy=controller.stick.y+controller.stick.radius/2;break;case 12:controller.stick.dx=controller.stick.x+controller.stick.radius/2,controller.stick.dy=controller.stick.y+controller.stick.radius/2;break;default:controller.stick.dx=controller.stick.x,controller.stick.dy=controller.stick.y}0!=s?(touches.stick={id:"stick"},controller.stick.state("stick","mousemove")):(controller.stick.reset(),delete touches.stick)}}return events.broadcast()},broadcast:function(){return map},observe:function(){return events.broadcast()}},helper={debug:function(){var e=30;for(var t in ctx.fillStyle="rgba(0,0,0,0.5)",ctx.textAlign="left",ctx.textBaseline="middle",ctx.font=bit.medium,ctx.fillText("debug",10,e),ctx.font=bit.small,e+=5,touches){e+=10;var r=t+" : "+JSON.stringify(touches[t]).slice(1,-1);ctx.fillText(r,10,e)}},trace:function(){var e=30;for(var t in ctx.fillStyle="rgba(0,0,0,0.5)",ctx.textAlign="right",ctx.textBaseline="middle",ctx.font=bit.medium,ctx.fillText("trace",width-10,e),ctx.font=bit.small,e+=5,map)ctx.fillText(t+" : "+map[t],width-10,e+=10)}};return function e(){(toggle=!toggle)||ready&&draw(),requestAnimationFrame(e)}(),CanvasRenderingContext2D.prototype.roundRect=function(e,t,r,i,o){return r<2*o&&(o=r/2),i<2*o&&(o=i/2),this.beginPath(),this.moveTo(e+o,t),this.arcTo(e+r,t,e+r,t+i,o),this.arcTo(e+r,t+i,e,t+i,o),this.arcTo(e,t+i,e,t,o),this.arcTo(e,t,e+r,t,o),this.closePath(),this},{setup:function(e){setup(e)},draw:function(){draw()},events:function(e){return events.listen(e)},observe:function(){return events.observe()}}}(),MultiKey=function(){function e(){"keydown keyup".split(" ").forEach((function(e){window.addEventListener(e,MultiKey.handler,!1)}))}var t,r={},i=!1,o=!0;return{setup:function(r,o,a){!function(r,o,a){t=r,o&&(i=o.split("")),a&&(i=i.concat("&%'(".split(""))),e()}(r,o,a)},bind:function(){e()},unbind:function(){"keydown keyup".split(" ").forEach((function(e){window.removeEventListener(e,MultiKey.handler,!1)}))},handler:function(e){!function(e){var a=String.fromCharCode(e.keyCode).toLowerCase();i?(o=!1,-1!=i.indexOf(a)&&(r[a]="keydown"===e.type,o=!0)):r[a]="keydown"===e.type,"function"==typeof t&&o&&t(r)}(e)}}}();exports.default={GamePad:GamePad,MultiKey:MultiKey}})),define("controller/overworld-management",["require","exports","model/room","model/generics","model/overworld","model/character","controller/scene-management","controller/scene-commands","lib/rpgscript","controller/ui-actions","model/store","controller/events","lib/hud-gamepad","model/generics"],(function(e,t,r,i,o,a,n,s,A,l,c,d,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateOverworld=t.overworldKeyHandler=t.initiateOverworld=void 0,u=__importDefault(u),t.initiateOverworld=(e,l,c)=>{let u=o.createOverworldFromTemplate(l);if(u){let o=u.room,h=e.leader;r.roomAddCharacter(o,h),i.setCurrentRoom(o),i.setCurrentPlayer(e),i.setCurrentOverworld(u),i.setRenderBackgroundColor(l.backgroundColor);let m=c?o.markers[c]:null;if(m?a.characterSetPos(h,[m.x,m.y,0]):o.markers.MarkerPlayer?s.setCharacterAtMarker(h.name,"MarkerPlayer"):a.characterSetPos(h,[0,0,0]),d.pushKeyHandler(t.overworldKeyHandler),u.loadTriggerName){let e=n.invokeTrigger(i.getCurrentScene(),u.loadTriggerName,A.TriggerType.ACTION);null!==e&&g(e)}return u}return null};let g=async e=>{let t=i.getCurrentOverworld();o.overworldDisableTriggers(t),i.disableKeyUpdate(),await e(),o.overworldEnableTriggers(t),i.enableKeyUpdate(),t.visible&&l.showSection(c.AppSection.Debug,!0)},m=async e=>{let t=i.getCurrentPlayer(),r=i.getCurrentRoom(),o=t.leader;for(let t=0;t<r.triggerActivators.length;t++){let s=r.triggerActivators[t];if(a.characterCollidesWithRect(o,[s.x,s.y,s.width,s.height])){let t=n.invokeTrigger(i.getCurrentScene(),s.name,e);if(null!==t)return e===A.TriggerType.ACTION&&a.characterSetAnimationState(o,a.AnimationState.IDLE),await g(t),!0}}return!1};t.overworldKeyHandler=async e=>{let t=i.getCurrentOverworld();switch(e.key){case" ":t.triggersEnabled&&(await m(A.TriggerType.ACTION)||(async()=>{let e=i.getCurrentPlayer(),t=i.getCurrentRoom(),r=e.leader;for(let o=0;o<t.characters.length;o++){let s=t.characters[o],[l,c]=a.characterGetPosBottom(s);if(s.talkTrigger&&a.characterCollidesWithPoint(r,[l,c,25])){let t=n.invokeTrigger(i.getCurrentScene(),s.talkTrigger,A.TriggerType.ACTION);if(null!==t)return a.characterStopAi(s),a.characterSetAnimationState(e.leader,a.AnimationState.IDLE),await g(t),a.characterStartAi(s),!0}}})());break;case"d":h.getTriggersVisible()?(h.hideTriggers(),h.hideMarkers()):(h.showTriggers(),h.showMarkers());break;case"c":i.getKeyUpdateEnabled()&&(i.disableKeyUpdate(),await n.callScript(i.getCurrentScene(),"test-jump"),l.showSection(c.AppSection.Debug,!0),i.enableKeyUpdate())}},t.updateOverworld=e=>{let t=i.getCurrentPlayer().leader;if(!e.visible)return;let{"x-dir":r,"y-dir":o}=u.default.GamePad.observe(),n=!1,s=0,l=0;i.getKeyUpdateEnabled()&&(i.isKeyDown("ArrowLeft")||r<0?(n=!0,s-=1,l+=1):(i.isKeyDown("ArrowRight")||r>0)&&(n=!0,s+=1,l-=1),i.isKeyDown("ArrowUp")||o<0?(n=!0,s-=1,l-=1):(i.isKeyDown("ArrowDown")||o>0)&&(n=!0,s+=1,l+=1),a.characterSetAnimationState(t,n?a.AnimationState.WALK:a.AnimationState.IDLE),t.vx=s,t.vy=l),e.triggersEnabled&&m(A.TriggerType.STEP),e.room.characters.forEach(e=>{e.aiEnabled&&(e.timers=e.timers.filter(e=>(e.update(),!e.isComplete()||(e.shouldRemove=!0,!1))),e.overworldAi.update(e))})}})),define("controller/loop",["require","exports","model/generics","view/draw","model/character","model/particle","view/ui","controller/battle-management","controller/overworld-management","model/canvas","controller/scene-management","model/player"],(function(e,t,r,i,o,a,n,s,A,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runMainLoop=t.unpause=t.pause=void 0,t.pause=()=>{if(r.getIsPaused())return;r.setIsPaused(!0),n.renderUi();let e=r.getCurrentRoom();e&&e.characters.forEach(e=>{e.transform&&e.transform.timer.pause()});let t=r.getCurrentBattle();t&&t.allies.concat(t.enemies).forEach(e=>{e.actionTimer.pause(),e.staggerTimer.pause(),e.castTimer.pause()})},t.unpause=()=>{if(!r.getIsPaused())return;r.setIsPaused(!1),n.renderUi();let e=r.getCurrentRoom();e&&e.characters.forEach(e=>{e.transform&&e.transform.timer.unpause()});let t=r.getCurrentBattle();t&&t.allies.concat(t.enemies).forEach(e=>{e.actionTimer.unpause(),e.staggerTimer.unpause(),e.castTimer.unpause()})},t.runMainLoop=async()=>{let e=performance.now(),t=e;window.running=!0;let n=e=>{let u=e-t,h=u/16;if(r.setFrameMultiplier(h>4?4:h),r.setDeltaT(u),t=e,r.setNow(e),r.getIsPaused())return void(window.running&&requestAnimationFrame(n));i.clearScreen(),i.clearScreen(l.getCtx("outer")),i.drawRect(0,0,l.getScreenSize(),l.getScreenSize(),r.getRenderBackgroundColor());let g=r.getCurrentScene(),m=r.getCurrentBattle(),p=r.getCurrentOverworld(),E=r.getCurrentRoom();if(g&&c.updateScene(g),E){let e=E.visible;for(let e=0;e<E.tiles.length;e++)E.tiles[e].highlighted=!1;p&&A.updateOverworld(p),m&&s.updateBattle(m);for(let e=0;e<E.characters.length;e++)o.characterUpdate(E.characters[e]);for(let e=0;e<E.particles.length;e++)a.particleUpdate(E.particles[e]),E.particles[e].shouldRemove&&(E.particles.splice(e,1),e--);let t=0,n=0;if(m)t=240,n=50;else{let e=r.getCurrentPlayer();if(e){let[r,i]=d.playerGetCameraOffset(e);t=r,n=i}}e&&i.drawRoom(E,[t,n])}let f=r.getRenderables();for(let e in f)(0,f[e])();window.running&&requestAnimationFrame(n)};n(e)}})),define("view/components/OverworldSection",["require","exports","preact","view/style","view/elements/Button","model/generics"],(function(e,t,r,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=__importStar(o);let n=i.style("div",{position:"absolute",top:"0px"});t.default=()=>r.h(r.Fragment,null,r.h(n,null,r.h(o.default,{type:o.ButtonType.PRIMARY,onClick:()=>{a.getTriggersVisible()?(a.hideTriggers(),a.hideMarkers()):(a.showTriggers(),a.showMarkers())}},"Toggle Debug")))})),define("view/components/Debug",["require","exports","preact","view/style","view/components/OverworldSection"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=__importDefault(o),i.style("div",()=>({position:"absolute",left:"0px",top:"0px"})),t.default=()=>r.h("div",{id:"debug"},r.h(o.default,null))})),define("view/components/BattleConclusion",["require","exports","preact","view/style"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let o=i.style("div",()=>({display:"flex",justifyContent:"center",alignItems:"center",height:"100%",fontSize:"4rem",color:i.colors.WHITE}));t.default=e=>r.h(o,null,r.h("span",null,e.isVictory?"VICTORY!":"DEFEATED!"))})),define("view/elements/AnimDiv",["require","exports","preact","preact/hooks","view/draw","model/animation"],(function(e,t,r,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>{let t=i.useRef(null),[n,s]=i.useState(a.createAnimation(e.animName)),A=e.width,l=e.height,c=e.scale,d=e.animName;return i.useEffect(()=>{let e=t.current;if(n.name!==d)s(a.createAnimation(d));else if(e){let[t,r]=n.getSpriteSize(0),i=null!=c?c:1;e.width=(null!=A?A:t)*i,e.height=(null!=l?l:r)*i;let a=e.getContext("2d");a.imageSmoothingEnabled=!1,a.clearRect(0,0,e.width,e.height),o.drawAnimation(n,0,0,i,a)}},[c,A,l,d,n]),r.h("div",null,r.h("canvas",{ref:t}))}})),define("view/hooks",["require","exports","preact/hooks","model/generics"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useInputEventStack=t.useRenderLoop=t.useReRender=t.initHooks=void 0,t.initHooks=()=>{window.addEventListener("keydown",e=>{let t=o[o.length-1];t&&t(e)})},t.useReRender=()=>{let[e,t]=r.useState(!1);return()=>{t(!e)}},t.useRenderLoop=(e,t)=>{let[,o]=r.useReducer(e=>!e,!1),a=()=>{o("")};return r.useEffect(()=>(i.addRenderable(e,t||a),()=>{i.removeRenderable(e)}),[]),a};let o=[];t.useInputEventStack=e=>{r.useEffect(()=>(o.push(e),()=>{let t=o.indexOf(e);t>-1&&o.splice(t,1)}),[])}})),define("view/elements/ProgressBar",["require","exports","preact","view/hooks","view/style"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressBarWithRender=void 0;let a=o.style("div",e=>({background:e.backgroundColor,position:"relative",height:e.height+"px",width:"100%"})),n=o.style("div",e=>({background:e.backgroundColor,position:"absolute",left:"0",top:"0",width:e.pct+"%",height:"100%"})),s=o.style("div",{textAlign:"center",fontSize:"16px",position:"absolute",left:"0",top:"0",width:"100%",color:"white"}),A=e=>{var t;return r.h(a,{backgroundColor:e.backgroundColor,height:e.height},r.h(n,{pct:100*(null!==(t=e.pct)&&void 0!==t?t:0),backgroundColor:e.color}),r.h(s,null,e.label))};t.ProgressBarWithRender=e=>(i.useRenderLoop(e.renderKey),r.h(A,Object.assign({},e,{pct:e.renderFunc()}))),t.default=A})),define("view/components/BattleCharacterStatus",["require","exports","preact","view/style","view/elements/AnimDiv","view/elements/ProgressBar","model/character"],(function(e,t,r,i,o,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=__importDefault(o);let s=i.colors.GREEN,A=i.colors.BLUE,l=i.style("div",e=>({display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",width:"64px",boxShadow:e.highlighted?"0px 0px 67px 21px rgba(255, 255, 255,0.75)":"unset"})),c=i.style("div",{background:"black",border:"2px solid "+i.colors.GREY,position:"relative"}),d=i.style("div",{position:"absolute",top:"0",left:"1px"}),u=i.style("div",e=>({border:e.omitBorder?"":"2px solid "+i.colors.WHITE,width:"100%",borderBottomLeftRadius:e.bottom?"4px":0,borderBottomRightRadius:e.bottom?"4px":0,borderTopLeftRadius:e.top?"4px":0,borderTopRightRadius:e.top?"4px":0}));t.default=e=>{let t=t=>`${e.bCh.ch.name}_${t}`,h=e.bCh.ch.skills[e.bCh.ch.skillIndex];return r.h(l,null,r.h(u,{top:!0},r.h(a.ProgressBarWithRender,{renderFunc:()=>e.bCh.actionTimer.getPctComplete(),renderKey:t("action"),backgroundColor:i.colors.BLACK,color:A,height:20,label:null==h?void 0:h.name})),r.h(c,null,r.h(o.default,{animName:"battlePortraits_"+e.bCh.ch.spriteBase}),r.h(d,null,e.bCh.ch.name)),r.h(u,{top:!0,omitBorder:!0},r.h(a.ProgressBarWithRender,{renderFunc:()=>e.bCh.isStaggered?1:e.bCh.staggerGauge.getPct(),renderKey:t("stagger"),backgroundColor:i.colors.BLACK,color:e.bCh.isStaggered?i.colors.WHITE:i.colors.ORANGE,height:4,label:""})),r.h(u,{bottom:!0},r.h(a.ProgressBarWithRender,{renderFunc:()=>n.characterGetHpPct(e.bCh.ch),renderKey:t("hp"),backgroundColor:i.colors.BLACK,color:s,height:20,label:"HP: "+e.bCh.ch.hp})))}})),define("view/components/BattleActionMenu",["require","exports","preact","view/elements/VerticalMenu","view/style"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=__importDefault(i);let a=o.style("div",()=>({})),n=o.style("div",()=>({display:"flex",justifyContent:"space-between",alignItems:"center"})),s=o.style("div",()=>({width:"24px",height:"24px"}));t.default=e=>r.h(a,null,r.h(i.default,{title:"ACTION",open:!0,onClose:e.onClose,width:"8rem",items:e.bCh.ch.skills.map((e,t)=>({label:r.h(n,null,r.h("span",null,e.name),r.h(s,null,r.h(e.icon,{color:o.colors.WHITE}))),value:t})),onItemClick:t=>{e.bCh.ch.skillIndex=t,e.onClose()}}))})),define("view/components/BattleUISection",["require","exports","preact","preact/hooks","view/style","view/components/BattleCharacterStatus","view/components/BattleActionMenu","view/elements/Button","controller/ui-actions","controller/loop","model/generics"],(function(e,t,r,i,o,a,n,s,A,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=__importDefault(a),n=__importDefault(n),s=__importStar(s);let d=o.style("div",{position:"absolute",bottom:"0px",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",width:"100%"}),u=o.style("div",{display:"flex",justifyContent:"center",alignItems:"center",width:"100%"}),h=o.style("div",{position:"absolute",bottom:"150px",width:"100%",display:"flex",justifyContent:"center"}),g=o.style("div",{margin:"16px"});t.default=()=>{let[e,t]=i.useState(!1),o=c.getCurrentBattle();return r.h(r.Fragment,null,e?null:r.h(h,null,r.h(s.default,{type:s.ButtonType.PRIMARY,onClick:()=>{t(!e),l.pause()}},"Don't Click Me")),r.h(d,null,r.h(u,null,o.allies.map(e=>r.h(g,null,r.h(a.default,{battle:o,bCh:e})))),e?r.h(n.default,{onClose:()=>{l.unpause(),A.battleSetChButtonsStatus(!0),t(!1)},open:e,bCh:o.allies[0]}):null))}})),define("view/components/CutsceneSection",["require","exports","preact","view/style","preact/hooks","view/elements/AnimDiv","view/ui","model/store"],(function(e,t,r,i,o,a,n,s){"use strict";var A;Object.defineProperty(t,"__esModule",{value:!0}),t.PortraitActiveState=void 0,a=__importDefault(a),function(e){e.Active="active",e.Inactive="inactive",e.Passive="passive",e.Invisible="invisible"}(A=t.PortraitActiveState||(t.PortraitActiveState={}));let l=(e,t,r)=>{let i="";return i=t?`${e}_portrait_${t}`:e+"_portrait","right"===r&&(i+="_f"),i},c=i.style("div",{position:"absolute",top:"0px",overflow:"hidden",width:"100%",height:"100%"}),d=i.style("div",e=>({position:"absolute",top:"0px",width:"100%",height:e.visible?"12.5%":"0%",transition:"height 0.25s",background:i.colors.DARKGREY})),u=i.style("div",e=>({position:"absolute",bottom:"0px",width:"100%",height:e.visible?"17%":"0%",transition:"height 0.25s",background:i.colors.DARKGREY})),h=i.style("div",e=>{let t="1",r="0%",i="0%",o="left 0.2s, right 0.2s, bottom 0.2s";return e.activeState===A.Active?r="3.125%":e.activeState===A.Inactive?(r="-3.125%",i="-3.125%",t="0.5"):e.activeState===A.Passive?i="-3.125%":e.activeState===A.Invisible&&(t="0",r="-50%",o=""),{position:"absolute",minWidth:"50%",minHeight:"50%",transition:o,left:"left"===e.align?r:"",right:"right"===e.align?r:"",bottom:i,opacity:t}}),g=i.style("div",e=>{let t="left"===e.align?"6.25%":"calc(100% - 6.25% - 50%)",r="25%",i="50%",o="height 0.1s, left 0.1s, transform 0.1s ease-in";return"center"===e.align?(t="20%",i="60%",r="75%",o="height 0.1s, left 0.25s, transform 0.1s ease-in"):"center-low"===e.align?(r="35%",t="20%",i="60%"):e.visible||(o=""),{position:"absolute",width:i,height:r,left:t,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",transition:o,bottom:"0px",transform:e.visible?"scale(1)":"scale(0)"}}),m=i.style("div",e=>{let t="unset",r="unset",o="solid",a="solid",n="2.5%",s="2.5%",A=i.colors.WHITE,l=i.colors.WHITE;return"right"===e.align?(n="5%",t="48px",o="16px solid",l=i.colors.BLUE):"left"===e.align&&(s="5%",r="48px",a="16px solid",A=i.colors.BLUE),{border:"2px solid "+i.colors.WHITE,background:e.isNarration?i.colors.DARKBLUE:i.colors.BLACK,boxShadow:"0px 0px 24px 16px rgba(0, 0, 0, 0.75)",boxSizing:"border-box",width:"100%",padding:"2.5%",color:i.colors.WHITE,fontSize:"24px",textAlign:"left",transition:"height 0.1s, width 0.1s",borderBottomLeftRadius:t,borderBottomRightRadius:r,borderLeft:o,borderRight:a,paddingLeft:n,paddingRight:s,borderRightColor:A,borderLeftColor:l,borderTopColor:i.colors.BLUE}}),p=i.style("div",e=>({position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",transform:e.visible?"translateY(0%)":"translateY(55%)",transition:"transform 0.15s"})),E=i.style("div",e=>({width:e.visible?"100%":"0px",display:"flex",marginBottom:"16px",opacity:e.visible?"100%":"0%",justifyContent:"right"===e.align?"flex-end":"flex-start"})),f=i.style("div",e=>({color:i.colors.BLACK,padding:"8px",fontSize:"18px",fontWeight:"bold",boxShadow:"0px 0px 24px 16px rgba(0, 0, 0, 0.75)",background:i.colors.WHITE,border:"2px solid black",borderTopRightRadius:"8px",borderTopLeftRadius:"8px",minWidth:"64px",textAlign:"center",textTransform:"uppercase"}));t.default=()=>{let[e,t]=o.useState(!1),i=o.useRef(null);o.useEffect(()=>{t(!0)},[]),o.useEffect(()=>{let e=null==i?void 0:i.current;e&&(e.style.transition="",e.style.opacity="0",e.innerHTML=w.text,setTimeout(()=>{e.style.transition="opacity 0.15s linear",e.style.opacity="1"},25))});let w=n.getUiInterface().appState.cutscene,C="center";return[s.CutsceneSpeaker.Left].includes(w.speaker)||[s.CutsceneSpeaker.Center].includes(w.speaker)?C="right":[s.CutsceneSpeaker.Right].includes(w.speaker)?C="left":w.portraitCenter&&(C="center-low"),r.h(c,null,r.h(d,{visible:w.visible&&e}),r.h(u,{visible:w.visible&&e}),r.h(p,{visible:w.visible&&e},""!==w.portraitLeft?r.h(h,{align:"left",activeState:w.speaker===s.CutsceneSpeaker.Left?A.Active:A.Inactive},r.h(a.default,{animName:l(w.portraitLeft,w.portraitLeftEmotion,"right")})):null,""!==w.portraitCenter?r.h(h,{align:"left",activeState:w.speaker===s.CutsceneSpeaker.Center?A.Active:A.Invisible},r.h(a.default,{animName:l(w.portraitCenter,w.portraitCenterEmotion,"right")})):null,""!==w.portraitRight?r.h(h,{align:"right",activeState:w.speaker===s.CutsceneSpeaker.Right?A.Active:A.Inactive},r.h(a.default,{animName:l(w.portraitRight,w.portraitRightEmotion,"left")})):null),r.h(g,{visible:e&&w.text.length>0,align:C},r.h(E,{visible:!!w.speakerName,align:w.speaker===s.CutsceneSpeaker.Right?"right":"left"},r.h(f,null,w.speakerName)),r.h(m,{align:C,isNarration:!w.speakerName},r.h("span",{style:{opacity:"0",transition:"unset"},ref:i}))))}})),define("view/ui",["require","exports","preact","preact/hooks","view/style","model/generics","model/store","controller/ui-actions","model/canvas","view/components/Debug","view/components/BattleConclusion","view/components/BattleUISection","view/components/CutsceneSection","model/store","view/components/ArcadeCabinet"],(function(e,t,r,i,o,a,n,s,A,l,c,d,u,h,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mountUi=t.renderUi=t.getUiInterface=t.uiInterface=void 0,l=__importDefault(l),c=__importDefault(c),d=__importDefault(d),u=__importDefault(u),g=__importDefault(g);let m=o.style("div",{position:"relative",height:"100%"}),p=o.style("div",()=>({position:"absolute",left:"0",top:"0",background:"black",opacity:"0.3",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:o.colors.WHITE,fontSize:"24px",width:"100%",height:"100%",pointerEvents:"none"})),E=o.style("div",()=>({marginBottom:"256px"}));t.uiInterface=null,t.getUiInterface=()=>t.uiInterface;let f=()=>{let[e,o]=i.useState(!1),[f,w]=i.useReducer(s.appReducer,n.AppStateInitial);i.useEffect(()=>{t.uiInterface=window.uiInterface={appState:f,render:()=>{o(!e)},dispatch:w}});let C=A.getDrawScale();return r.h("div",{style:{position:"absolute",top:"0px",width:512*(C>2?2:C),height:512*(C>2?2:C)}},r.h(m,null,a.getIsPaused()?r.h(p,null,r.h(E,null,"PAUSED")):null,f.sections.map((e,t)=>{switch(e){case h.AppSection.BattleVictory:return r.h(c.default,{key:t,isVictory:!0});case h.AppSection.BattleDefeated:return r.h(c.default,{key:t,isVictory:!1});case h.AppSection.BattleUI:return r.h(d.default,{key:t});case h.AppSection.Cutscene:return r.h(u.default,{key:t});case h.AppSection.ArcadeCabinet:return r.h(g.default,{game:f.arcadeGame.path});case h.AppSection.Debug:return r.h(l.default,null);default:return r.h("div",null)}})))};t.renderUi=()=>{t.uiInterface&&t.uiInterface.render()},t.mountUi=()=>{let e=document.getElementById("ui");e&&r.render(r.h(f,null),e)}})),define("controller/scene-management",["require","exports","lib/rpgscript","model/scene","model/generics","controller/scene-commands","model/player"],(function(e,t,r,i,o,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSceneCommands=t.createAndCallScript=t.callScript=t.invokeTrigger=t.evalCondition=t.updateScene=void 0,a=__importDefault(a),t.updateScene=e=>{if(e.currentScript&&!i.sceneIsWaiting(e)){let r=null;for(;null!==(r=e.currentScript.getNextCommand());)if(t.evalCondition(e,r.conditional)){let t=i.sceneGetCommands(e)[r.type];if(!t)throw Error(`Script runtime error.  No command exists with name '${r.type}'`);if(t(...r.args))break}if(null===r)if(e.onScriptCompleted&&e.onScriptCompleted(),e.scriptStack.length){let r=e.scriptStack.shift();if(r){let{script:i,onScriptCompleted:o}=r;e.currentScript=i,e.onScriptCompleted=o,setTimeout(()=>t.updateScene(e))}}else e.currentScript=null,e.currentTrigger=null}},t.evalCondition=(e,i)=>{var a,s,A;if(!0===i)return!0;if("object"==typeof i){let{type:l,args:c}=i,d=r.formatArgs(c).map(t=>{if("object"==typeof t)return t;if("scene"===t&&e.currentTrigger)return e.storage[e.currentTrigger.name];if("string"==typeof t&&t.indexOf(".")>-1){let[r,i]=t.split(".");return"storage"===r?e.storage[i]:e.storage[r]?e.storage[r][i]:(console.error("No storage in scene called:",r),!1)}return t});if("is"===l)return!!e.storage[d[0]];if("isnot"===l)return"object"==typeof d[0]?!t.evalCondition(e,d[0]):!e.storage[d[0]];if("gt"===l)return d[0]>d[1];if("lt"===l)return d[0]<d[1];if("eq"===l)return d[0]===d[1];if("any"===l){for(let r=0;r<d.length;r++)if(t.evalCondition(e,d[r]))return!0;return!1}if("all"===l){for(let r=0;r<d.length;r++)if(!t.evalCondition(e,d[r]))return!1;return!0}if("as"===l)return console.error('conditional "as" is not defined for this scene.'),!1;if("once"===l){let t=null!==(a=d[0])&&void 0!==a?a:(null===(s=e.currentScript||e.currentTrigger)||void 0===s?void 0:s.name)+"-once";return!e.storageOnceKeys[t]&&(e.storageOnceKeys[t]=!0,!0)}if("with"===l){let e=null!==(A=d[0])&&void 0!==A?A:"",t=o.getCurrentPlayer();return e&&n.playerHasItem(t,e)}return!1}},t.invokeTrigger=(e,i,o)=>{let a=r.getTrigger(i);if(!e.currentScript&&a)for(let r=0;r<a.scriptCalls.length;r++){let i=a.scriptCalls[r];if(i.type===o){if(e.currentTrigger=a,t.evalCondition(e,i.condition))return async()=>{await t.callScript(e,i.scriptName),e.storage[a.name]=!0};e.currentTrigger=null}}return null},t.callScript=async(e,i)=>new Promise(o=>{let a=r.getScript(i);a.reset(),e.currentScript&&e.scriptStack.unshift({script:e.currentScript,onScriptCompleted:e.onScriptCompleted}),e.currentScript=a,e.onScriptCompleted=o,t.updateScene(e)}),t.createAndCallScript=(e,t)=>{let i=e.commands,o=new r.Script(t,"internal",-1);o.addCommandBlock().commands=i.slice(),o.reset(),e.currentScript&&e.scriptStack.unshift({script:e.currentScript,onScriptCompleted:function(){}}),e.currentScript=o},t.getSceneCommands=e=>a.default})),define("model/scene",["require","exports","controller/scene-management","model/generics"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sceneGetCommands=t.sceneHasCommand=t.sceneIsWaiting=t.initScene=t.sceneCreate=void 0,t.sceneCreate=()=>{let e={storage:{},storageOnce:{},storageOnceKeys:{},commands:{},currentScript:null,currentTrigger:null,scriptStack:[],isWaitingForInput:!1,isWaitingForTime:!1,isWaitingForAnimation:!1,waitTimeoutId:-1};return Object.assign(e.commands,r.getSceneCommands(e)),e},t.initScene=()=>{i.setCurrentScene(t.sceneCreate())},t.sceneIsWaiting=e=>e.isWaitingForInput||e.isWaitingForTime||e.isWaitingForAnimation,t.sceneHasCommand=(e,r)=>!!t.sceneGetCommands(e)[r],t.sceneGetCommands=e=>e.commands})),define("lib/rpgscript",["require","exports","model/scene"],(function(e,t,r){"use strict";function i(e){return function(e){return e.map(e=>'"'===e[0]||"'"===e[0]?e.slice(1,-1):e)}(e).map(e=>isNaN(parseFloat(e))?e:parseFloat(e))}var o;Object.defineProperty(t,"__esModule",{value:!0}),t.getTrigger=t.getScript=t.loadRPGScript=t.ScriptParser=t.Script=t.Trigger=t.TriggerType=t.formatArgs=void 0,t.formatArgs=i,(o=t.TriggerType||(t.TriggerType={})).STEP="step",o.ACTION="action";class a{constructor(e,t,r){this.name=e,this.filename=t,this.lineNum=r,this.scriptCalls=[]}addScriptCall(e,t,r){this.scriptCalls.push({type:e,condition:t,scriptName:r})}}t.Trigger=a;class n{constructor(e,t,r){this.name=e,this.filename=t,this.lineNum=r,this.blocks=[],this.soundNameStorage={},this.currentBlockIndex=0,this.currentCommandIndex=0,this.sounds=0,this.soundsPerCharacter={}}reset(){this.currentBlockIndex=0,this.currentCommandIndex=0}isValid(e){if(!e)return!0;for(let t=0;t<this.blocks.length;t++){let i=this.blocks[t];for(let t=0;t<i.commands.length;t++){let o=i.commands[t];if(!r.sceneHasCommand(e,o.type))return`Error in script "${this.name}"\n\nNo command exists with name "${o.type}" and args "${o.args.join(",")}" `}}return!0}getNextCommand(){let e=this.blocks[this.currentBlockIndex];if(e){let t=e.commands[this.currentCommandIndex];return t?(this.currentCommandIndex++,{args:t.args,type:t.type,conditional:e.conditional}):(this.currentBlockIndex++,this.currentCommandIndex=0,this.getNextCommand())}return null}getNextDialog(e){this.soundsPerCharacter[e]?this.soundsPerCharacter[e]++:this.soundsPerCharacter[e]=1;let t=this.soundsPerCharacter[e];t<10&&(t="0"+t);let r=this.name+"/"+this.sounds,i=this.name+"/"+e+"-"+t;return this.sounds++,{soundNameIndexed:r,soundNameCh:i}}addCommandBlock(){let e={conditional:!0,commands:[]};return this.blocks.push(e),e}}t.Script=n;class s{constructor(e){this.name=e,this.soundsToLoad=[]}throwParsingError(e,t,r){throw console.error(`{Line ${t}} Script parsing error ${this.name}: ${e} CONTENTS [\n"${r}"\n]`),Error("Parsing error")}parseCommand(e,t,r){let o=(e=e.trim()).indexOf("("),a=e.lastIndexOf(")");if(e.match(/^(\w)+:/)&&r)return this.createDialogCommand(e,r);-1!==o&&0!==o||this.throwParsingError("Invalid command, no name provided",t,e),-1!==a&&0!==a||this.throwParsingError("Invalid command, no end parens",t,e);let n=e.substr(o+1,e.length-(o+1)-(e.length-a));return n=function(e,t){let r=[],i="",o="",a=!1;for(let t=0;t<e.length;t++){let n=e[t];o?n===o&&(o="",a=!1):'"'===n||"'"===n?(o=n,a=!0):"("===n?a=!0:")"===n&&(a=!1),a||","!==e[t]?i+=n:(r.push(i),i="")}return i&&r.push(i),r}(n).map(e=>e.trim()),n.forEach(r=>{"'"===r[0]?"'"!==r[r.length-1]&&this.throwParsingError('Invalid command, unterminated single quote "\'"',t,e):'"'===r[0]&&'"'!==r[r.length-1]&&this.throwParsingError("Invalid command, unterminated double quote '\"'",t,e)}),{type:e.substr(0,o),args:i(n)}}parseConditional(e,t,r){let{type:i,args:o}=this.parseCommand(e,t,r);return["is","isnot","gt","lt","eq","any","all","as","once","with"].includes(i)||this.throwParsingError(`Invalid conditional, no type named "${i}"`,t,e),{type:i,args:o.map(e=>"string"==typeof e&&-1!==e.indexOf("(")?this.parseCommand(e,t,r):e)}}combineConditionals(e,t,r){return{type:r,args:[e,t]}}getConditionalFromLine(e,t,r){let i=function(e,t){let r="",i=!1;for(let t=0;t<e.length;t++){let o=e[t];if(r?o===r&&(r="",i=!1):'"'===o||"'"===o?(r=o,i=!0):"("===o?i=!0:")"===o&&(i=!1),!i&&"?"===e[t])return t}return-1}(e);if(i>-1){let o=e.indexOf(":");-1===o&&this.throwParsingError("Invalid conditional, no ending ':'",t,e);let a=e.slice(i+1,o);return{conditional:this.parseConditional(a.trim(),t,r),endIndex:o+1}}return{conditional:!0,endIndex:0}}createDialogCommand(e,t){let[r,o]=e.split(":"),a="playDialogue";"_"===r[0]&&(r=r.slice(1),a="playDialogueInterruptable"),o=o.trim();let{soundNameCh:n,soundNameIndexed:s}=t.getNextDialog(r);return this.soundsToLoad.push({soundNameCh:n,soundNameIndexed:s}),{type:a,args:i([r,o,n])}}parse(e,t){let r={},i={},o=!1,s=!1,A=!1,l=null,c=null,d=null,u=null,h=e.split("\n");if(h.forEach((e,h)=>{if(h+=1,0===(e=e.trim()).length)return;if("/"===e[0]&&"/"===e[1])return;let g=e[0];if("{"===g)o=!0;else if("}"===g)o=!1,l=null;else if("@"!==g||o){if("$"===g)A=!0,s=!1,c&&(l=c.addCommandBlock(),l.conditional=!0,l.commands.push({type:"showChoices",args:[]}));else if("#"===g)s=!0,A=!1,u=e.substr(1),d=new a(e.substr(1),this.name,h),((e,t)=>{r[e]=t})(e.substr(1),d);else if("+"===g||o){let t=e.substr(o?0:1);if(c){let{conditional:r,endIndex:i}=this.getConditionalFromLine(t,h,c);if("object"==typeof r){if("{"===t[i])return o=!0,l=c.addCommandBlock(),void(l.conditional=r);if(i===t.length)return l=c.addCommandBlock(),void(l.conditional=r)}let a=null;o?(null===l&&(l=c.addCommandBlock(),l.conditional=r),a=l):(a=l=c.addCommandBlock(),a.conditional=r);let n=t.substr(i),s=/(.*): "(.*)"/.test(n);if("?"===n[0])return void this.throwParsingError("Invalid conditional, did you forget '+' at the start?",h,e);if("+"===n[0])n=n.slice(1);else if(s){let e=this.createDialogCommand(n,c);return void a.commands.push(e)}let{type:A,args:d}=this.parseCommand(n,h,c);a.commands.push({type:A,args:d})}}else if(A){let t=e.indexOf(":");-1===t&&this.throwParsingError("Invalid choice definition, no colon '\"'",h,e);let r=e.substr(0,t),i=e.substr(t+1);l&&l.commands[0].args.push({text:r,target:i})}else if(s){let t=e.indexOf(",");-1===t&&this.throwParsingError("Invalid trigger script call, invalid number of arguments",h,e);let r=e.substr(0,t),i=e.substr(t+1),o=null;"item"===r&&(o={type:"with",args:[i.slice(0,i.indexOf(","))]},i=i.slice(i.indexOf(",")+1));let{conditional:a,endIndex:n}=this.getConditionalFromLine(i,h,c),s=a;o&&(s=this.combineConditionals(o,a,"and"));let A=i.substr(n);"this"===A&&u&&(A=u),d&&d.addScriptCall(r,s,A)}else if(">"===g)l&&l.commands.push({type:"callScript",args:[e.substr(1)]});else if(s=!1,c){if("?"===e[0])return void this.throwParsingError("Invalid conditional, did you forget '+' at the start?",h,e);let t=c.addCommandBlock(),r=this.createDialogCommand(e,c);t.commands.push(r)}}else{let r=e.substr(1,e.length-1);if("this"===r&&(r=u||""),0===r.length&&this.throwParsingError("Invalid script name",h,e),c){let e=c.isValid(t);!0!==e&&this.throwParsingError(e,h-1,"")}c=new n(r,this.name,h),i[r]=c,s=!1,A=!1}}),c){let e=c.isValid(t);!0!==e&&this.throwParsingError(e,h.length,h[h.length-1])}return{triggers:r,scripts:i}}}t.ScriptParser=s;let A=window.scripts={},l=window.triggers={};t.loadRPGScript=async(e,t)=>{let r=`res/rpgscript/${e}.rpgscript`,i=await(await fetch(r)).text(),o=new s(e),{triggers:a,scripts:n}=o.parse(i,t);Object.assign(A,n),Object.assign(l,a)},t.getScript=e=>{let t=A[e];if(!t)throw Error("Cannot get script with name "+e);return t},t.getTrigger=e=>{let t=l[e];if(!t)throw Error("Cannot get trigger with name "+e);return t}})),define("model/overworld",["require","exports","model/room","db/overworlds"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overworldHide=t.overworldShow=t.overworldCharacterCreate=t.overworldEnableTriggers=t.overworldDisableTriggers=t.createOverworldFromTemplate=void 0,t.createOverworldFromTemplate=e=>{let t=i.getRoom(e.roomName);return t?{room:t,visible:!0,triggersEnabled:!0,characterCollisionEnabled:!0,loadTriggerName:e.loadTriggerName,timers:[]}:(console.error("Cannot initiate overworld, no room exists with name: ",e.roomName),null)},t.overworldDisableTriggers=e=>{e.triggersEnabled=!1},t.overworldEnableTriggers=e=>{e.triggersEnabled=!0},t.overworldCharacterCreate=e=>({ch:e.ch}),t.overworldShow=e=>{e.visible=!0,r.roomShow(e.room)},t.overworldHide=e=>{e.visible=!1,r.roomHide(e.room)}})),define("map/battle1",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"battle1.json"}},height:16,infinite:!1,layers:[{data:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],height:16,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:16,x:0,y:0},{draworder:"topdown",id:5,name:"Props",objects:[{gid:17,height:64,id:4,name:"",rotation:0,type:"",visible:!0,width:32,x:32,y:96},{gid:17,height:64,id:7,name:"",rotation:0,type:"",visible:!0,width:32,x:224,y:240},{gid:17,height:64,id:8,name:"",rotation:0,type:"",visible:!0,width:32,x:64,y:32},{gid:18,height:32,id:9,name:"1",rotation:0,type:"",visible:!0,width:32,x:96,y:128},{gid:18,height:32,id:10,name:"3",rotation:0,type:"",visible:!0,width:32,x:80,y:240},{gid:18,height:32,id:11,name:"4",rotation:0,type:"",visible:!0,width:32,x:64,y:160},{gid:18,height:32,id:12,name:"2",rotation:0,type:"",visible:!0,width:32,x:144,y:176},{gid:19,height:32,id:13,name:"2",rotation:0,type:"",visible:!0,width:32,x:160,y:64},{gid:19,height:32,id:14,name:"4",rotation:0,type:"",visible:!0,width:32,x:192,y:32},{gid:19,height:32,id:15,name:"1",rotation:0,type:"",visible:!0,width:32,x:176,y:144},{gid:19,height:32,id:16,name:"3",rotation:0,type:"",visible:!0,width:32,x:128,y:96},{gid:18,height:32,id:24,name:"4",rotation:0,type:"",visible:!0,width:32,x:112,y:208},{gid:18,height:32,id:25,name:"3",rotation:0,type:"",visible:!0,width:32,x:32,y:192},{gid:19,height:32,id:26,name:"2",rotation:0,type:"",visible:!0,width:32,x:208,y:112},{gid:19,height:32,id:27,name:"4",rotation:0,type:"",visible:!0,width:32,x:240,y:80}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:7,nextobjectid:28,orientation:"isometric",renderorder:"left-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:4,firstgid:1,image:"../../res/battle-terrain1.png",imageheight:128,imagewidth:128,margin:0,name:"battle-terrain1",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:0,firstgid:17,grid:{height:1,orientation:"orthogonal",width:1},margin:0,name:"props-dynamic",spacing:0,tilecount:4,tileheight:64,tiles:[{id:0,image:"../../res/tree1.png",imageheight:64,imagewidth:32},{id:1,image:"../../res/markerGreen.png",imageheight:32,imagewidth:32},{id:2,image:"../../res/markerOrange.png",imageheight:32,imagewidth:32},{id:3,image:"../../res/test-prop.png",imageheight:32,imagewidth:96}],tilewidth:96}],tilewidth:32,type:"map",version:1.4,width:16}),define("map/test",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"test.json"}},height:64,infinite:!1,layers:[{data:[129,2,2,11,2,2,2,13,2,2,2,11,2,2,2,2,2,5,5,5,5,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,12,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,8,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,6,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,6,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,10,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,5,5,5,5,5,5,5,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129],height:64,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:64,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:193,height:32,id:1,name:"Skye",rotation:0,type:"",visible:!0,width:32,x:288,y:112}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:4,nextobjectid:3,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:2,firstgid:193,image:"../../res/control.png",imageheight:64,imagewidth:64,margin:0,name:"control",spacing:0,tilecount:4,tileheight:32,tilewidth:32},{columns:16,firstgid:197,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:64}),define("map/test2",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"test2.json"}},height:40,infinite:!1,layers:[{data:[130,2,2,11,2,2,2,13,2,2,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,2,2,2,2,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,12,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,8,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,6,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,6,130,130,130,130,130,130,130,130,16,16,16,16,16,16,16,16,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,10,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,209,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,2,2,2,2,2,2,15,15,2,2,2,2,2,2,2,3,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,16,130,130,16,129,129,129,129,129,129,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,16,130,130,16,129,129,129,129,129,129,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,16,130,130,16,129,129,129,129,129,129,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,2,2,2,2,2,16,15,15,16,2,2,2,2,2,2,3,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,2,2,2,2,2,2,16,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,2,2,2,5,5,5,5,5,5,5,5,5,5,5,2,2,3,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129],height:40,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:40,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:193,height:32,id:3,name:"Skye",rotation:0,type:"",visible:!0,width:32,x:44,y:248},{gid:194,height:32,id:5,name:"MarkerWalkTest1",rotation:0,type:"",visible:!0,width:32,x:76,y:72},{gid:194,height:32,id:6,name:"MarkerWalkTest2",rotation:0,type:"",visible:!0,width:32,x:76,y:276},{gid:195,height:32,id:9,name:"#floor1-vendingPanel",rotation:0,type:"",visible:!0,width:32,x:28,y:268},{height:44,id:11,name:"#floor1-vendingPanel",rotation:0,type:"",visible:!0,width:140,x:12,y:152},{gid:193,height:32,id:18,name:"Roger",rotation:0,type:"",visible:!0,width:32,x:97.25,y:35.75},{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:148,y:48},{height:64,id:20,name:"#floor1-openDoorA",rotation:0,type:"",visible:!0,width:32,x:428,y:280},{height:60,id:21,name:"#floor1-openDoorB",rotation:0,type:"",visible:!0,width:32,x:428,y:220},{gid:194,height:32,id:22,name:"markerDoorA",rotation:0,type:"",visible:!0,width:32,x:436,y:308},{gid:194,height:32,id:23,name:"markerDoorB",rotation:0,type:"",visible:!0,width:32,x:436,y:244},{height:164,id:26,name:"#floor1-closeDoorsAB",rotation:0,type:"",visible:!0,width:64,x:412,y:200},{gid:194,height:32,id:29,name:"MarkerSpawnAtMarker",rotation:0,type:"",visible:!0,width:32,x:440.375,y:41.125},{gid:193,height:32,id:33,name:"Rho",rotation:0,type:"",visible:!0,width:32,x:465.75,y:103.75},{gid:193,height:32,id:35,name:"Sigma",rotation:0,type:"",visible:!0,width:32,x:554.5,y:37},{height:0,id:44,name:"",rotation:0,type:"",visible:!0,width:0,x:459.625,y:232.875},{height:0,id:45,name:"",rotation:0,type:"",visible:!0,width:0,x:473.25,y:218.75},{height:0,id:46,name:"",rotation:0,type:"",visible:!0,width:0,x:476.75,y:221.75},{height:0,id:47,name:"",rotation:0,type:"",visible:!0,width:0,x:459.375,y:220.625},{height:100,id:52,name:"#rho-look-area",rotation:0,type:"",visible:!0,width:100,x:415.875,y:55.125},{gid:194,height:32,id:53,name:"MarkerWalkA",rotation:0,type:"",visible:!0,width:32,x:40,y:84},{gid:194,height:32,id:54,name:"MarkerWalkB",rotation:0,type:"",visible:!0,width:32,x:40,y:136},{gid:194,height:32,id:55,name:"MarkerWalkC",rotation:0,type:"",visible:!0,width:32,x:44,y:40}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:56,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:40}),define("map/floor1-outside",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor1-outside.json"}},height:32,infinite:!1,layers:[{data:[337,338,337,338,337,337,337,337,337,337,337,337,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,17,16,16,338,337,338,337,338,337,337,337,337,337,337,337,358,357,357,357,357,357,357,357,357,357,358,337,337,338,33,132,132,17,16,16,337,338,337,338,337,337,337,337,337,337,337,337,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,17,16,16,338,337,338,337,338,337,337,337,337,337,337,337,358,357,357,357,357,357,357,357,357,357,358,337,337,338,33,132,132,17,16,16,337,338,337,338,337,338,337,337,337,337,337,337,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,17,16,16,338,337,338,337,338,337,338,337,337,337,337,358,358,357,357,357,357,357,357,357,357,357,358,337,337,338,33,132,132,16,16,16,337,338,337,338,337,338,337,337,337,337,337,358,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,16,16,16,338,337,338,337,338,337,338,337,337,337,337,358,358,357,357,357,357,357,357,357,357,357,358,337,337,338,33,132,132,16,16,16,337,338,337,338,337,338,337,338,337,337,337,337,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,16,16,16,338,337,338,337,338,337,338,337,338,337,337,337,358,357,358,357,358,357,358,357,358,357,358,337,337,338,33,132,132,16,16,16,337,338,337,338,337,338,337,338,337,338,337,358,358,358,358,358,358,358,358,358,358,358,358,337,338,33,33,33,132,16,16,16,338,337,338,337,338,337,338,337,338,337,337,338,339,339,338,339,339,338,339,339,338,339,338,337,337,338,33,132,132,16,16,16,131,33,131,33,131,33,131,33,131,33,131,131,131,131,131,131,131,131,131,131,131,131,131,33,131,33,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,136,136,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,136,136,131,131,131,131,131,131,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,131,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,133,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,131,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,131,131,131,131,131,131,131,131,131,132,132,132,132,132,132,132,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,132,132,132,132,132,132,132,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:216,y:240},{gid:356,height:108,id:45,name:"",rotation:0,type:"front",visible:!0,width:177,x:260,y:180},{gid:353,height:64,id:46,name:"",rotation:0,type:"",visible:!0,width:32,x:396,y:248},{gid:353,height:64,id:47,name:"",rotation:0,type:"",visible:!0,width:32,x:44,y:248}],offsetx:4,offsety:4,opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:48,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:337,image:"../../res/walls128.png",imageheight:256,imagewidth:256,margin:0,name:"walls128",spacing:0,tilecount:16,tileheight:128,tilewidth:32},{firstgid:353,source:"../../res/props-dynamic.tiled-sheet.tsx"},{columns:8,firstgid:357,image:"../../res/walls256.png",imageheight:256,imagewidth:256,margin:0,name:"walls256",spacing:0,tilecount:8,tileheight:256,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor1-atrium",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor1-atrium.json"}},height:32,infinite:!1,layers:[{data:[129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,338,338,16,138,138,16,338,338,129,16,138,138,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,338,338,138,138,338,338,129,129,16,138,138,16,129,129,16,16,16,338,338,338,338,338,5,5,5,5,5,5,5,5,5,5,5,338,339,339,338,16,16,16,16,15,15,16,16,129,16,212,212,338,130,130,130,338,137,227,137,227,137,227,137,227,137,137,140,140,140,140,140,140,1,138,138,138,138,138,1,129,16,137,137,338,7,7,9,338,137,137,137,137,137,137,137,137,137,137,140,140,140,140,140,140,1,138,138,138,138,138,1,129,4,137,137,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,138,138,138,138,138,1,129,4,137,137,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,138,138,138,138,138,1,129,4,137,137,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,138,138,138,138,138,1,129,4,137,137,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,138,138,138,138,138,1,129,4,137,137,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,138,138,138,138,138,1,129,4,213,137,137,137,137,137,137,137,137,137,137,140,140,137,137,137,137,137,137,137,137,137,137,1,2,2,2,2,2,3,129,4,213,137,137,137,137,137,137,137,137,137,137,140,140,137,137,137,137,137,137,137,137,137,137,1,129,129,129,129,129,129,129,1,16,137,137,137,137,137,137,137,137,2,2,140,140,140,140,140,2,2,138,138,138,138,2,3,129,129,129,129,129,129,129,1,16,137,137,137,137,137,137,137,137,16,16,140,140,140,140,4,16,16,138,138,138,138,16,16,129,129,129,129,129,129,129,1,215,139,139,137,137,137,137,137,137,216,4,140,140,140,140,4,216,138,138,138,138,138,216,1,129,129,129,129,129,129,129,1,221,139,139,137,137,137,137,137,137,137,4,140,140,140,140,4,226,138,138,138,138,138,138,1,129,129,129,129,129,129,129,1,215,139,139,137,137,137,137,137,137,137,4,140,140,140,140,4,226,138,138,138,138,138,138,1,129,129,129,129,129,129,129,1,221,139,139,137,137,230,137,230,137,137,4,140,140,140,140,4,138,138,138,138,138,138,138,1,129,129,129,129,129,129,129,1,215,137,137,137,137,229,137,229,137,137,4,140,140,140,140,4,138,138,138,138,138,138,138,1,129,129,129,129,129,129,129,1,2,2,2,137,137,137,137,137,137,137,4,140,140,140,140,4,138,138,138,138,138,138,138,1,129,129,129,129,129,129,129,129,129,129,16,226,137,137,137,137,137,137,4,140,140,140,140,4,233,234,234,234,234,234,234,1,129,129,129,129,129,129,129,129,129,129,16,137,137,137,137,137,137,137,4,140,140,140,140,4,138,138,138,138,138,138,138,1,129,129,129,129,129,129,129,129,129,129,16,226,137,230,137,230,137,137,4,140,140,140,140,4,138,138,138,138,138,138,138,1,129,129,129,129,129,129,129,129,129,129,16,137,137,229,137,229,137,137,4,140,140,140,140,4,138,138,138,138,138,138,138,1,129,129,129,129,129,129,129,129,129,129,16,137,137,137,137,137,137,137,1,140,140,140,140,4,138,138,138,138,138,138,138,1,129,129,129,129,129,129,33,129,129,129,16,2,2,2,2,2,2,2,3,140,140,140,140,4,2,2,2,2,2,2,2,3,129,129,129,129,129,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,339,339,339,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,129,129,129,129,129,129,129,129,129,129,33,140,140,140,339,339,339,140,140,140,140,33,33,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,33,140,140,140,140,140,140,140,140,140,140,33,33,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,140,140,129,129,33,33,33,33,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,33,129,129,129,129,140,140,140,140,129,33,33,33,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,338,339,339,338,339,339,338,339,339,338,339,339,338,129,129,129,129,129,129,129,129,129],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:100,y:224},{gid:200,height:32,id:42,name:"MarkerDoorEntrance",rotation:0,type:"",visible:!0,width:32,x:244,y:376},{gid:198,height:32,id:43,name:"MarkerDoorBowling",rotation:0,type:"",visible:!0,width:32,x:356,y:64},{gid:356,height:108,id:44,name:"",rotation:0,type:"front",visible:!0,width:177,x:260,y:504},{gid:193,height:32,id:45,name:"Floor1AtriumDeskEmployee",rotation:0,type:"",visible:!0,width:32,x:348,y:352},{gid:194,height:32,id:46,name:"MarkerDeskEmployeeWalk",rotation:0,type:"",visible:!0,width:32,x:340,y:256},{height:48,id:47,name:"#floor1-atrium-desk-employee",rotation:0,type:"",visible:!0,width:40,x:320,y:296},{gid:194,height:32,id:48,name:"MarkerDoorElevatorA",rotation:0,type:"",visible:!0,width:32,x:84,y:72},{gid:194,height:32,id:49,name:"MarkerElevatorInside",rotation:0,type:"",visible:!0,width:32,x:96,y:56},{gid:193,height:32,id:50,name:"Floor1AtriumElevatorEmployee",rotation:0,type:"",visible:!0,width:32,x:120,y:92},{gid:194,height:32,id:51,name:"MarkerElevatorOutside",rotation:0,type:"",visible:!0,width:32,x:96,y:96},{gid:194,height:32,id:52,name:"MarkerNPCWalkA",rotation:0,type:"",visible:!0,width:32,x:348,y:144},{gid:194,height:32,id:53,name:"MarkerNPCWalkB",rotation:0,type:"",visible:!0,width:32,x:312,y:84},{gid:194,height:32,id:54,name:"MarkerNPCWalkC",rotation:0,type:"",visible:!0,width:32,x:84,y:144},{gid:194,height:32,id:55,name:"MarkerNPCWalkD",rotation:0,type:"",visible:!0,width:32,x:76,y:92},{gid:193,height:32,id:56,name:"Floor1AtriumTicTacToeGirl",rotation:0,type:"",visible:!0,width:32,x:52,y:208},{gid:195,height:32,id:57,name:"#floor1-atrium-TicTacToeMachine",rotation:0,type:"",visible:!0,width:32,x:60,y:252},{gid:195,height:32,id:58,name:"#floor1-atrium-TicTacToeMachine",rotation:0,type:"",visible:!0,width:32,x:60,y:284},{height:16,id:59,name:"#floor1-atrium-elevator-employee",rotation:0,type:"",visible:!0,width:52,x:72,y:76}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:60,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:337,image:"../../res/walls128.png",imageheight:256,imagewidth:256,margin:0,name:"walls128",spacing:0,tilecount:16,tileheight:128,tilewidth:32},{firstgid:353,source:"../../res/props-dynamic.tiled-sheet.tsx"}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor1-bowlingalley",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor1-bowlingalley.json"}},height:16,infinite:!1,layers:[{data:[16,2,2,2,2,2,2,2,2,2,2,2,2,2,2,16,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,16,17,17,17,17,17,17,17,17,17,17,17,130,130,130,17],height:16,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:16,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:204,y:156},{gid:200,height:32,id:43,name:"MarkerDoorA",rotation:0,type:"",visible:!0,width:32,x:216,y:228}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:44,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:16}),define("map/floor2-south",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor2-south.json"}},height:32,infinite:!1,layers:[{data:[2,2,2,2,2,2,2,2,2,2,2,129,129,129,129,129,129,129,129,2,2,2,2,2,2,2,2,2,2,2,2,2,16,140,140,140,140,140,140,140,140,140,16,129,129,129,129,129,129,129,129,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,16,129,129,129,129,129,129,129,129,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,16,129,129,129,129,129,129,129,129,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,16,129,129,129,129,129,129,129,129,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,16,129,129,16,140,140,16,129,129,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,16,129,129,16,140,140,16,129,129,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,16,129,129,16,140,140,16,129,129,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,16,129,129,16,140,140,16,129,129,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,16,129,129,16,140,140,16,129,129,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,16,16,16,16,15,15,16,16,16,16,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,16,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,140,1,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,140,14,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,140,14,140,140,140,140,140,140,140,16,140,140,140,140,140,140,140,140,16,140,140,140,140,140,140,140,140,140,140,140,14,140,140,1,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,14,140,16,16,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,16,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,338,338,338,338,338,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,338,130,130,130,338,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,338,7,7,9,338,33,33,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,140,140,140,140,140,140,140,140,140,140,140,140,1,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,16,2,2,140,140,140,140,140,140,140,140,140,140,1,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,1,129,129,16,140,140,140,140,140,140,140,140,140,140,1,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,2,2,3,129,129,16,140,140,140,140,140,140,140,140,140,140,1,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,16,129,129,129,129,16,140,140,140,140,140,140,140,140,140,140,1,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,16,129,129,129,129,16,140,140,140,140,140,140,140,140,140,140,1,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,16,129,129,129,129,16,2,2,2,2,2,2,2,2,2,2,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,16,129,129],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:264,y:416},{gid:198,height:32,id:41,name:"MarkerDoorElevatorDown",rotation:0,type:"",visible:!0,width:32,x:152,y:424},{gid:198,height:32,id:43,name:"MarkerDoorCafeteria",rotation:0,type:"",visible:!0,width:32,x:248,y:200},{gid:199,height:32,id:45,name:"MarkerDoorB",rotation:0,type:"",visible:!0,width:32,x:476,y:260}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:46,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:337,image:"../../res/walls128.png",imageheight:256,imagewidth:256,margin:0,name:"walls128",spacing:0,tilecount:16,tileheight:128,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor2-cafeteria",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor2-cafeteria.json"}},height:32,infinite:!1,layers:[{data:[129,129,129,2,2,2,2,2,2,2,130,130,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,129,129,129,129,129,129,129,129,16,130,130,130,130,130,16,130,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,16,130,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,16,130,130,16,130,130,227,130,130,130,227,130,130,130,227,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,16,130,130,16,130,226,223,225,130,130,223,130,130,226,223,225,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,16,15,15,16,130,130,224,130,130,130,224,130,130,130,224,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,16,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,136,136,136,136,130,130,227,130,130,130,227,130,130,130,227,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,136,136,136,136,130,226,223,228,130,130,223,130,130,226,223,225,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,136,136,136,136,130,130,224,130,130,130,130,130,130,130,224,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,16,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,136,136,136,136,130,130,227,130,130,130,227,130,130,130,227,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,136,136,136,136,130,226,223,225,130,130,223,130,130,226,223,225,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,136,136,136,136,130,130,224,130,130,130,224,130,130,130,224,130,130,1,129,129,129,129,129,129,129,129,1,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,12,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,10,130,130,130,130,130,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,1,130,130,130,130,130,136,136,136,136,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,1,130,130,130,130,130,2,15,15,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,129,129,129,129,129,129,129,129,1,17,17,17,17,17,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,16,129,129,129,129,129,129,129,129,1,130,130,130,130,130,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,16,129,129,129,129,129,129,129,129,1,130,130,130,130,130,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,16,129,129,129,129,129,129,129,129,1,130,130,130,130,130,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,16,129,129,129,129,129,129,129,129,1,17,17,17,17,17,16,130,130,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,129,129,129,129,129],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:192,y:260},{gid:198,height:32,id:43,name:"MarkerDoorNorth",rotation:0,type:"",visible:!0,width:32,x:184,y:128},{gid:200,height:32,id:46,name:"MarkerDoorSouth",rotation:0,type:"",visible:!0,width:32,x:184,y:396}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:47,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor2-north",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor2-north.json"}},height:32,infinite:!1,layers:[{data:[1,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,15,15,16,16,16,16,16,16,1,210,130,130,130,130,130,16,130,130,130,16,130,130,130,16,130,130,130,16,130,130,130,16,130,130,16,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,209,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,17,17,17,17,17,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,17,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,210,210,210,210,210,210,17,1,2,15,15,2,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,1,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,16,16,130,130,16,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:104,y:356},{gid:198,height:32,id:43,name:"MarkerDoorPrepRoom",rotation:0,type:"",visible:!0,width:32,x:408,y:48},{gid:200,height:32,id:46,name:"MarkerDoorCafeteria",rotation:0,type:"",visible:!0,width:32,x:56,y:396}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:47,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor2-preproom",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor2-preproom.json"}},height:21,infinite:!1,layers:[{data:[17,16,17,16,17,16,17,16,17,16,17,16,17,16,17,16,17,16,17,16,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,16,16,16,16,337,337,337,337,337,337,337,16,16,16,16,16,16,16,17,16,16,16,16,16,16,338,338,338,338,338,338,338,16,16,16,16,16,16,17,16,16,16,16,16,212,212,338,130,130,130,130,130,338,216,216,16,16,16,16,16,17,16,16,16,16,138,138,338,7,7,9,7,7,338,138,138,16,16,16,16,17,16,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,16,17,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,17,16,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,16,17,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,17,16,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,16,17,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,17,16,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,16,17,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,17,16,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,16,17,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,17,16,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,16,17,16,16,16,16,138,138,138,138,138,138,138,138,138,138,138,16,16,16,16,17,16,17,16,17,16,16,16,16,16,15,15,16,16,16,16,16,16,17,16,17,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],height:21,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:21,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:164,y:208},{gid:200,height:32,id:47,name:"MarkerDoorNorthRoom",rotation:0,type:"",visible:!0,width:32,x:164,y:292}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:48,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:337,image:"../../res/walls128.png",imageheight:256,imagewidth:256,margin:0,name:"walls128",spacing:0,tilecount:16,tileheight:128,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:21}),define("db/overworlds",["require","exports","model/room","view/style","map/battle1","map/test","map/test2","map/floor1-outside","map/floor1-atrium","map/floor1-bowlingalley","map/floor2-south","map/floor2-cafeteria","map/floor2-north","map/floor2-preproom"],(function(e,t,r,i,o,a,n,s,A,l,c,d,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.getIfExists=t.get=t.getRoom=t.loadRooms=void 0,o=__importStar(o),a=__importStar(a),n=__importStar(n),s=__importStar(s),A=__importStar(A),l=__importStar(l),c=__importStar(c),d=__importStar(d),u=__importStar(u),h=__importStar(h);let g=window.rooms={},m={floor1Outside:s,floor1Atrium:A,floor1Bowling:l,floor2South:c,floor2Cafeteria:d,floor2North:u,floor2PrepRoom:h},p=async(e,t)=>{g[e]=await r.createRoom(e,t)};t.loadRooms=async()=>{await p("battle1",o),await p("test",a),await p("test2",n);for(let e in m)await p(e,m[e])},t.getRoom=e=>g[e];let E=window.overworlds={};t.get=e=>{let t=E[e];if(!t)throw Error("No overworld exists with name: "+e);return Object.assign({},t)},t.getIfExists=e=>{let t=E[e];return t?Object.assign({},t):null},t.init=async()=>{await t.loadRooms(),E.TEST={roomName:"test",backgroundColor:"black"},E.TEST2={roomName:"test2",loadTriggerName:"floor1",backgroundColor:"black"};for(let e in m)E[e]={roomName:e,loadTriggerName:e,backgroundColor:"black"};E.floor1Outside.backgroundColor=i.colors.DARKBLUE}})),define("view/icons/Shield",["require","exports","preact"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>r.h("svg",{fill:e.color,stroke:e.color,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},r.h("path",{d:"M0 0h512v512H0z",fill:"rgba(0, 0, 0, 0)","fill-opacity":"0"}),r.h("g",{class:"",transform:"translate(0,0)",style:""},r.h("path",{d:"M256 16c25 24 100 72 150 72v96c0 96-75 240-150 312-75-72-150-216-150-312V88c50 0 125-48 150-72z",fill:e.color,"fill-opacity":"1"})))})),define("view/icons/Sword",["require","exports","preact"],(function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>r.h("svg",{fill:e.color,stroke:e.color,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},r.h("g",{class:"",transform:"translate(0,0)",style:""},r.h("path",{d:"M491.844 22.533l-83.42 14.865L196.572 249.25c3.262 4.815 5.37 10.72 5.37 16.932 0 5.863-1.71 11.35-4.643 15.996-5.065-1.606-10.448-2.477-16.027-2.477-15.724 0-29.904 6.89-39.69 17.796l-9.112-9.113 17.237-17.237c-4.515-5.772-8.907-11.645-13.19-17.6l-19.443 19.44-13.215-13.215 21.828-21.827c-4.403-6.59-8.67-13.278-12.792-20.068l-40.802 40.803 58.314 58.314c-1.613 5.075-2.49 10.47-2.49 16.063 0 7.666 1.65 14.96 4.592 21.564l-72.14 72.14-14.56-14.56L21.013 437l14.558 14.56-8.607 8.608 27.246 27.246 8.606-8.61 14.56 14.56 24.798-24.8-14.557-14.556 72.158-72.16c6.586 2.922 13.858 4.562 21.498 4.562 5.593 0 10.988-.877 16.063-2.49l58.363 58.363L296.5 401.48c-6.797-4.127-13.486-8.395-20.068-12.793l-21.83 21.83L241.39 397.3l19.442-19.44c-5.962-4.29-11.835-8.683-17.603-13.194l-17.238 17.238-9.16-9.16c10.905-9.785 17.795-23.965 17.795-39.69 0-5.346-.806-10.51-2.285-15.39 4.703-3.04 10.288-4.817 16.265-4.816 6.21 0 11.776 1.77 16.52 4.955L476.98 105.95l14.864-83.417zm-66.227 53.012l13.215 13.215-191.684 191.68-13.214-13.213L425.617 75.545zM181.273 298.39c19.257 0 34.665 15.41 34.665 34.665 0 19.256-15.408 34.666-34.665 34.666-19.256 0-34.666-15.41-34.666-34.665s15.41-34.666 34.666-34.666z",fill:"#fff","fill-opacity":"1"})))})),define("controller/battle-actions",["require","exports","model/battle","model/character","model/room","model/utility","utils","model/particle","controller/battle-management","view/icons/Shield","view/icons/Sword"],(function(e,t,r,i,o,a,n,s,A,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BattleActions=void 0,l=__importDefault(l),c=__importDefault(c);let d=(e,t)=>!!r.battleCharacterCanAct(e,t);t.BattleActions={Swing:{name:"Swing",description:"Jump to target and swing your weapon.",cooldown:1e4,icon:c.default,cb:async(e,t)=>{if(!d(e,t))return;let l=t.ch,c=r.battleGetAllegiance(e,l),u=r.battleGetNearestAttackable(e,c);if(u){A.beginAction(e,t);let d=i.characterGetPos(l),h=i.characterGetPos(u.ch);c===r.BattleAllegiance.ALLY?(h[0]-=o.TILE_WIDTH/2,r.battleCharacterGetRow(t)===r.BattleRow.BOTTOM&&(h[0]+=o.TILE_WIDTH/2,h[1]+=o.TILE_WIDTH/2)):(h[0]+=o.TILE_WIDTH/2,r.battleCharacterGetRow(t)===r.BattleRow.TOP&&(h[0]-=o.TILE_WIDTH/2,h[1]-=o.TILE_WIDTH/2));let g=n.calculateDistance(d,h),m=new a.Transform(d,h,250*n.normalize(g,35,125,1,1.75),a.TransformEase.LINEAR,(e=>e<45?a.transformOffsetJumpShort:e<100?a.transformOffsetJumpMedium:a.transformOffsetJumpFar)(g));i.characterSetTransform(l,m),i.characterSetAnimationState(l,i.AnimationState.BATTLE_JUMP),await m.timer.onCompletion(),n.timeoutPromise(300).then(()=>{let[r,a]=i.characterGetPosCenterPx(u.ch),n=s.particleCreateFromTemplate([r,a],s.EFFECT_TEMPLATE_SWORD_LEFT);o.roomAddParticle(e.room,n),A.applyWeaponDamage(e,t,u,1,1)}),i.characterSetAnimationState(l,i.AnimationState.BATTLE_ATTACK);let p=i.characterGetAnimation(l);await p.onCompletion();let E=m.createInverse();i.characterSetTransform(l,E),i.characterSetAnimationState(l,i.AnimationState.BATTLE_JUMP),await E.timer.onCompletion(),E.markForRemoval(),i.characterSetAnimationState(l,i.AnimationState.BATTLE_IDLE),A.endAction(e,t)}}},SwingSlow:{name:"SwingSlow",description:"A slower version of the swing.",cooldown:1e5,icon:c.default,cb:async(e,r)=>t.BattleActions.Swing.cb(e,r)},Defend:{name:"Defend",description:"Brace yourself for an attack, taking less damage and reducing stagger for a short time.",cooldown:5e3,icon:l.default,cb:async(e,t)=>{if(!d(e,t))return;A.beginAction(e,t);let n=t.ch,s=await(async(e,t)=>{let n=t.ch,s=r.battleGetAllegiance(e,n),A=i.characterGetPos(n),l=[...A];s===r.BattleAllegiance.ALLY?(l[0]+=o.TILE_WIDTH/2,l[1]-=o.TILE_WIDTH/2):(l[0]-=o.TILE_WIDTH/2,l[1]+=o.TILE_WIDTH/2);let c=new a.Transform(A,l,200,a.TransformEase.LINEAR,a.transformOffsetJumpShort);return i.characterSetTransform(n,c),i.characterSetAnimationState(n,i.AnimationState.BATTLE_JUMP),await c.timer.onCompletion(),c})(e,t);i.characterSetAnimationState(n,i.AnimationState.BATTLE_ITEM);let l=i.characterGetAnimation(n);await l.onCompletion(),r.battleCharacterAddStatus(t,r.Status.DEFEND);let c=s.createInverse();i.characterSetTransform(n,c),i.characterSetAnimationState(n,i.AnimationState.BATTLE_JUMP),await c.timer.onCompletion(),c.markForRemoval(),i.characterSetAnimationState(n,i.AnimationState.BATTLE_IDLE),A.setCasting(t,{castTime:5e3,onCast:()=>{r.battleCharacterRemoveStatus(t,r.Status.DEFEND)},onInterrupt:()=>{r.battleCharacterRemoveStatus(t,r.Status.DEFEND)}}),A.endAction(e,t)}}}})),define("controller/battle-ai",["require","exports","model/battle","controller/battle-actions"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BATTLE_AI_ATTACK=void 0,t.BATTLE_AI_ATTACK=(e,t)=>{let o=r.battleGetAllegiance(e,t.ch);r.battleGetNearestAttackable(e,o)&&i.BattleActions.Swing.cb(e,t)}})),define("model/battle",["require","exports","model/room","model/character","controller/battle-management","model/utility"],(function(e,t,r,i,o,a){"use strict";var n,s,A;Object.defineProperty(t,"__esModule",{value:!0}),t.battleGetNearestAttackable=t.battleGetCharactersOfAllegiance=t.battleGetOppositeAllegiance=t.battleGetAllegiance=t.battleIsLoss=t.battleIsVictory=t.battleSetActorPositions=t.battleCharacterGetRow=t.battleCharacterGetSelectedSkill=t.battleCharacterRemoveStatus=t.battleCharacterAddStatus=t.battleCharacterRemoveCanActCb=t.battleCharacterSetCanActCb=t.battleCharacterCanAct=t.battleCharacterApplyDamage=t.battleCharacterSetStaggered=t.battleCharacterCreateAlly=t.battleCharacterCreateEnemy=t.battleStatsCreate=t.Status=t.BattleAllegiance=t.BattleRow=t.BattlePosition=void 0,function(e){e.FRONT="front",e.MIDDLE="middle",e.BACK="back"}(n=t.BattlePosition||(t.BattlePosition={})),function(e){e.TOP="top",e.BOTTOM="bottom",e.NONE="none"}(s=t.BattleRow||(t.BattleRow={})),function(e){e.ALLY="ally",e.ENEMY="enemy"}(A=t.BattleAllegiance||(t.BattleAllegiance={})),(t.Status||(t.Status={})).DEFEND="defend",t.battleStatsCreate=()=>({POW:5,ACC:1,SPD:1,FOR:1,HP:1,STAGGER:2});let l=(e,t,r)=>{var i;let n=e.skills[e.skillIndex],A=o.calculateStaggerDamage(e);return{ch:e,isDefeated:!1,shouldRemove:!1,actionTimer:new a.Timer(null!==(i=null==n?void 0:n.cooldown)&&void 0!==i?i:2e3),staggerTimer:new a.Timer(1e3),staggerGauge:new a.Gauge(A,.02),castTimer:new a.Timer(1e3),position:t,isActing:!1,isCasting:!1,canAct:!1,isStaggered:!1,statuses:[],row:s.NONE,onCanActCb:function(){},onCast:function(){},onCastInterrupted:function(){},ai:r}};t.battleCharacterCreateEnemy=(e,t)=>l(e,t.position,t.ai),t.battleCharacterCreateAlly=(e,t)=>l(e,t.position),t.battleCharacterSetStaggered=e=>{e.isStaggered=!0,e.staggerTimer.start(),e.staggerGauge.empty(),i.characterSetAnimationState(e.ch,i.AnimationState.BATTLE_STAGGERED)},t.battleCharacterApplyDamage=(e,t)=>{i.characterModifyHp(e.ch,-t),e.isStaggered?i.characterSetAnimationState(e.ch,i.AnimationState.BATTLE_STAGGERED):(i.characterSetAnimationState(e.ch,i.AnimationState.BATTLE_DAMAGED),i.characterOnAnimationCompletion(e.ch,()=>{i.characterSetAnimationState(e.ch,e.isStaggered?i.AnimationState.BATTLE_STAGGERED:i.AnimationState.BATTLE_IDLE)}))},t.battleCharacterCanAct=(e,r)=>{if(r.isActing)return!1;let i=t.battleGetAllegiance(e,r.ch)===A.ALLY?e.enemies:e.allies;for(let e=0;e<i.length;e++)if(i[e].isActing)return!1;return r.actionTimer.isComplete()},t.battleCharacterSetCanActCb=(e,t)=>{e.onCanActCb=t},t.battleCharacterRemoveCanActCb=e=>{e.onCanActCb=function(){}},t.battleCharacterAddStatus=(e,t)=>{e.statuses.includes(t)||e.statuses.push(t)},t.battleCharacterRemoveStatus=(e,t)=>{let r=e.statuses.indexOf(t);r>-1&&e.statuses.splice(r,1)},t.battleCharacterGetSelectedSkill=e=>e.ch.skills[e.ch.skillIndex],t.battleCharacterGetRow=e=>e.row;let c={[n.FRONT]:[[5,7],[8,10]],[n.MIDDLE]:[[3,9],[6,12]],[n.BACK]:[[1,11],[4,14]]},d={[n.FRONT]:[[7,5],[10,8]],[n.MIDDLE]:[[9,3],[12,6]],[n.BACK]:[[11,1],[14,4]]};t.battleSetActorPositions=e=>{let t={[n.FRONT]:0,[n.MIDDLE]:0,[n.BACK]:0},i=(e,t)=>i=>{let o=[0,0],a=0;switch(i.position){case n.FRONT:a=e[n.FRONT],o=t[n.FRONT][e[n.FRONT]++];break;case n.MIDDLE:a=e[n.MIDDLE],o=t[n.MIDDLE][e[n.MIDDLE]++];break;case n.BACK:a=e[n.BACK],o=t[n.BACK][e[n.BACK]++]}let[A,l]=r.tilePosToWorldPos(o[0],o[1]);a<=1?(i.row=0===a?s.TOP:s.BOTTOM,i.ch.x=A,i.ch.y=l):console.error("Error setting actor position for battle, Row number is greater than 1 (most likely more than 2 actors in a battle position)",i)};e.allies.forEach(i({[n.FRONT]:0,[n.MIDDLE]:0,[n.BACK]:0},c)),e.enemies.forEach(i(t,d))},t.battleIsVictory=e=>0===e.enemies.length,t.battleIsLoss=e=>0===e.allies.length,t.battleGetAllegiance=(e,t)=>{if(e.enemies.find(e=>e.ch===t))return A.ENEMY;if(e.allies.find(e=>e.ch===t))return A.ALLY;throw Error(`Cannot get battle allegiance for character '${t.name}' that does not exist in battle.`)},t.battleGetOppositeAllegiance=e=>e===A.ALLY?A.ENEMY:A.ALLY,t.battleGetCharactersOfAllegiance=(e,t)=>{switch(t){case A.ALLY:return e.allies;case A.ENEMY:return e.enemies;default:return e.allies}},t.battleGetNearestAttackable=(e,r)=>{let i,o=t.battleGetCharactersOfAllegiance(e,t.battleGetOppositeAllegiance(r));return i=o.find(e=>e.position===n.FRONT),i||(i=o.find(e=>e.position===n.MIDDLE)),i||(i=o.find(e=>e.position===n.BACK)),null!=i?i:null}})),define("model/render-object",["require","exports","model/sprite","utils","model/room"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTileRenderObject=t.createTriggerActivatorRenderObject=t.createMarkerRenderObject=t.createPropRenderObject=void 0,t.createPropRenderObject=e=>{if(e.isDynamic){let[,,,t,o]=r.getSprite(e.sprite),[a,n]=i.isoToPixelCoords(e.x,e.y);return n=n-o+20,a=a-t/2+20,{sprite:e.sprite,px:a,py:n,sortY:e.isFront?1/0:n+o,visible:!0}}{let[t,a]=i.isoToPixelCoords(e.x,e.y),[,,,n,s]=r.getSprite(e.sprite);return t-=t-n/2+o.TILE_WIDTH/2,a=a-s+o.TILE_HEIGHT/2,{sprite:e.sprite,px:t,py:a,sortY:a+s,visible:!0}}},t.createMarkerRenderObject=e=>{let{x:t,y:r}=e,[o,a]=i.isoToPixelCoords(t,r,0);return{name:e.name,sprite:"control_1",px:o,py:a,sortY:a+32,visible:!0,isMarker:!0}},t.createTriggerActivatorRenderObject=e=>{if(e.polygon)return{name:e.name,polygon:e.polygon,sortY:1/0,visible:!0,isTrigger:!0};{let{x:t,y:r}=e,[o,a]=i.isoToPixelCoords(t,r,0);return{name:e.name,sprite:"control_2",px:o,py:a,sortY:a+32,visible:!0,isTrigger:!0}}},t.createTileRenderObject=(e,t)=>{let[r,a]=i.isoToPixelCoords(e.x*o.TILE_WIDTH/2,e.y*o.TILE_HEIGHT/2),n=a;return a-=e.tileHeight-32,{sprite:e.sprite,origPy:n,px:r,py:a,highlighted:e.highlighted,isFloor:e.sprite.indexOf("floors")>-1,sortY:a+(e.tileHeight-32)+(e.tileHeight>32?20:16)+(null!=t?t:0),visible:!0}}})),define("db/overworld-ai",["require","exports","model/character","model/utility","model/generics"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.getIfExists=t.get=void 0;let a={};t.get=e=>{let t=a[e];if(!t)throw Error("No overworld-ai exists with name: "+e);return Object.assign({},t)},t.getIfExists=e=>{let t=a[e];return t?Object.assign({},t):null},t.init=()=>{a.DO_NOTHING={update:function(){}},a.WALK_BETWEEN_MARKERS_ABC=function(){let e=["MarkerWalkA","MarkerWalkB","MarkerWalkC"],t=(t,i)=>{let a=o.getCurrentRoom(),n=t.aiState.nextMarker,s=e[n];t.aiState.nextMarker=(n+1)%e.length;let A=a.markers[s];A?r.characterSetWalkTarget(t,[A.x,A.y],i):console.error("OAI: Could not find target marker with name: "+s)};return{onCreate:e=>{e.aiState.isWaiting=!0,e.aiState.nextMarker=0;let o=new i.Timer(500);o.awaits.push(()=>{t(e,()=>{e.aiState.isWaiting=!1})}),r.characterAddTimer(e,o)},update:e=>{if(!e.aiState.isWaiting){e.aiState.isWaiting=!0;let o=new i.Timer(600);o.awaits.push(()=>{t(e,()=>{e.aiState.isWaiting=!1})}),r.characterAddTimer(e,o)}}}}()}})),define("model/character",["require","exports","model/animation","model/battle","utils","controller/battle-actions","model/generics","model/room","model/canvas","view/draw","model/player","db/overworld-ai"],(function(e,t,r,i,o,a,n,s,A,l,c,d){"use strict";var u,h;Object.defineProperty(t,"__esModule",{value:!0}),t.characterUpdate=t.characterRestoreState=t.characterStoreState=t.characterHasTimer=t.characterStartAi=t.characterStopAi=t.characterRemoveTimer=t.characterAddTimer=t.characterHasTag=t.characterRemoveTag=t.characterAddTag=t.characterCollidesWithRect=t.characterCollidesWithPoint=t.characterResetSpeed=t.characterSetSpeed=t.characterSetWalkTarget=t.characterGetSize=t.characterGetPosCenterPx=t.characterGetPosPx=t.characterGetPosBottom=t.characterGetPos=t.characterSetTransform=t.characterGetHpPct=t.characterModifyHp=t.characterSetFacingFromAngle=t.characterSetFacing=t.characterOnAnimationCompletion=t.characterSetPos=t.characterOverrideAnimation=t.characterSetAnimationState=t.characterGetAnimation=t.characterGetAnimKey=t.characterCreateFromTemplate=t.characterCreate=t.ANIMATIONS_WITHOUT_FACING=t.AnimationState=t.Facing=t.DEFAULT_SPEED=void 0,t.DEFAULT_SPEED=.5,function(e){e.LEFT="left",e.UP="up",e.DOWN="down",e.LEFT_UP="leftup",e.LEFT_DOWN="leftdown",e.RIGHT="left_f",e.RIGHT_UP="leftup_f",e.RIGHT_DOWN="leftdown_f",e.RIGHT2="right",e.RIGHT_UP2="rightup",e.RIGHT_DOWN2="rightdown"}(u=t.Facing||(t.Facing={})),function(e){e.OVERRIDDEN="overridden",e.IDLE="idle",e.WALK="walk",e.BATTLE_IDLE="battle_idle",e.BATTLE_JUMP="battle_jump",e.BATTLE_ATTACK="battle_attack",e.BATTLE_DAMAGED="battle_damaged",e.BATTLE_STAGGERED="battle_staggered",e.BATTLE_ITEM="battle_item",e.BATTLE_FLOURISH="battle_flourish",e.BATTLE_DEFEATED="battle_defeated"}(h=t.AnimationState||(t.AnimationState={})),t.ANIMATIONS_WITHOUT_FACING=[h.BATTLE_FLOURISH],t.characterCreate=e=>{let r={name:e,nameLabel:e,spriteBase:"ada",x:0,y:0,z:0,vx:0,vy:0,speed:t.DEFAULT_SPEED,transform:null,hp:10,stats:i.battleStatsCreate(),skills:[a.BattleActions.SWING],skillIndex:0,facing:u.LEFT,animationState:h.IDLE,animationKey:"",animationOverride:null,storedAnimations:{},walkTarget:null,walkAngle:0,walkDistance:0,walkRetries:0,onReachWalkTarget:null,talkTrigger:"",aiState:{},aiEnabled:!0,overworldAi:d.get("DO_NOTHING"),storedState:{},timers:[],tags:[]};return r.ro={character:r,sortY:0,visible:!0},r.animationKey=t.characterGetAnimKey(r),r},t.characterCreateFromTemplate=e=>{var r;let i=t.characterCreate(e.name);return i.spriteBase=e.spriteBase,i.facing=e.facing||i.facing,i.animationState=e.animationState||i.animationState,i.animationKey=t.characterGetAnimKey(i),i.hp=i.stats.HP,i.stats=Object.assign({},e.stats||i.stats),i.skills=e.skills||i.skills,i.talkTrigger=null!==(r=e.talkTrigger)&&void 0!==r?r:"",i.tags=e.tags||[],e.overworldAi&&(i.overworldAi=d.get(e.overworldAi)),i.overworldAi.onCreate&&i.overworldAi.onCreate(i),e.nameLabel&&(i.nameLabel=e.nameLabel),i},t.characterGetAnimKey=e=>{let{spriteBase:r,facing:i,animationState:o}=e;return t.ANIMATIONS_WITHOUT_FACING.includes(o)?`${r}_${o}`:`${r}_${o}_${i}`},t.characterGetAnimation=e=>{let{storedAnimations:i}=e;if(e.animationState===h.OVERRIDDEN){let t=e.animationOverride;if(t)return t;throw Error("Null overridden animation.")}let o=t.characterGetAnimKey(e),a=i[o];if(a)return a;{let e=r.createAnimation(o);return i[o]=e,e}},t.characterSetAnimationState=(e,r)=>{e.animationState=r;let i=t.characterGetAnimKey(e);if(i!==e.animationKey){if(e.animationPromise&&(e.animationPromise.reject(),e.animationPromise=void 0),e.animationState===h.OVERRIDDEN)return;e.animationKey=i;let r=t.characterGetAnimation(e);r.reset(),r.start()}},t.characterOverrideAnimation=(e,r,i)=>{t.characterSetAnimationState(e,h.OVERRIDDEN),e.animationOverride=r,i&&(r.loop||r.awaits.push(i)),r.reset(),r.start()},t.characterSetPos=(e,t)=>{e.x=t[0],e.y=t[1],e.z=t[2]},t.characterOnAnimationCompletion=(e,r)=>{e.animationPromise&&e.animationPromise.reject();let i=t.characterGetAnimation(e),o={},a=new Promise((t,r)=>{o.resolve=t,o.reject=r,(async()=>{await i.onCompletion(),e.animationPromise=void 0,t()})()}).then(()=>{r()}).catch(e=>{});return e.animationPromise=o,a},t.characterSetFacing=(e,r)=>{e.facing=r,t.characterSetAnimationState(e,e.animationState)},t.characterSetFacingFromAngle=(e,r)=>{if(r>337.5||r<22.5)return void t.characterSetFacing(e,u.UP);let i=[u.UP,u.RIGHT_UP,u.RIGHT,u.RIGHT_DOWN,u.DOWN,u.LEFT_DOWN,u.LEFT,u.LEFT_UP];for(let o=1;o<8;o++)r>=45*o-22.5&&r<45*(o+1)-22.5&&t.characterSetFacing(e,i[o])},t.characterModifyHp=(e,t)=>{e.hp+=t,e.hp>e.stats.HP?e.hp=e.stats.HP:e.hp<0&&(e.hp=0)},t.characterGetHpPct=e=>+(e.hp/e.stats.HP).toFixed(2),t.characterSetTransform=(e,t)=>{e.transform=t},t.characterGetPos=e=>e.transform?e.transform.current():[e.x,e.y,e.z],t.characterGetPosBottom=e=>{let{x:t,y:r}=e;return[t+16,r+16-4]},t.characterGetPosPx=e=>{let[r,i,a]=t.characterGetPos(e);return o.isoToPixelCoords(r,i,a)},t.characterGetPosCenterPx=e=>{let[r,i]=t.characterGetPosPx(e),[o,a]=t.characterGetSize(e);return[r+o/2,i+a/2]},t.characterGetSize=e=>t.characterGetAnimation(e).getSpriteSize(0),t.characterSetWalkTarget=(e,r,i)=>{e.walkTarget=r,e.onReachWalkTarget=i;let a=t.characterGetPosBottom(e),n=g(e),s=o.getAngleTowards(a,n);e.walkAngle=s,e.walkDistance=o.calculateDistance(o.extrapolatePoint(a),o.extrapolatePoint(n)),e.walkRetries=0};let g=e=>e.walkTarget?[e.walkTarget[0]+16,e.walkTarget[1]+16-4]:[0,0];t.characterSetSpeed=(e,t)=>{e.speed=t},t.characterResetSpeed=e=>{e.speed=t.DEFAULT_SPEED},t.characterCollidesWithPoint=(e,r)=>{let i=[...t.characterGetPosBottom(e),1];return o.circleCircleCollision(i,r)},t.characterCollidesWithRect=(e,r)=>{let i=[...t.characterGetPosBottom(e),2];return"none"!==o.circleRectCollision(i,r)},t.characterAddTag=(e,r)=>{t.characterHasTag(e,r)||e.tags.push(r)},t.characterRemoveTag=(e,t)=>{let r=e.tags.indexOf(t);r>-1&&e.tags.splice(r,1)},t.characterHasTag=(e,t)=>e.tags.includes(t),t.characterAddTimer=(e,r)=>{t.characterHasTimer(e,r)||e.timers.push(r)},t.characterRemoveTimer=(e,t)=>{let r=e.timers.indexOf(t);r>-1&&e.timers.splice(r,1)},t.characterStopAi=e=>{t.characterStoreState(e),e.aiEnabled=!1,t.characterSetAnimationState(e,h.IDLE)},t.characterStartAi=e=>{e.aiEnabled=!0,t.characterRestoreState(e)},t.characterHasTimer=(e,t)=>e.timers.includes(t),t.characterStoreState=e=>{e.storedState.facing=e.facing},t.characterRestoreState=e=>{e.storedState.facing&&t.characterSetFacing(e,e.storedState.facing)},t.characterUpdate=e=>{let r=n.getCurrentRoom(),i=n.getFrameMultiplier();if(e.transform&&(e.transform.update(),e.transform.shouldRemove&&(e.transform=null)),e.walkTarget){let r=t.characterGetPosBottom(e),i=g(e),a=o.getAngleTowards(r,i);e.walkAngle=a;let n=Math.sin(e.walkAngle*Math.PI/180),s=-Math.cos(e.walkAngle*Math.PI/180),A=e.walkDistance;e.walkDistance=o.calculateDistance(o.extrapolatePoint(r),o.extrapolatePoint(i)),A<=e.walkDistance&&e.walkRetries++,e.vx=n,e.vy=s,t.characterSetAnimationState(e,h.WALK),(e.walkRetries>10||t.characterCollidesWithPoint(e,[...i,1.5]))&&(t.characterSetAnimationState(e,h.IDLE),t.characterSetPos(e,[...e.walkTarget,e.z]),e.onReachWalkTarget&&e.onReachWalkTarget(),e.walkTarget=null,e.onReachWalkTarget=null)}if(0!==e.vx||0!==e.vy){let[a,n]=o.getNormalizedVec(e.vx,e.vy),A=a*i*e.speed,l=n*i*e.speed,{x:c,y:d}=e;e.x+=A,e.y+=l;let u=o.getAngleFromVector(-A,-l)-45;u<0&&(u+=360),t.characterSetFacingFromAngle(e,u);let h=s.roomGetTileBelow(r,[e.x,e.y]),g=null,p=null;h&&(g=s.roomGetTileAt(r,h.x,Math.floor((e.y+22)/s.TILE_HEIGHT_WORLD)),p=s.roomGetTileAt(r,Math.floor((e.x+22)/s.TILE_WIDTH_WORLD),h.y));let E=m(g)||m(p);((null==h?void 0:h.isWall)||E)&&(e.x=c,e.y=d),e.vx=0,e.vy=0}let[a,A,l]=t.characterGetPos(e),[,c]=o.isoToPixelCoords(a,A,l);e.ro&&(e.ro.sortY=c+32)};let m=e=>(null==e?void 0:e.isWall)&&!(null==e?void 0:e.isProp)})),define("model/room",["require","exports","model/sprite","utils","model/character","db/characters","view/draw","lib/rpgscript","db/tiles","model/animation","model/render-object","model/canvas"],(function(e,t,r,i,o,a,n,s,A,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.roomHide=t.roomShow=t.roomRemoveCharacter=t.roomAddCharacter=t.roomGetCharacterByName=t.roomGetTileBelow=t.roomAddParticle=t.roomGetTileAt=t.createRoom=t.tilePosToWorldPos=t.TILE_HEIGHT_WORLD=t.TILE_WIDTH_WORLD=t.TILE_HEIGHT=t.TILE_WIDTH=void 0,t.TILE_WIDTH=32,t.TILE_HEIGHT=32,t.TILE_WIDTH_WORLD=16,t.TILE_HEIGHT_WORLD=16,t.tilePosToWorldPos=(e,r)=>[e*t.TILE_WIDTH/2,r*t.TILE_HEIGHT/2];let u=e=>["props_0","props_1","props_2","props_3","props_4","props_5","props_6","props_8","props_9","props_10","props_11","props_12","props_13"].includes(e),h=null;t.createRoom=async(e,g)=>{h||await(async()=>{var e,t;let r=await fetch("res/props-dynamic.tiled-sheet.tsx").then(e=>e.text());r&&(h=null!==(t=null===(e=r.match(/source="(.*)\.[\w]+"/g))||void 0===e?void 0:e.map(e=>e.slice(e.indexOf('"')+1,e.lastIndexOf('"')-4)))&&void 0!==t?t:null)})();let{width:m,height:p,data:E}=g.layers[0],{objects:f}=g.layers.find(e=>"Props"===e.name)||{},{objects:w}=g.layers.find(e=>"Objects"===e.name)||{},{firstgid:C}=g.tilesets.find(e=>{var t;return"props-dynamic"===e.name||(null!==(t=e.source)&&void 0!==t?t:"").indexOf("props-dynamic")>-1})||{firstGid:-9999999},y=m*t.TILE_WIDTH,x=p*t.TILE_HEIGHT/2,[B,b]=d.createCanvas(y,x+t.TILE_HEIGHT),S={tiledJson:g,width:m,height:p,widthPx:y,heightPx:x,props:[],tiles:[],characters:[],particles:[],markers:{},triggerActivators:[],renderObjects:[],floorTileObjects:[],floor:r.createSprite(B),defaultFloorSprite:"floors_1",visible:!0},I=[];E.forEach((e,t)=>{var r;let{sprite:i,tileWidth:o,tileHeight:a}=((e,t)=>{if(0===t)return{sprite:"invisible",tileWidth:32,tileHeight:32};let r=0;do{let i=e[r],o=e[r+1];if(!o||t>=i.firstgid&&t<o.firstgid)return{sprite:i.name+"_"+(t-i.firstgid),tileWidth:i.tilewidth,tileHeight:i.tileheight};r++}while(r<e.length);throw Error("Could not determine sprite from gid:"+t)})(g.tilesets,e),n=i.indexOf("wall")>-1,s=i.indexOf("props")>-1,d={sprite:i,tileWidth:o,tileHeight:a,isWall:n||s,isProp:s&&!u(i),id:e-1,x:t%m,y:Math.floor(t/m),highlighted:!1};S.tiles.push(d);let h=c.createTileRenderObject(d);if(h.isFloor)S.renderObjects.push(h);else{if(d.isWall&&!d.isProp){let e=Object.assign(Object.assign({},d),{tileWidth:32,tileHeight:32,sprite:S.defaultFloorSprite,id:1}),t=c.createTileRenderObject(e);S.renderObjects.push(t)}else{h.sortY+=8;let e=Object.assign(Object.assign({},d),{tileWidth:32,tileHeight:32,sprite:S.defaultFloorSprite,id:1,x:d.x,y:d.y}),t=c.createTileRenderObject(e);S.renderObjects.push(t)}S.renderObjects.push(h)}d.ro=h;let p=A.getReplacementTemplate(d.sprite);p&&(d.ro.sprite=p.baseSprite,d.isWall=null!==(r=p.isWall)&&void 0!==r?r:d.isWall,(null==p?void 0:p.animName)&&(d.animName=p.animName,d.ro.anim=l.createAnimation(p.animName),d.ro.anim.start()))});let T=t=>{let o=t.x,a=t.y,n=t.gid,s=n-C;if(n>=C&&n<C+(null==h?void 0:h.length)&&h){let A=h[s];if(!A)throw Error(`Could not load prop in room definition '${e}', the propIndex '${s}' has no associated tilesetTile. (gid=${n} startingGid=${C})`);I.push(new Promise(async e=>{await r.loadImageAsSprite(A,i.removeFileExtension(A));let n={x:o,y:a,sprite:A,isDynamic:!0,isFront:"front"===t.type};S.props.push(n),S.renderObjects.push(c.createPropRenderObject(n)),e()}))}};f&&f.forEach(T),w&&w.forEach(r=>{let n=r.name.toLowerCase().indexOf("marker")>-1,A=0===r.name.toLowerCase().indexOf("#");n?(t=>{let r=t.x,o=t.y,[a,n]=i.isoToPixelCoords(r,o),[s,A]=i.pixelToIsoCoords(a,n-16);if(S.markers[t.name])throw Error(`Could not load marker '${t.name}' in room definition '${e}', a marker with that name already exists.)`);let l={name:t.name,x:s,y:A};S.markers[t.name]=l,S.renderObjects.push(c.createMarkerRenderObject(l))})(r):A?(t=>{let r=t.x,o=t.y,a=t.width,n=t.height,A=t.name.slice(1);if(void 0===t.gid){let e=8,t=24,i={polygon:[[t+r,e+o],[t+r+a,e+o],[t+r+a,e+o+n],[t+r,e+o+n]],name:A,x:r,y:o,width:a,height:n,isTrigger:!0};S.triggerActivators.push(i),S.renderObjects.push(c.createTriggerActivatorRenderObject(i))}else{let[a,n]=i.isoToPixelCoords(r,o),[l,d]=i.pixelToIsoCoords(a,n-16);if(!s.getTrigger(A))throw Error(`Could not load trigger '${t.name}' in room definition '${e}', a trigger with that name does not exist.)`);let u={name:A,x:l,y:d,width:16,height:16,isTrigger:!0};S.triggerActivators.push(u),S.renderObjects.push(c.createTriggerActivatorRenderObject(u))}})(r):r.name?(r=>{let n=r.x,s=r.y,[A,l]=i.isoToPixelCoords(n,s),[c,d]=i.pixelToIsoCoords(A,l-16),u=a.get(r.name);if(!u)throw Error(`Could not load character '${r.name}' in room definition '${e}', no entry in the db.`);let h=o.characterCreateFromTemplate(u);o.characterSetPos(h,[c,d,0]),t.roomAddCharacter(S,h)})(r):T(r)}),S.floorTileObjects=S.floorTileObjects.sort((e,t)=>e.sortY<t.sortY?-1:1);for(let e=0;e<S.floorTileObjects.length;e++){let{sprite:t,px:r,py:i}=S.floorTileObjects[e];t&&n.drawSprite(t,r+S.widthPx/2,i,1,b)}return await Promise.all(I),S},t.roomGetTileAt=(e,t,r)=>t<0||t>=e.width||r<0||r>=e.height?null:e.tiles[r*e.width+t],t.roomAddParticle=(e,t)=>{e.particles.push(t)},t.roomGetTileBelow=(e,r)=>{let[i,o]=r;return t.roomGetTileAt(e,Math.floor((i+t.TILE_WIDTH_WORLD-3)/t.TILE_WIDTH*2),Math.floor((o+t.TILE_HEIGHT_WORLD-3)/t.TILE_HEIGHT*2))},t.roomGetCharacterByName=(e,t)=>{for(let r=0;r<e.characters.length;r++){let i=e.characters[r];if(i.name===t)return i}return null},t.roomAddCharacter=(e,t)=>{e.characters.push(t),t.ro&&e.renderObjects.push(t.ro)},t.roomRemoveCharacter=(e,t)=>{let r=e.characters.indexOf(t);if(r>-1&&e.characters.splice(r,1),t.ro){let r=e.renderObjects.indexOf(t.ro);r>-1&&e.renderObjects.splice(r,1)}},t.roomShow=e=>{e.visible=!0},t.roomHide=e=>{e.visible=!1}})),define("model/generics",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRenderBackgroundColor=t.getRenderBackgroundColor=t.hideMarkers=t.showMarkers=t.getMarkersVisible=t.hideTriggers=t.showTriggers=t.getTriggersVisible=t.disableKeyUpdate=t.enableKeyUpdate=t.getKeyUpdateEnabled=t.getRenderables=t.removeRenderable=t.addRenderable=t.setIsPaused=t.getIsPaused=t.isKeyDown=t.setKeyUp=t.setKeyDown=t.setMousePos=t.getMousePos=t.setFrameMultiplier=t.getFrameMultiplier=t.setDeltaT=t.getDeltaT=t.setNow=t.getNow=t.setCurrentPlayer=t.getCurrentPlayer=t.setCurrentScene=t.getCurrentScene=t.setCurrentOverworld=t.getCurrentOverworld=t.setCurrentBattle=t.getCurrentBattle=t.setCurrentRoom=t.getCurrentRoom=void 0;let r=window.room=null;t.getCurrentRoom=()=>r,t.setCurrentRoom=e=>{r=window.room=e};let i=window.battle=null;t.getCurrentBattle=()=>i,t.setCurrentBattle=e=>{i=window.battle=e};let o=window.overworld=null;t.getCurrentOverworld=()=>o,t.setCurrentOverworld=e=>{o=window.overworld=e};let a=window.scene=null;t.getCurrentScene=()=>a,t.setCurrentScene=e=>{a=window.scene=e};let n=window.player=null;t.getCurrentPlayer=()=>n,t.setCurrentPlayer=e=>{n=window.player=e};let s=0;t.getNow=()=>s,t.setNow=e=>{s=e};let A=0;t.getDeltaT=()=>A,t.setDeltaT=e=>{A=e};let l=0;t.getFrameMultiplier=()=>l,t.setFrameMultiplier=e=>{l=e};let c=[0,0];t.getMousePos=()=>c,t.setMousePos=(e,t)=>{c=[e,t]};let d={};t.setKeyDown=e=>{d[e]=!0},t.setKeyUp=e=>{d[e]=!1},t.isKeyDown=e=>{var t;return null!==(t=d[e])&&void 0!==t&&t};let u=!1;t.getIsPaused=()=>u,t.setIsPaused=e=>{u=e};let h={};t.addRenderable=(e,t)=>{h[e]=t},t.removeRenderable=e=>{delete h[e]},t.getRenderables=()=>h;let g=!0;t.getKeyUpdateEnabled=()=>g,t.enableKeyUpdate=()=>{g=!0},t.disableKeyUpdate=()=>{g=!1};let m=!0;t.getTriggersVisible=()=>m,t.showTriggers=()=>m=!0,t.hideTriggers=()=>m=!1;let p=!0;t.getMarkersVisible=()=>p,t.showMarkers=()=>p=!0,t.hideMarkers=()=>p=!1;let E="black";t.getRenderBackgroundColor=()=>E,t.setRenderBackgroundColor=e=>E=e})),define("model/animation",["require","exports","model/generics","model/sprite"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnimation=t.hasAnimation=t.createAnimationBuilder=t.Animation=void 0,t.Animation=class{constructor(e){this.loop=e||!1,this.sprites=[],this.done=!1,this.totalDurationMs=0,this.currentSpriteIndex=0,this.timestampStart=0,this.name="",this.awaits=[]}reset(){this.done=!1,this.currentSpriteIndex=0}start(){this.timestampStart=r.getNow()}getDurationMs(){return this.totalDurationMs}addSprite({name:e,duration:t,offsetX:r,offsetY:i,opacity:o}){this.sprites.push({name:e,timestampBegin:this.totalDurationMs,timestampEnd:this.totalDurationMs+t,duration:t,offsetX:r||0,offsetY:i||0,opacity:o}),this.totalDurationMs+=t}getAnimIndex(e){let t=0,r=this.currentSpriteIndex,i=this.sprites.length-1;for(;r<=i;){let o=r+Math.floor((i-r)/2);t=o;let{timestampEnd:a,timestampBegin:n}=this.sprites[o],s=(n||0)+this.timestampStart,A=(a||0)+this.timestampStart;if(e<A&&e>s)return o;e>=A?r=o+1:i=o-1}return t}update(){let e=r.getNow();if(this.currentSpriteIndex===this.sprites.length-1&&this.loop&&e-this.timestampStart>this.totalDurationMs){let t=this.timestampStart+this.totalDurationMs;this.reset(),this.start(),e-t<this.totalDurationMs&&(this.timestampStart=t)}this.currentSpriteIndex=this.getAnimIndex(e),this.loop||e-this.timestampStart>=this.totalDurationMs&&(this.done=!0,this.awaits.forEach(e=>e()),this.awaits=[])}onCompletion(){return new Promise(e=>{this.isDone()||this.loop||this.awaits.push(e)})}getSprite(){var e;return null===(e=this.sprites[this.currentSpriteIndex])||void 0===e?void 0:e.name}getSpriteSize(e){let t=r.getNow();e=null!=e?e:this.getAnimIndex(t);let{name:o}=this.sprites[e],[,,,a,n]=i.getSprite(o);return[a,n]}isDone(){return this.done}};let o=window.animations={};t.createAnimationBuilder=(e,t)=>{o[e]=t},t.hasAnimation=e=>!!o[e],t.createAnimation=e=>{let t=o[e];if(t){let r=t();return r.name=e,r}throw Error(`No animation exists which is named '${e}'`)}})),define("view/draw",["require","exports","model/sprite","model/canvas","utils","model/character","model/particle","view/style","model/generics"],(function(e,t,r,i,o,a,n,s,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRoom=t.drawParticle=t.drawCharacter=t.drawPolygon=t.drawAnimationNF=t.drawAnimation=t.drawSprite=t.drawText=t.measureText=t.drawRect=t.clearScreen=void 0;let l={font:"monospace",color:"#fff",size:14,align:"left",strokeColor:""};t.clearScreen=e=>{(e=e||i.getCtx()).clearRect(0,0,i.getScreenSize(),i.getScreenSize())},t.drawRect=(e,t,r,o,a,n,s)=>{(s=s||i.getCtx()).lineWidth=1,s[n?"strokeStyle":"fillStyle"]=a,s[n?"strokeRect":"fillRect"](Math.floor(e),Math.floor(t),r,o)},t.measureText=(e,t,r)=>{r=r||i.getCtx();let{font:o,size:a}=Object.assign(Object.assign({},l),t||{});return r.textAlign="left",r.textBaseline="top",r.font=a+"px "+o,[r.measureText(e).width,a]},t.drawText=(e,t,r,o,a)=>{let{font:n,size:s,color:A,align:c,strokeColor:d}=Object.assign(Object.assign({},l),o||{});(a=a||i.getCtx()).font=`${s}px ${n}`,a.fillStyle=A,a.textAlign=c,a.textBaseline="middle",a.fillText(e,t,r),d&&(a.strokeStyle=d,a.lineWidth=.5,a.strokeText(e,Math.floor(t),Math.floor(r)))},t.drawSprite=(e,t,o,a,n)=>{if(a=a||1,n=n||i.getCtx(),"invisible"!==e)try{n.fillStyle="black",n.strokeStyle="black";let[i,s,A,l,c]="string"==typeof e?r.getSprite(e):e;n.drawImage(i,s,A,l,c,Math.floor(t),Math.floor(o),l*a,c*a)}catch(t){throw console.error(e),Error("Could not draw sprite: "+t)}},t.drawAnimation=(e,t,o,a,n)=>{a=a||1,n=n||i.getCtx(),e.update();let s=e.getSprite();if(!s)throw console.error(e),Error("Cannot draw animation that did not provide a sprite.");try{n.fillStyle="black",n.strokeStyle="black";let[e,i,A,l,c]="string"==typeof s?r.getSprite(s):s;n.drawImage(e,i,A,l,c,Math.floor(t),Math.floor(o),l*a,c*a)}catch(e){throw Error(`Error attempting to draw animation sprite: "${s}"`)}},t.drawAnimationNF=(e,t,o,a,n)=>{a=a||1,n=n||i.getCtx(),e.update();let s=e.getSprite();if(!s)throw console.error(e),Error("Cannot draw animation that did not provide a sprite.");try{n.fillStyle="black",n.strokeStyle="black";let[e,i,A,l,c]="string"==typeof s?r.getSprite(s):s;n.drawImage(e,i,A,l,c,t,o,l*a,c*a)}catch(e){throw Error(`Error attempting to draw animation sprite: "${s}"`)}},t.drawPolygon=(e,t,r,a)=>{r=r||1,(a=a||i.getCtx()).fillStyle=t,a.beginPath();let n=e[0],[s,A]=n,[l,c]=o.isoToPixelCoords(s,A,0);a.moveTo(l,c);for(let t=1;t<e.length;t++){let r=e[t],[i,n]=r,[s,A]=o.isoToPixelCoords(i,n,0);a.lineTo(s,A)}a.closePath(),a.lineWidth=2,a.stroke()},t.drawCharacter=(e,r,n)=>{let[s,A,l]=a.characterGetPos(e),c=a.characterGetAnimation(e),[d,u]=o.isoToPixelCoords(s,A,l);n=n||i.getCtx(),t.drawAnimation(c,d,u,r,n)},t.drawParticle=(e,r,i)=>{let[o,a]=n.particleGetPos(e),{anim:s,text:A,textParams:l}=e;s&&t.drawAnimation(s,o,a,r,i),A&&l&&t.drawText(A,o,a,l)},t.drawRoom=(e,r,a)=>{let{particles:n}=e,[l,c]=r;(a=a||i.getCtx()).save(),a.translate(Math.floor(l),Math.floor(c)),e.renderObjects=e.renderObjects.sort((e,t)=>e.sortY<t.sortY?-1:1);for(let r=0;r<e.renderObjects.length;r++){let{name:i,sprite:a,anim:n,character:l,px:c,py:d,origPy:u,highlighted:h,visible:g,isMarker:m,isTrigger:p,polygon:E}=e.renderObjects[r];if(g)if(m)A.getMarkersVisible()&&(t.drawText(i||"",c+16,d,{align:"center",color:s.colors.WHITE,size:12}),t.drawSprite(a,c,d));else if(p){if(A.getTriggersVisible())if(E){let e=E[0],[r,a]=e,[n,A]=o.isoToPixelCoords(r,a,0);t.drawPolygon(E,"rgba(0, 0, 0, 0.5)"),t.drawText(i||"",n,A,{align:"center",color:s.colors.PINK,size:12})}else t.drawSprite(a,c,d),t.drawText(i||"",c+16,d,{align:"center",color:s.colors.PINK,size:12})}else n?t.drawAnimation(n,c,d):a?(t.drawSprite(a,c,d),h&&t.drawSprite("indicator",c,u-3)):l&&t.drawCharacter(l)}let d=A.getCurrentPlayer().leader;a.globalAlpha=.25,a.globalCompositeOperation="luminosity",t.drawCharacter(d),a.globalAlpha=1,a.globalCompositeOperation="source-over";for(let e=0;e<n.length;e++)t.drawParticle(n[e]);a.restore()}})),define("model/sprite",["require","exports","view/draw","model/canvas","model/room"],(function(e,t,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSprite=t.loadImageAsSpritesheet=t.loadImageAsSprite=t.loadTiles=t.SpriteModification=t.loadImage=t.createSprite=void 0;let a={};var n;window.sprites=a,t.createSprite=(e,t,r,i,o)=>[e,null!=t?t:0,null!=r?r:0,null!=i?i:e.width,null!=o?o:e.height],t.loadImage=async e=>new Promise((t,r)=>{let i=new Image;i.onload=()=>{t(i)},i.onerror=()=>{r("Failed to load image: "+e)},i.src="res/"+e}),function(e){e.NORMAL="",e.FLIPPED="_f",e.ROT90="_r1",e.ROT180="_r2",e.ROT270="_r3"}(n=t.SpriteModification||(t.SpriteModification={}));let s=(e,o,a,s,A)=>{let l=(r,i,o,a,n,s)=>e[r]=t.createSprite(i,o,a,n,s),c=(e,t,a)=>{let c=l(e,o,a*s,t*A,s,A);l(`${e}${n.FLIPPED}`,(e=>{let[t,r,o]=i.createCanvas(e.width,e.height);return r.translate(o,0),r.scale(-1,1),r.drawImage(e,0,0),t})((e=>{let[,,,t,o]=e,[a,n]=i.createCanvas(t,o);return r.drawSprite(e,0,0,1,n),a})(c)),0,0,s,A)},d=o.width/s,u=o.height/A;for(let e=0;e<u;e++)for(let t=0;t<d;t++){let r=`${a}_${e*d+t}`;1!==d||1!==u||r.includes("512")||(r=a),c(r,e,t)}};t.loadTiles=async()=>{let e=await t.loadImage("battle-terrain1.png");s(a,e,"terrain",o.TILE_WIDTH,o.TILE_HEIGHT)},t.loadImageAsSprite=async(e,r)=>{let i=t.getSprite(r);if(i)return i[0];{a[r]=[new Image,0,0,0,0];let i=await t.loadImage(e);return s(a,i,r,i.width,i.height),i}},t.loadImageAsSpritesheet=async(e,r,i,o)=>{let n=t.getSprite(r);if(n)return n[0];{a[r]=[new Image,0,0,0,0];let n=await t.loadImage(e);return s(a,n,r,i,o),s(a,n,r,n.width,n.height),n}};let A=t.createSprite(document.createElement("canvas"),0,0,1,1);t.getSprite=e=>0===e.indexOf("invisible")?A:a[e]})),define("controller/res-loader",["require","exports","model/animation","model/sprite"],(function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadRes=void 0;class o{async processAssetFile(e){let t=[],o=async function(e){throw Error("cannot load sounds yet: "+e)},a=async function(e){let[,t,r,o,a]=e;if("invisible"!==t)return await i.loadImageAsSpritesheet(r,t,+o,+a)},n=function(e,t){let r=e[1],i=e[2].trim();t.name=r,t.loop=i.indexOf("true")>=0},s=function(e,t){t.sprites.push({name:e[1],duration:parseFloat(e[2])})},A=e.split("\n"),l=new r.Animation(!1),c=function(){r.createAnimationBuilder(l.name,function(e){let t=new r.Animation(e.loop);return e.sprites.forEach(e=>{t.addSprite({name:e.name,duration:e.duration,opacity:e.opacity,offsetX:e.offsetX,offsetY:e.offsetY})}),t}.bind(this,l)),r.createAnimationBuilder(l.name+i.SpriteModification.FLIPPED,function(e){let t=new r.Animation(e.loop);return e.sprites.forEach(e=>{t.addSprite({name:e.name+i.SpriteModification.FLIPPED,duration:e.duration,opacity:e.opacity,offsetX:e.offsetX,offsetY:e.offsetY})}),t}.bind(this,l))};for(let e of A){let i=e.split(","),[A]=i;if("AnimSprite"!==A)switch(l&&c(),A){case"Picture":t.push(()=>a(i));break;case"Animation":l=new r.Animation(!1),n(i,l);continue;case"Sound":t.push(()=>o(i))}else{if(!l)throw console.error("Error reading res.txt, AnimSprite without Anim",i),Error("display loading error");s(i,l)}}l&&c();for(let e=0;e<t.length;e++)await t[e]()}async loadAssets(e){await this.processAssetFile(e)}}t.loadRes=async()=>{let e=await(await fetch("res/res.txt")).text();return(new o).loadAssets(e)}})),define("db/index",["require","exports","db/enemies","db/encounters","db/characters","db/overworlds","db/tiles","db/overworld-ai"],(function(e,t,r,i,o,a,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=async()=>{r.init(),i.init(),o.init(),n.init(),s.init(),await a.init()}})),define("main",["require","exports","model/sprite","controller/loop","controller/res-loader","model/canvas","controller/events","view/ui","view/hooks","model/scene","db/index","lib/rpgscript","model/generics","db/overworlds","controller/overworld-management","model/player","model/character"],(function(e,t,r,i,o,a,n,s,A,l,c,d,u,h,g,m,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.main=void 0,c=__importDefault(c),t.main=async()=>{s.mountUi(),l.initScene();let e=u.getCurrentScene();await d.loadRPGScript("floor1",e),await d.loadRPGScript("test",e),await d.loadRPGScript("example",e),await d.loadRPGScript("utils",e),await d.loadRPGScript("floor1-atrium",e),await o.loadRes(),await c.default(),await r.loadTiles(),a.getCanvas(),a.setDrawScale(4),n.initEvents(),A.initHooks(),i.runMainLoop();let t=m.playerCreate({name:"Ada",spriteBase:"ada",facing:p.Facing.LEFT_DOWN,animationState:p.AnimationState.IDLE,skills:[]});t.leader.speed=1;let E=function(e){let t={},r=("?"===e[0]?e.substr(1):e).split("&");for(let e=0;e<r.length;e++){let i=r[e].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]||"")}return t}(window.location.search);if(E.room){let e=h.get(E.room);g.initiateOverworld(t,e)}else g.initiateOverworld(t,h.get("TEST2"));document.getElementById("controls").style.display="none"}})),define("lib/picostyle",["require","exports"],(function(e,t){"use strict";function r(e,t){var r="p"+a++,i=t+r;return e.forEach((function(e){if(/^@/.test(e)){var t=e.indexOf("{")+1;e=e.slice(0,t)+i+e.slice(t)}else e=i+e;n.insertRule(e,n.cssRules.length)})),r}function i(e,t){return t+"{"+e+"}"}function o(e,t){var r=[""];for(var a in t=t||0,e){var n=e[a];a=a.replace(/[A-Z]/g,"-$&").toLowerCase(),n.sub||Array.isArray(n)?(n=Array.isArray(n)?n:[n]).forEach((function(e){return r[0]+=a+":"+e+";"})):(a=a.replace(/&/g,""),r.push(i(o(n,!/^@/.test(a)).join(""),a)))}return t||(r[0]=i(r[0],"")),r}Object.defineProperty(t,"__esModule",{value:!0}),t.keyframes=void 0;var a=0,n=document.head.appendChild(document.createElement("style")).sheet;t.default=function(e,t){function i(t){return function(r){return function(i,o){o=(i=i||{}).children||o;var n="function"==typeof r?r(i):r;return i.class=[a(n),i.class].filter(Boolean).join(" "),e(t,i,o)}}}function a(e){var t=o(e),i=t.join("");return n[i]||(n[i]=r(t,"."))}var n={};return(t=t||{}).returnObject?{style:i,css:a}:i},t.keyframes=function(e){return r([i(o(e,1).join(""),"")],"@keyframes ")}})),define("lib/preact-hooks",["require","exports","preact"],(function(e,t,r){"use strict";function i(e,t){r.options.__h&&r.options.__h(g,e,p||t),p=0;var i=g.__H||(g.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function o(e){return p=1,a(u,e)}function a(e,t,r){var o=i(h++,2);return o.t=e,o.__c||(o.__=[r?r(t):u(void 0,t),function(e){var t=o.t(o.__[0],e);o.__[0]!==t&&(o.__=[t,o.__[1]],o.__c.setState({}))}],o.__c=g),o.__}function n(e,t){var o=i(h++,4);!r.options.__s&&d(o.__H,t)&&(o.__=e,o.__H=t,g.__h.push(o))}function s(e,t){var r=i(h++,7);return d(r.__H,t)&&(r.__=e(),r.__H=t,r.__h=e),r.__}function A(){E.forEach((function(e){if(e.__P)try{e.__H.__h.forEach(l),e.__H.__h.forEach(c),e.__H.__h=[]}catch(t){e.__H.__h=[],r.options.__e(t,e.__v)}})),E=[]}function l(e){var t=g;"function"==typeof e.__c&&e.__c(),g=t}function c(e){var t=g;e.__c=e.__(),g=t}function d(e,t){return!e||e.length!==t.length||t.some((function(t,r){return t!==e[r]}))}function u(e,t){return"function"==typeof t?t(e):t}Object.defineProperty(t,"__esModule",{value:!0}),t.useErrorBoundary=t.useDebugValue=t.useContext=t.useCallback=t.useMemo=t.useImperativeHandle=t.useRef=t.useLayoutEffect=t.useEffect=t.useReducer=t.useState=void 0;var h,g,m,p=0,E=[],f=r.options.__b,w=r.options.__r,C=r.options.diffed,y=r.options.__c,x=r.options.unmount;t.useState=o,t.useReducer=a,t.useEffect=function(e,t){var o=i(h++,3);!r.options.__s&&d(o.__H,t)&&(o.__=e,o.__H=t,g.__H.__h.push(o))},t.useLayoutEffect=n,t.useRef=function(e){return p=5,s((function(){return{current:e}}),[])},t.useImperativeHandle=function(e,t,r){p=6,n((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==r?r:r.concat(e))},t.useMemo=s,t.useCallback=function(e,t){return p=8,s((function(){return e}),t)},t.useContext=function(e){var t=g.context[e.__c],r=i(h++,9);return r.__c=e,t?(null==r.__&&(r.__=!0,t.sub(g)),t.props.value):e.__},t.useDebugValue=function(e,t){r.options.useDebugValue&&r.options.useDebugValue(t?t(e):e)},t.useErrorBoundary=function(e){var t=i(h++,10),r=o();return t.__=e,g.componentDidCatch||(g.componentDidCatch=function(e){t.__&&t.__(e),r[1](e)}),[r[0],function(){r[1](void 0)}]},r.options.__b=function(e){g=null,f&&f(e)},r.options.__r=function(e){w&&w(e),h=0;var t=(g=e.__c).__H;t&&(t.__h.forEach(l),t.__h.forEach(c),t.__h=[])},r.options.diffed=function(e){C&&C(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==E.push(t)&&m===r.options.requestAnimationFrame||((m=r.options.requestAnimationFrame)||function(e){var t,r=function(){clearTimeout(i),B&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(r,100);B&&(t=requestAnimationFrame(r))})(A)),g=void 0},r.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(l),e.__h=e.__h.filter((function(e){return!e.__||c(e)}))}catch(i){t.some((function(e){e.__h&&(e.__h=[])})),t=[],r.options.__e(i,e.__v)}})),y&&y(e,t)},r.options.unmount=function(e){x&&x(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(l)}catch(e){r.options.__e(e,t.__v)}};var B="function"==typeof requestAnimationFrame})),define("lib/preact",["require","exports"],(function(e,t){"use strict";function r(e,t){for(var r in t)e[r]=t[r];return e}function i(e){var t=e.parentNode;t&&t.removeChild(e)}function o(e,t,r){var i,o,n,s=arguments,A={};for(n in t)"key"==n?i=t[n]:"ref"==n?o=t[n]:A[n]=t[n];if(arguments.length>3)for(r=[r],n=3;n<arguments.length;n++)r.push(s[n]);if(null!=r&&(A.children=r),"function"==typeof e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===A[n]&&(A[n]=e.defaultProps[n]);return a(e,A,i,o,null)}function a(e,t,r,i,o){var a={type:e,props:t,key:r,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++I.__v:o};return null!=I.vnode&&I.vnode(a),a}function n(e){return e.children}function s(e,t){this.props=e,this.context=t}function A(e,t){if(null==t)return e.__?A(e.__,e.__.__k.indexOf(e)+1):null;for(var r;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e)return r.__e;return"function"==typeof e.type?A(e):null}function l(e){var t,r;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(r=e.__k[t])&&null!=r.__e){e.__e=e.__c.base=r.__e;break}return l(e)}}function c(e){(!e.__d&&(e.__d=!0)&&v.push(e)&&!d.__r++||R!==I.debounceRendering)&&((R=I.debounceRendering)||M)(d)}function d(){for(var e;d.__r=v.length;)e=v.sort((function(e,t){return e.__v.__b-t.__v.__b})),v=[],e.some((function(e){var t,i,o,a,n,s,c;e.__d&&(s=(n=(t=e).__v).__e,(c=t.__P)&&(i=[],(o=r({},n)).__v=n.__v+1,a=w(c,n,o,t.__n,void 0!==c.ownerSVGElement,null!=n.__h?[s]:null,i,null==s?A(n):s,n.__h),C(i,n),a!=s&&l(n)))}))}function u(e,t,r,o,s,l,c,d,u,g){var m,p,E,f,C,y,b,S=o&&o.__k||D,I=S.length;for(u==Q&&(u=null!=c?c[0]:I?A(o,0):null),r.__k=[],m=0;m<t.length;m++)if(null!=(f=r.__k[m]=null==(f=t[m])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f?a(null,f,null,null,f):Array.isArray(f)?a(n,{children:f},null,null,null):null!=f.__e||null!=f.__c?a(f.type,f.props,f.key,null,f.__v):f)){if(f.__=r,f.__b=r.__b+1,null===(E=S[m])||E&&f.key==E.key&&f.type===E.type)S[m]=void 0;else for(p=0;p<I;p++){if((E=S[p])&&f.key==E.key&&f.type===E.type){S[p]=void 0;break}E=null}C=w(e,f,E=E||Q,s,l,c,d,u,g),(p=f.ref)&&E.ref!=p&&(b||(b=[]),E.ref&&b.push(E.ref,null,f),b.push(p,f.__c||C,f)),null!=C?(null==y&&(y=C),u=h(e,f,E,S,c,C,u),g||"option"!=r.type?"function"==typeof r.type&&(r.__d=u):e.value=""):u&&E.__e==u&&u.parentNode!=e&&(u=A(E))}if(r.__e=y,null!=c&&"function"!=typeof r.type)for(m=c.length;m--;)null!=c[m]&&i(c[m]);for(m=I;m--;)null!=S[m]&&B(S[m],S[m]);if(b)for(m=0;m<b.length;m++)x(b[m],b[++m],b[++m])}function h(e,t,r,i,o,a,n){var s,A,l;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(o==r||a!=n||null==a.parentNode)e:if(null==n||n.parentNode!==e)e.appendChild(a),s=null;else{for(A=n,l=0;(A=A.nextSibling)&&l<i.length;l+=2)if(A==a)break e;e.insertBefore(a,n),s=n}return void 0!==s?s:a.nextSibling}function g(e,t,r){"-"===t[0]?e.setProperty(t,r):e[t]=null==r?"":"number"!=typeof r||O.test(t)?r:r+"px"}function m(e,t,r,i,o){var a,n,s;if(o&&"className"==t&&(t="class"),"style"===t)if("string"==typeof r)e.style.cssText=r;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)r&&t in r||g(e.style,t,"");if(r)for(t in r)i&&r[t]===i[t]||g(e.style,t,r[t])}else"o"===t[0]&&"n"===t[1]?(a=t!==(t=t.replace(/Capture$/,"")),(n=t.toLowerCase())in e&&(t=n),t=t.slice(2),e.l||(e.l={}),e.l[t+a]=r,s=a?E:p,r?i||e.addEventListener(t,s,a):e.removeEventListener(t,s,a)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&"download"!==t&&"href"!==t&&!o&&t in e?e[t]=null==r?"":r:"function"!=typeof r&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/xlink:?/,""))?null==r||!1===r?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):null==r||!1===r&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,r))}function p(e){this.l[e.type+!1](I.event?I.event(e):e)}function E(e){this.l[e.type+!0](I.event?I.event(e):e)}function f(e,t,r){var i,o;for(i=0;i<e.__k.length;i++)(o=e.__k[i])&&(o.__=e,o.__e&&("function"==typeof o.type&&o.__k.length>1&&f(o,t,r),t=h(r,o,o,e.__k,null,o.__e,t),"function"==typeof e.type&&(e.__d=t)))}function w(e,t,i,o,a,A,l,c,d){var h,g,m,p,E,w,C,x,B,S,T,v=t.type;if(void 0!==t.constructor)return null;null!=i.__h&&(d=i.__h,c=t.__e=i.__e,t.__h=null,A=[c]),(h=I.__b)&&h(t);try{e:if("function"==typeof v){if(x=t.props,B=(h=v.contextType)&&o[h.__c],S=h?B?B.props.value:h.__:o,i.__c?C=(g=t.__c=i.__c).__=g.__E:("prototype"in v&&v.prototype.render?t.__c=g=new v(x,S):(t.__c=g=new s(x,S),g.constructor=v,g.render=b),B&&B.sub(g),g.props=x,g.state||(g.state={}),g.context=S,g.__n=o,m=g.__d=!0,g.__h=[]),null==g.__s&&(g.__s=g.state),null!=v.getDerivedStateFromProps&&(g.__s==g.state&&(g.__s=r({},g.__s)),r(g.__s,v.getDerivedStateFromProps(x,g.__s))),p=g.props,E=g.state,m)null==v.getDerivedStateFromProps&&null!=g.componentWillMount&&g.componentWillMount(),null!=g.componentDidMount&&g.__h.push(g.componentDidMount);else{if(null==v.getDerivedStateFromProps&&x!==p&&null!=g.componentWillReceiveProps&&g.componentWillReceiveProps(x,S),!g.__e&&null!=g.shouldComponentUpdate&&!1===g.shouldComponentUpdate(x,g.__s,S)||t.__v===i.__v){g.props=x,g.state=g.__s,t.__v!==i.__v&&(g.__d=!1),g.__v=t,t.__e=i.__e,t.__k=i.__k,g.__h.length&&l.push(g),f(t,c,e);break e}null!=g.componentWillUpdate&&g.componentWillUpdate(x,g.__s,S),null!=g.componentDidUpdate&&g.__h.push((function(){g.componentDidUpdate(p,E,w)}))}g.context=S,g.props=x,g.state=g.__s,(h=I.__r)&&h(t),g.__d=!1,g.__v=t,g.__P=e,h=g.render(g.props,g.state,g.context),g.state=g.__s,null!=g.getChildContext&&(o=r(r({},o),g.getChildContext())),m||null==g.getSnapshotBeforeUpdate||(w=g.getSnapshotBeforeUpdate(p,E)),u(e,Array.isArray(T=null!=h&&h.type==n&&null==h.key?h.props.children:h)?T:[T],t,i,o,a,A,l,c,d),g.base=t.__e,t.__h=null,g.__h.length&&l.push(g),C&&(g.__E=g.__=null),g.__e=!1}else null==A&&t.__v===i.__v?(t.__k=i.__k,t.__e=i.__e):t.__e=y(i.__e,t,i,o,a,A,l,d);(h=I.diffed)&&h(t)}catch(e){t.__v=null,(d||null!=A)&&(t.__e=c,t.__h=!!d,A[A.indexOf(c)]=null),I.__e(e,t,i)}return t.__e}function C(e,t){I.__c&&I.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){I.__e(e,t.__v)}}))}function y(e,t,r,i,o,a,n,s){var A,l,c,d,h,g=r.props,p=t.props;if(o="svg"===t.type||o,null!=a)for(A=0;A<a.length;A++)if(null!=(l=a[A])&&((null===t.type?3===l.nodeType:l.localName===t.type)||e==l)){e=l,a[A]=null;break}if(null==e){if(null===t.type)return document.createTextNode(p);e=o?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,p.is&&{is:p.is}),a=null,s=!1}if(null===t.type)g===p||s&&e.data===p||(e.data=p);else{if(null!=a&&(a=D.slice.call(e.childNodes)),c=(g=r.props||Q).dangerouslySetInnerHTML,d=p.dangerouslySetInnerHTML,!s){if(null!=a)for(g={},h=0;h<e.attributes.length;h++)g[e.attributes[h].name]=e.attributes[h].value;(d||c)&&(d&&(c&&d.__html==c.__html||d.__html===e.innerHTML)||(e.innerHTML=d&&d.__html||""))}(function(e,t,r,i,o){var a;for(a in r)"children"===a||"key"===a||a in t||m(e,a,null,r[a],i);for(a in t)o&&"function"!=typeof t[a]||"children"===a||"key"===a||"value"===a||"checked"===a||r[a]===t[a]||m(e,a,t[a],r[a],i)})(e,p,g,o,s),d?t.__k=[]:u(e,Array.isArray(A=t.props.children)?A:[A],t,r,i,"foreignObject"!==t.type&&o,a,n,Q,s),s||("value"in p&&void 0!==(A=p.value)&&(A!==e.value||"progress"===t.type&&!A)&&m(e,"value",A,g.value,!1),"checked"in p&&void 0!==(A=p.checked)&&A!==e.checked&&m(e,"checked",A,g.checked,!1))}return e}function x(e,t,r){try{"function"==typeof e?e(t):e.current=t}catch(e){I.__e(e,r)}}function B(e,t,r){var o,a,n;if(I.unmount&&I.unmount(e),(o=e.ref)&&(o.current&&o.current!==e.__e||x(o,null,t)),r||"function"==typeof e.type||(r=null!=(a=e.__e)),e.__e=e.__d=void 0,null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){I.__e(e,t)}o.base=o.__P=null}if(o=e.__k)for(n=0;n<o.length;n++)o[n]&&B(o[n],t,r);null!=a&&i(a)}function b(e,t,r){return this.constructor(e,r)}function S(e,t,r){var i,a,s;I.__&&I.__(e,t),a=(i=r===_)?null:r&&r.__k||t.__k,e=o(n,null,[e]),s=[],w(t,(i?t:r||t).__k=e,a||Q,Q,void 0!==t.ownerSVGElement,r&&!i?[r]:a?null:t.childNodes.length?D.slice.call(t.childNodes):null,s,r||Q,i),C(s,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.options=t.__u=t.toChildArray=t.createContext=t.cloneElement=t.Component=t.isValidElement=t.createRef=t.Fragment=t.h=t.createElement=t.hydrate=t.render=void 0;var I,T,v,M,R,_,k,Q={},D=[],O=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;t.options=I,t.isValidElement=T,t.createElement=o,t.h=o,t.createRef=function(){return{current:null}},t.Fragment=n,t.Component=s,t.toChildArray=function e(t,r){return r=r||[],null==t||"boolean"==typeof t||(Array.isArray(t)?t.some((function(t){e(t,r)})):r.push(t)),r},t.__u=B,t.render=S,t.hydrate=function(e,t){S(e,t,_)},t.cloneElement=function(e,t,i){var o,n,s,A=arguments,l=r({},e.props);for(s in t)"key"==s?o=t[s]:"ref"==s?n=t[s]:l[s]=t[s];if(arguments.length>3)for(i=[i],s=3;s<arguments.length;s++)i.push(A[s]);return null!=i&&(l.children=i),a(e.type,l,o||e.key,n||e.ref,null)},t.createContext=function(e,t){var r={__c:t="__cC"+k++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e,r,i){return this.getChildContext||(r=[],(i={})[t]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&r.some(c)},this.sub=function(e){r.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){r.splice(r.indexOf(e),1),t&&t.call(e)}}),e.children}};return r.Provider.__=r.Consumer.contextType=r},t.options=I={__e:function(e,t){for(var r,i,o,a=t.__h;t=t.__;)if((r=t.__c)&&!r.__)try{if((i=r.constructor)&&null!=i.getDerivedStateFromError&&(r.setState(i.getDerivedStateFromError(e)),o=r.__d),null!=r.componentDidCatch&&(r.componentDidCatch(e),o=r.__d),o)return t.__h=a,r.__E=r}catch(t){e=t}throw e},__v:0},t.isValidElement=T=function(e){return null!=e&&void 0===e.constructor},s.prototype.setState=function(e,t){var i;i=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=r({},this.state),"function"==typeof e&&(e=e(r({},i),this.props)),e&&r(i,e),null!=e&&this.__v&&(t&&this.__h.push(t),c(this))},s.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),c(this))},s.prototype.render=n,v=[],M="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,d.__r=0,_=Q,k=0}))})();