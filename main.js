(()=>{var e=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),t=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(i){if(i&&i.__esModule)return i;var r={};if(null!=i)for(var o in i)"default"!==o&&Object.prototype.hasOwnProperty.call(i,o)&&e(r,i,o);return t(r,i),r},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("utils",["require","exports"],(function(e,t){"use strict";function i(e,t,i,r){let o=e/r;return-i*o*(o-2)+t}function r(e,t,i,r,o){return r+(e-t)*(o-r)/(i-t)}function o(e,t,i,o,a){let n=r(e,t,i,o,a);return o<a?n>a?n=a:n<o&&(n=o):n<a?n=a:n>o&&(n=o),n}Object.defineProperty(t,"__esModule",{value:!0}),t.toFixedPrecision=t.createPolygonFromRect=t.getAngleFromVector=t.radiansToDegrees=t.getNormalizedVec=t.getAngleTowards=t.circleRectCollision=t.circleCircleCollision=t.calculateDistance=t.removeIfPresent=t.getRandBetween=t.timeoutPromise=t.normalizeEaseOutClamp=t.normalizeEaseOut=t.normalizeClamp=t.normalize=t.extrapolatePoint=t.truncatePoint3d=t.removeFileExtension=t.pixelToIsoCoords=t.isoToPixelCoords=void 0,t.isoToPixelCoords=(e,t,i)=>[e-t,(e+t)/2-(null!=i?i:0)/2],t.pixelToIsoCoords=(e,t)=>[(2*t+e)/2,(2*t-e)/2],t.removeFileExtension=e=>{let t=e.lastIndexOf(".");return t>-1&&(e=e.slice(0,t)),e},t.truncatePoint3d=e=>[e[0],e[1]],t.extrapolatePoint=e=>[e[0],e[1],0],t.normalize=r,t.normalizeClamp=o,t.normalizeEaseOut=function(e,t,o,a,n){return i(r(e,t,o,0,1),a,n-a,1)},t.normalizeEaseOutClamp=function(e,t,r,a,n){return i(o(e,t,r,0,1),a,n-a,1)},t.timeoutPromise=e=>new Promise(t=>{setTimeout(t,e)}),t.getRandBetween=(e,t)=>Math.floor(Math.random()*(t-e))+e,t.removeIfPresent=(e,t)=>{let i=e.indexOf(t);return i>-1&&(e.splice(i,1),!0)},t.calculateDistance=(e,t)=>{let[i,r,o]=e,[a,n,l]=t;return Math.sqrt(Math.pow(a-i,2)+Math.pow(n-r,2)+Math.pow(l-o,2))},t.circleCircleCollision=(e,i)=>{let[r,o,a]=e,[n,l,s]=i;return t.calculateDistance([r,o,0],[n,l,0])<=a+s},t.circleRectCollision=(e,t)=>{let[i,r,o]=e,a=[i-o,r-o,2*o,2*o],[n,l,s,c]=a,[d,h,u,m]=t,p=n+s/2-(d+u/2),g=l+c/2-(h+m/2),f=(s+u)/2,y=(c+m)/2,w=f*g,_=y*p,v="none";return Math.abs(p)<=f&&Math.abs(g)<=y&&(v=w>_?w>-_?"bottom":"left":w>-_?"right":"top",i<=d&&r<=h?v="top-left":i>=d+u&&r<=h?v="top-right":i<=d&&r>=h+m?v="bottom-left":i>=d+u&&r>=h+m&&(v="bottom-right")),v},t.getAngleTowards=function(e,t){let[i,r]=e,[o,a]=t,n=a-r,l=o-i,s=Math.sqrt(l*l+n*n),c=0;return c=a>=r&&o>=i?180*Math.asin(n/s)/Math.PI+90:a>=r&&o<i?180*Math.asin(n/-s)/Math.PI-90:a<r&&o>i?180*Math.asin(n/s)/Math.PI+90:180*Math.asin(-n/s)/Math.PI-90,c>=360&&(c=360-c),c<0&&(c=360+c),c},t.getNormalizedVec=(e,t)=>{let i=Math.sqrt(e*e+t*t);return[e/i,t/i]},t.radiansToDegrees=e=>e*(180/Math.PI),t.getAngleFromVector=(e,i)=>{if(0==e)return i>0?90:0==i?0:270;if(0==i)return e>=0?0:180;let r=t.radiansToDegrees(Math.atan(i/e));return e<0&&i<0||e<0?r=180+r:i<0&&(r=270+(90+r)),r},t.createPolygonFromRect=e=>{let[t,i,r,o]=e;return[[t,i],[t+r,i],[t+r,i+o],[t,i+o]]},t.toFixedPrecision=(e,t)=>parseFloat(e.toFixed(t))})),define("view/style",["require","exports","preact","picostyle"],(function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyframes=t.style=t.MEDIA_QUERY_PHONE_WIDTH=t.colors=void 0;let a=(o=i(o)).default(r.h);t.colors={BLACK:"#111",WHITE:"#F8F8F8",GREY:"#999",DARKGREY:"#2E3740",RED:"#BE2633",PINK:"#FFAEB6",GREEN:"#44891A",BROWN:"#A46422",ORANGE:"#FAB40B",PURPLE:"#9964F9",BLUE:"#31A2F2",YELLOW:"#F4B41B",DARKBLUE:"#243F72"},t.MEDIA_QUERY_PHONE_WIDTH="@media (max-width: 850px)",t.style=function(e,t){return a(e)(t)},t.keyframes=e=>o.keyframes(e)})),define("model/store",["require","exports"],(function(e,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),t.AppStateInitial=t.CutsceneSpeaker=t.AppSection=void 0,function(e){e.BattleUI="battleMenu",e.BattleVictory="battleVictory",e.BattleDefeated="battleDefeated",e.Cutscene="cutscene",e.Debug="debug"}(i=t.AppSection||(t.AppSection={})),function(e){e.Left="left",e.Left2="left2",e.Right="right",e.Right2="right2",e.Center="center",e.None="none"}(r=t.CutsceneSpeaker||(t.CutsceneSpeaker={})),t.AppStateInitial={sections:[i.Debug],cutscene:{text:"",speaker:r.None,visible:!0,portraitLeft:"",portraitLeftEmotion:"",portraitLeft2:"",portraitLeft2Emotion:"",portraitRight:"",portraitRightEmotion:"",portraitRight2:"",portraitRight2Emotion:"",portraitCenter:"",portraitCenterEmotion:""},battle:{chButtonsEnabled:!0}}})),define("controller/ui-actions",["require","exports","view/ui","model/store"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCutsceneText=t.startConversation2=t.startConversation=t.showConversation=t.hideConversation=t.showSections=t.showSection=t.hideSections=t.battleSetChButtonsStatus=t.appReducer=void 0;let o={battleSetChButtonsStatus:(e,t)=>{e.battle.chButtonsEnabled=t},hideSections:e=>{e.sections=[]},showSection:(e,t)=>{e.sections.includes(t)||e.sections.push(t)},setCutsceneState:(e,t)=>{Object.assign(e.cutscene,t)}};t.appReducer=function(e,t){let i=Object.assign({},e),r=o[t.action];return r?r(i,t.payload,e):console.error(`Action without a reducer mutation: "${t.action}"`,t),i},t.battleSetChButtonsStatus=e=>{i.getUiInterface().dispatch({action:"battleSetChButtonsStatus",payload:e})},t.hideSections=()=>{i.getUiInterface().dispatch({action:"hideSections"})},t.showSection=(e,r)=>{r&&t.hideSections(),i.getUiInterface().dispatch({action:"showSection",payload:e})},t.showSections=(e,r)=>{r&&t.hideSections(),e.forEach(e=>{i.getUiInterface().dispatch({action:"showSection",payload:e})})},t.hideConversation=()=>{i.getUiInterface().dispatch({action:"setCutsceneState",payload:{visible:!1,portraitLeft:"",portraitLeft2:"",portraitRight:"",portraitRight2:"",portraitCenter:"",portraitLeftEmotion:"",portraitLeft2Emotion:"",portraitRightEmotion:"",portraitRight2Emotion:"",portraitCenterEmotion:""}})},t.showConversation=()=>{i.getUiInterface().dispatch({action:"setCutsceneState",payload:{visible:!0}})},t.startConversation=e=>{t.showSection(r.AppSection.Cutscene,!0),i.getUiInterface().dispatch({action:"setCutsceneState",payload:{portraitCenter:e,portraitLeft:"",portraitRight:"",portraitLeft2:"",portraitRight2:"",portraitLeftEmotion:"",portraitLeft2Emotion:"",portraitRightEmotion:"",portraitRight2Emotion:"",portraitCenterEmotion:"",speaker:r.CutsceneSpeaker.None,visible:!0}})},t.startConversation2=(e,o)=>{t.showSection(r.AppSection.Cutscene,!0),i.getUiInterface().dispatch({action:"setCutsceneState",payload:{portraitLeft:e,portraitRight:o,portraitLeft2:"",portraitRight2:"",portraitCenter:"",portraitLeftEmotion:"",portraitLeft2Emotion:"",portraitRightEmotion:"",portraitRight2Emotion:"",portraitCenterEmotion:"",speaker:r.CutsceneSpeaker.None,visible:!0}})},t.setCutsceneText=(e,t)=>{let r={text:e,visible:!0};t&&(r.speaker=t),i.getUiInterface().dispatch({action:"setCutsceneState",payload:r})}})),define("lib/webgl-canvas",["require","exports"],(function(e,t){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){function r(e){return e>0&&0==(e-1&e)}function o(e){return this.clearStack(e)}var a=[1,0,0,0,1,0,0,0,1],n=function(e,t){var i=e[0],r=e[1],o=e[2],a=e[3],n=e[4],l=e[5],s=e[6],c=e[7],d=e[8],h=t[0],u=t[1],m=t[2],p=t[3],g=t[4],f=t[5],y=t[6],w=t[7],_=t[8];t[0]=h*i+p*r+y*o,t[1]=u*i+g*r+w*o,t[2]=m*i+f*r+_*o,t[3]=h*a+p*n+y*l,t[4]=u*a+g*n+w*l,t[5]=m*a+f*n+_*l,t[6]=h*s+p*c+y*d,t[7]=u*s+g*c+w*d,t[8]=m*s+f*c+_*d};o.prototype.clearStack=function(e){this.m_stack=[],this.m_cache=[],this.c_stack=0,this.valid=0,this.result=null;for(var t=0;t<16;t++)this.m_stack[t]=this.getIdentity();void 0!==e?this.m_stack[0]=e:this.setIdentity()},o.prototype.setIdentity=function(){this.m_stack[this.c_stack]=this.getIdentity(),this.valid===this.c_stack&&this.c_stack&&this.valid--},o.prototype.getIdentity=function(){return[1,0,0,0,1,0,0,0,1]},o.prototype.getResult=function(){if(!this.c_stack)return this.m_stack[0];var e=a;this.valid>this.c_stack-1&&(this.valid=this.c_stack-1);for(var t=this.valid;t<this.c_stack+1;t++)e=n(this.m_stack[t],e),this.m_cache[t]=e;return this.valid=this.c_stack-1,this.result=this.m_cache[this.c_stack],this.result},o.prototype.pushMatrix=function(){this.c_stack++,this.m_stack[this.c_stack]=this.getIdentity()},o.prototype.popMatrix=function(){0!==this.c_stack&&this.c_stack--};var l=o.prototype.getIdentity();o.prototype.translate=function(e,t){l[6]=e,l[7]=t,n(l,this.m_stack[this.c_stack])};var s=o.prototype.getIdentity();o.prototype.scale=function(e,t){s[0]=e,s[4]=t,n(s,this.m_stack[this.c_stack])};var c,d,h=o.prototype.getIdentity();o.prototype.rotate=function(t){var i,r;i=e.sin(-t),r=e.cos(-t),h[0]=r,h[3]=i,h[1]=-i,h[4]=r,n(h,this.m_stack[this.c_stack])},(i=function(e,t){var i;this.canvas=e,this.options=t||{},this.gl=void 0,this.fs=void 0,this.vs=void 0,this.shaderProgram=void 0,this.transform=new o,this.shaderPool=[],this.maxTextureSize=void 0,e.gl2d=this,e.$getContext=e.getContext,e.getContext=(i=this,function(t){if(!i.options.force&&"webgl-2d"!==t||0===e.width||0===e.height)return i.canvas.$getContext(t);if(i.gl)return i.gl;var r=i.gl=i.canvas.$getContext("experimental-webgl");return i.initShaders(),i.initBuffers(),i.initCanvas2DAPI(),r.viewport(0,0,i.canvas.width,i.canvas.height),r.clearColor(0,0,0,1),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),i.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),r}),this.postInit()}).enable=function(e,t){return e.gl2d||new i(e,t)},i.prototype.getFragmentShaderSource=function(e){return["#ifdef GL_ES\nprecision highp float;\n#endif","#define hasTexture "+(1&e?"1":"0"),"#define hasCrop "+(2&e?"1":"0"),"varying vec4 vColor;\n#if hasTexture\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n#if hasCrop\nuniform vec4 uCropSource;\n#endif\n#endif\nvoid main(void) {\n#if hasTexture\n#if hasCrop\n//gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x * uCropSource.z, vTextureCoord.y * uCropSource.w) + uCropSource.xy) / vec4(0.9, 0.9, 0.9, 1);\ngl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x * uCropSource.z, vTextureCoord.y * uCropSource.w) + uCropSource.xy);\n#else\ngl_FragColor = texture2D(uSampler, vTextureCoord);\n#endif\n#else\ngl_FragColor = vColor;\n#endif\n}"].join("\n")},i.prototype.getVertexShaderSource=function(e,t){return["#define hasTexture "+(1&t?"1":"0"),"attribute vec4 aVertexPosition;\n#if hasTexture\nvarying vec2 vTextureCoord;\n#endif\nuniform vec4 uColor;","uniform mat3 uTransforms["+(e=e||1)+"];","varying vec4 vColor;","let mat4 pMatrix = mat4("+2/this.canvas.width+",0,0,0, 0,"+-2/this.canvas.height+",0,0, 0,0,1.0,1.0, -1.0,1.0,0,0);","mat3 crunchStack(void) {\nmat3 result = uTransforms[0];","for (int i = 1; i < "+e+"; ++i) {","result = uTransforms[i] * result;\n}\nreturn result;\n}\nvoid main(void) {\nvec3 position = crunchStack() * vec3(aVertexPosition.x, aVertexPosition.y, 1.0);\ngl_Position = pMatrix * vec4(position, 1.0);\nvColor = uColor;\n#if hasTexture\nvTextureCoord = aVertexPosition.zw;\n#endif\n}"].join("\n")},i.prototype.initShaders=function(e,t){var i=this.gl;t=t||0;var r=this.shaderPool[e=e||1];if(r||(r=this.shaderPool[e]=[]),r=r[t])return i.useProgram(r),this.shaderProgram=r,r;var o=this.fs=i.createShader(i.FRAGMENT_SHADER);if(i.shaderSource(this.fs,this.getFragmentShaderSource(t)),i.compileShader(this.fs),!i.getShaderParameter(this.fs,i.COMPILE_STATUS))throw"fragment shader error: "+i.getShaderInfoLog(this.fs);var a=this.vs=i.createShader(i.VERTEX_SHADER);if(i.shaderSource(this.vs,this.getVertexShaderSource(e,t)),i.compileShader(this.vs),!i.getShaderParameter(this.vs,i.COMPILE_STATUS))throw"vertex shader error: "+i.getShaderInfoLog(this.vs);var n=this.shaderProgram=i.createProgram();if(n.stackDepth=e,i.attachShader(n,o),i.attachShader(n,a),i.linkProgram(n),!i.getProgramParameter(n,i.LINK_STATUS))throw"Could not initialise shaders.";i.useProgram(n),n.vertexPositionAttribute=i.getAttribLocation(n,"aVertexPosition"),i.enableVertexAttribArray(n.vertexPositionAttribute),n.uColor=i.getUniformLocation(n,"uColor"),n.uSampler=i.getUniformLocation(n,"uSampler"),n.uCropSource=i.getUniformLocation(n,"uCropSource"),n.uTransforms=[];for(var l=0;l<e;++l)n.uTransforms[l]=i.getUniformLocation(n,"uTransforms["+l+"]");return this.shaderPool[e][t]=n,n};var u=new Float32Array([0,0,0,0,0,1,0,1,1,1,1,1,1,0,1,0]);i.prototype.initBuffers=function(){var e=this.gl;c=e.createBuffer(),e.createBuffer(),d=e.createBuffer(),e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,c),e.bufferData(e.ARRAY_BUFFER,u,e.STATIC_DRAW)},i.instances=[],i.prototype.postInit=function(){i.instances.push(this)},i.prototype.initCanvas2DAPI=function(){function e(t){var i,r,o,a,n,l,s=[];if(i=u.exec(t)){if(a=i[1],n=parseFloat(i[8]),a&&isNaN(n)||!a&&!isNaN(n))return!1;l=i[3];for(var c=2;c<8;c+=2){if(r=i[c],(o=i[c+1])!==l)return!1;r=o?(r=r>100?1:r/100)<0?0:r:(r=r>255?1:r/255)<0?0:r,s.push(r)}s.push(a?n:1)}else if(i=m.exec(t))a=i[1],n=parseFloat(i[5]),s=function(e,t,i,r){function o(e){return 6*e<1?a+(n-a)*e*6:2*e<1?n:3*e<2?a+(n-a)*(2/3-e)*6:a}var a,n;return t=(t=t>100?1:t/100)<0?0:t,a=2*(i=(i=i>100?1:i/100)<0?0:i)-(n=i<=.5?i*(t+1):i+t-i*t),[o((e=(e%360+360)%360/360)+1/3),o(e),o(e-1/3),r]}(i[2],i[3],i[4],parseFloat(a&&n?n:1));else if(i=p.exec(t)){var d=parseInt(i[1],16);s=[((16711680&d)>>16)/255,((65280&d)>>8)/255,(255&d)/255,1]}else if(i=g.exec(t))s=e("#"+i[1]+i[1]+i[2]+i[2]+i[3]+i[3]);else if(t.toLowerCase()in f)s=e(f[t.toLowerCase()]);else{if("transparent"!==t.toLowerCase())return!1;s=[0,0,0,0]}return s}function t(e){return"rgba("+255*e[0]+", "+255*e[1]+", "+255*e[2]+", "+parseFloat(e[3])+")"}function i(e){for(var t=n.transform.m_stack,i=0,r=n.transform.c_stack+1;i<r;++i)l.uniformMatrix3fv(e.uTransforms[i],!1,t[r-1-i])}function o(e,t){this.closed=!1,this.verts=[e,t,0,0]}function a(e){if(this.obj=l.createTexture(),this.index=C.push(this),b.push(e),e.width>n.maxTextureSize||e.height>n.maxTextureSize){var t=document.createElement("canvas");t.width=e.width>n.maxTextureSize?n.maxTextureSize:e.width,t.height=e.height>n.maxTextureSize?n.maxTextureSize:e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),e=t}l.bindTexture(l.TEXTURE_2D,this.obj),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,e),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),r(e.width)&&r(e.height)?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR_MIPMAP_LINEAR),l.generateMipmap(l.TEXTURE_2D)):l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.bindTexture(l.TEXTURE_2D,null)}var n=this,l=this.gl,s=document.createElement("canvas");s.width=n.canvas.width,s.height=n.canvas.height;var h=s.getContext("2d"),u=/^rgb(a)?\(\s*(-?[\d]+)(%)?\s*,\s*(-?[\d]+)(%)?\s*,\s*(-?[\d]+)(%)?\s*,?\s*(-?[\d\.]+)?\s*\)$/,m=/^hsl(a)?\(\s*(-?[\d\.]+)\s*,\s*(-?[\d\.]+)%\s*,\s*(-?[\d\.]+)%\s*,?\s*(-?[\d\.]+)?\s*\)$/,p=/^#([0-9A-Fa-f]{6})$/,g=/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/,f={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},y={},w=[];y.fillStyle=[0,0,0,1],Object.defineProperty(l,"fillStyle",{get:function(){return t(y.fillStyle)},set:function(t){y.fillStyle=e(t)||y.fillStyle}}),y.strokeStyle=[0,0,0,1],Object.defineProperty(l,"strokeStyle",{get:function(){return t(y.strokeStyle)},set:function(t){y.strokeStyle=e(t)||drawStyle.strokeStyle}}),l.$lineWidth=l.lineWidth,y.lineWidth=1,Object.defineProperty(l,"lineWidth",{get:function(){return y.lineWidth},set:function(e){l.$lineWidth(e),y.lineWidth=e}}),y.lineCap="butt",Object.defineProperty(l,"lineCap",{get:function(){return y.lineCap},set:function(e){y.lineCap=e}}),y.lineJoin="miter",Object.defineProperty(l,"lineJoin",{get:function(){return y.lineJoin},set:function(e){y.lineJoin=e}}),y.miterLimit=10,Object.defineProperty(l,"miterLimit",{get:function(){return y.miterLimit},set:function(e){y.miterLimit=e}}),y.shadowOffsetX=0,Object.defineProperty(l,"shadowOffsetX",{get:function(){return y.shadowOffsetX},set:function(e){y.shadowOffsetX=e}}),y.shadowOffsetY=0,Object.defineProperty(l,"shadowOffsetY",{get:function(){return y.shadowOffsetY},set:function(e){y.shadowOffsetY=e}}),y.shadowBlur=0,Object.defineProperty(l,"shadowBlur",{get:function(){return y.shadowBlur},set:function(e){y.shadowBlur=e}}),y.shadowColor="rgba(0, 0, 0, 0.0)",Object.defineProperty(l,"shadowColor",{get:function(){return y.shadowColor},set:function(e){y.shadowColor=e}}),y.font="10px sans-serif",Object.defineProperty(l,"font",{get:function(){return y.font},set:function(e){h.font=e,y.font=e}}),y.textAlign="start",Object.defineProperty(l,"textAlign",{get:function(){return y.textAlign},set:function(e){y.textAlign=e}}),y.textBaseline="alphabetic",Object.defineProperty(l,"textBaseline",{get:function(){return y.textBaseline},set:function(e){y.textBaseline=e}}),y.globalAlpha=1,Object.defineProperty(l,"globalAlpha",{get:function(){return y.globalAlpha},set:function(e){y.globalAlpha=e}}),y.globalCompositeOperation="source-over",Object.defineProperty(l,"globalCompositeOperation",{get:function(){return y.globalCompositeOperation},set:function(e){y.globalCompositeOperation=e}}),l.fillText=function(e,t,i){},l.strokeText=function(){},l.measureText=function(){return 1};var _=document.createElement("canvas").getContext("2d");l.save=function(){n.transform.pushMatrix(),w.push({fillStyle:[y.fillStyle[0],y.fillStyle[1],y.fillStyle[2],y.fillStyle[3]],strokeStyle:[y.strokeStyle[0],y.strokeStyle[1],y.strokeStyle[2],y.strokeStyle[3]],globalAlpha:y.globalAlpha,globalCompositeOperation:y.globalCompositeOperation,lineCap:y.lineCap,lineJoin:y.lineJoin,lineWidth:y.lineWidth,miterLimit:y.miterLimit,shadowColor:y.shadowColor,shadowBlur:y.shadowBlur,shadowOffsetX:y.shadowOffsetX,shadowOffsetY:y.shadowOffsetY,textAlign:y.textAlign,font:y.font,textBaseline:y.textBaseline})},l.restore=function(){n.transform.popMatrix(),w.length&&(y=w.pop())},l.translate=function(e,t){n.transform.translate(e,t)},l.rotate=function(e){n.transform.rotate(e)},l.scale=function(e,t){n.transform.scale(e,t)},l.createImageData=function(e,t){return _.createImageData(e,t)},l.getImageData=function(e,t,i,r){var o=_.createImageData(i,r),a=new Uint8Array(i*r*4);l.readPixels(e,t,i,r,l.RGBA,l.UNSIGNED_BYTE,a);for(var n=4*i,s=r,c=0,d=s/2;c<d;++c)for(var h=0,u=n;h<u;++h){var m=c*n+h,p=(s-c-1)*n+h;o.data[m]=a[p],o.data[p]=a[m]}return o},l.putImageData=function(e,t,i){l.drawImage(e,t,i)},l.transform=function(e,t,i,r,o,a){var l=n.transform.m_stack[n.transform.c_stack];l[0]*=e,l[1]*=i,l[2]*=o,l[3]*=t,l[4]*=r,l[5]*=a,l[6]=0,l[7]=0},l.setTransform=function(e,t,i,r,o,a){n.transform.setIdentity(),l.transform.apply(this,arguments)},l.fillRect=function(e,t,r,o){var a=n.transform,s=n.initShaders(a.c_stack+2,0);l.bindBuffer(l.ARRAY_BUFFER,c),l.vertexAttribPointer(s.vertexPositionAttribute,4,l.FLOAT,!1,0,0),a.pushMatrix(),a.translate(e,t),a.scale(r,o),i(s),l.uniform4f(s.uColor,y.fillStyle[0],y.fillStyle[1],y.fillStyle[2],y.fillStyle[3]),l.drawArrays(l.TRIANGLE_FAN,0,4),a.popMatrix()},l.strokeRect=function(e,t,r,o){var a=n.transform,s=n.initShaders(a.c_stack+2,0);l.bindBuffer(l.ARRAY_BUFFER,c),l.vertexAttribPointer(s.vertexPositionAttribute,4,l.FLOAT,!1,0,0),a.pushMatrix(),a.translate(e,t),a.scale(r,o),i(s),l.uniform4f(s.uColor,y.strokeStyle[0],y.strokeStyle[1],y.strokeStyle[2],y.strokeStyle[3]),l.drawArrays(l.LINE_LOOP,0,4),a.popMatrix()},l.clearRect=function(e,t,i,r){};var v=[];l.beginPath=function(){v.length=0},l.closePath=function(){if(v.length){var e=v[v.length-1],t=e.verts[0],i=e.verts[1];e.closed=!0;var r=new o(t,i);v.push(r)}},l.moveTo=function(e,t){v.push(new o(e,t))},l.lineTo=function(e,t){v.length?v[v.length-1].verts.push(e,t,0,0):l.moveTo(e,t)},l.quadraticCurveTo=function(e,t,i,r){},l.bezierCurveTo=function(e,t,i,r,o,a){},l.arcTo=function(){},l.rect=function(e,t,i,r){l.moveTo(e,t),l.lineTo(e+i,t),l.lineTo(e+i,t+r),l.lineTo(e,t+r),l.closePath()},l.arc=function(e,t,i,r,o,a){},l.fill=function(){for(var e=0;e<v.length;e++)t=e,r=void 0,o=n.initShaders((r=n.transform).c_stack+2,0),a=v[t].verts,l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(a),l.STATIC_DRAW),l.vertexAttribPointer(o.vertexPositionAttribute,4,l.FLOAT,!1,0,0),r.pushMatrix(),i(o),l.uniform4f(o.uColor,y.fillStyle[0],y.fillStyle[1],y.fillStyle[2],y.fillStyle[3]),l.drawArrays(l.TRIANGLE_FAN,0,a.length/4),r.popMatrix();var t,r,o,a},l.stroke=function(){for(var e=0;e<v.length;e++)t=e,r=void 0,o=n.initShaders((r=n.transform).c_stack+2,0),s=(a=v[t]).verts,l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(s),l.STATIC_DRAW),l.vertexAttribPointer(o.vertexPositionAttribute,4,l.FLOAT,!1,0,0),r.pushMatrix(),i(o),l.uniform4f(o.uColor,y.strokeStyle[0],y.strokeStyle[1],y.strokeStyle[2],y.strokeStyle[3]),l.drawArrays(a.closed?l.LINE_LOOP:l.LINE_STRIP,0,s.length/4),r.popMatrix();var t,r,o,a,s},l.clip=function(){},l.isPointInPath=function(){},l.drawFocusRing=function(){};var b=[],C=[];l.drawImage=function(e,t,r,o,s,d,h,u,m){var p=n.transform;p.pushMatrix();var g=1,f=!1;3===arguments.length?(p.translate(t,r),p.scale(e.width,e.height)):5===arguments.length?(p.translate(t,r),p.scale(o,s)):9===arguments.length&&(p.translate(d,h),p.scale(u,m),g|=2,f=!0);var y,w=n.initShaders(p.c_stack,g),_=b.indexOf(e);y=-1!==_?C[_]:new a(e),f&&l.uniform4f(w.uCropSource,t/e.width,r/e.height,o/e.width,s/e.height),l.bindBuffer(l.ARRAY_BUFFER,c),l.vertexAttribPointer(w.vertexPositionAttribute,4,l.FLOAT,!1,0,0),l.bindTexture(l.TEXTURE_2D,y.obj),l.activeTexture(l.TEXTURE0),l.uniform1i(w.uSampler,0),i(w),l.drawArrays(l.TRIANGLE_FAN,0,4),p.popMatrix()}}}(Math),t.default=i})),define("model/canvas",["require","exports","lib/webgl-canvas"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getScreenSize=t.getDrawScale=t.setDrawScale=t.getCtx=t.getCanvas=t.createCanvas=t.CANVAS_ID_OUTER=t.CANVAS_ID=t.SCREEN_WIDTH=void 0,i=r(i),t.SCREEN_WIDTH=512,t.CANVAS_ID="canv",t.CANVAS_ID_OUTER="canv-outer";let o=null,a=null,n=1;t.createCanvas=(e,t,r)=>{let o,a=document.createElement("canvas");return a.width=e||1,a.height=t||1,r?(i.default.enable(a),o=a.getContext("webgl-2d")):o=a.getContext("2d"),[a,o,e,t]},t.getCanvas=e=>{if("outer"===e&&a)return a;if(o)return o;{let[e,i]=t.createCanvas(t.SCREEN_WIDTH,t.SCREEN_WIDTH,!0);e.id=t.CANVAS_ID,i.imageSmoothingEnabled=!1;let r=document.getElementById("canvas-container");if(r){r.appendChild(e);let[i,o]=t.createCanvas(t.SCREEN_WIDTH,t.SCREEN_WIDTH);i.id=t.CANVAS_ID_OUTER,o.imageSmoothingEnabled=!1,r.appendChild(i)}return o=e,e}},t.getCtx=e=>{var i;let r=t.getCanvas(e);return null!==(i=r.getContext("2d"))&&void 0!==i?i:r.getContext("webgl-2d")};let l=(e,i)=>{n=i,e&&(e.style.width=t.SCREEN_WIDTH*n+"",e.style.height=t.SCREEN_WIDTH*n+"",i>2&&(e.style.position="relative",e.style.left=-parseInt(e.style.width)/4+"px",e.style.top=-parseInt(e.style.height)/4+"px"))};t.setDrawScale=e=>{n=e;let i=document.getElementById(t.CANVAS_ID);i&&l(i,e);let r=document.getElementById(t.CANVAS_ID_OUTER);r&&(l(r,e),r.style.position="absolute",r.style.left="0px",r.style.top="0px",a=r)},t.getDrawScale=()=>n,t.getScreenSize=()=>t.SCREEN_WIDTH})),define("view/elements/Button",["require","exports","view/style"],(function(e,t,i){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonType=void 0,function(e){e[e.PRIMARY=0]="PRIMARY",e[e.SECONDARY=1]="SECONDARY",e[e.CANCEL=2]="CANCEL"}(r=t.ButtonType||(t.ButtonType={}));let o={[r.PRIMARY]:i.colors.GREEN,[r.SECONDARY]:i.colors.GREY,[r.CANCEL]:i.colors.RED},a=i.style("div",e=>({textAlign:"center",borderRadius:"0.25rem",padding:"0.5rem",fontSize:"1rem",background:o[e.type],cursor:"pointer","&:hover":{filter:"brightness(120%)"},"&:active":{filter:"brightness(80%)"},[i.MEDIA_QUERY_PHONE_WIDTH]:{padding:"0.75rem",fontSize:"2rem"}}));t.default=a})),define("view/icons/Cursor",["require","exports","preact"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>i.h("svg",{style:"transform: rotate(75deg)",stroke:e.color,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.h("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M21.1568 4.15379C21.5068 3.32658 20.6734 2.49321 19.8462 2.84319L3.46966 9.77172C2.60871 10.136 2.67381 11.3772 3.56814 11.6494L8.7707 13.2327C9.72737 13.5239 10.4761 14.2726 10.7672 15.2293L12.3506 20.4318C12.6228 21.3262 13.864 21.3913 14.2283 20.5303L21.1568 4.15379ZM19.0669 1.00125C21.5485 -0.048667 24.0486 2.45145 22.9987 4.93307L16.0702 21.3096C14.9775 23.8924 11.2538 23.6971 10.4373 21.0142L8.85389 15.8116C8.75683 15.4927 8.50727 15.2432 8.18837 15.1461L2.98581 13.5627C0.302836 12.7462 0.107539 9.02252 2.69038 7.92979L19.0669 1.00125Z",fill:e.color}))})),define("view/icons/Close",["require","exports","preact"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>i.h("svg",{xmlns:"http://www.w3.org/2000/svg",id:"svg2",viewBox:"0 0 84.853 84.853",version:"1.0"},i.h("g",{id:"layer1",transform:"translate(-153.29 -132.79)"},i.h("g",{id:"g2762",transform:"matrix(.70711 -.70711 .70711 .70711 -66.575 189.71)",fill:e.color},i.h("rect",{id:"rect1872",y:"165.22",width:"100",x:"145.71",height:"20"}),i.h("rect",{id:"rect1874",transform:"rotate(90)",height:"20",width:"100",y:"-205.71",x:"125.22"}))))})),define("view/elements/VerticalMenu",["require","exports","preact","preact/hooks","view/style","view/icons/Cursor","view/icons/Close"],(function(e,t,i,o,a,n,l){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),t.MenuLineHeight=void 0,n=r(n),l=r(l),function(e){e[e.SMALL=0]="SMALL",e[e.MEDIUM=1]="MEDIUM",e[e.LARGE=2]="LARGE"}(s=t.MenuLineHeight||(t.MenuLineHeight={}));let c={backgroundColor:a.colors.BLACK,borderColor:a.colors.WHITE,lineHeight:s.MEDIUM,startingIndex:0},d=e=>{switch(e){case s.SMALL:return{fontSize:"12px",padding:"0.25rem",minHeight:"12px"};case s.MEDIUM:return{fontSize:"16px",padding:"0.5rem",minHeight:"16px"};case s.LARGE:return{fontSize:"24px",padding:"1rem",minHeight:"24px"}}},h=a.style("div",e=>({background:e.backgroundColor,position:"relative",width:e.width||"100%",border:"4px double "+e.borderColor,boxSizing:"border-box",transition:e.open?"transform 0.15s ease-out":"unset",transform:e.open?"scale(1.0)":"scale(0.0)"})),u=a.style("div",e=>({position:"relative","&:not(:last-child)":{borderBottom:"2px solid "+e.borderColor}})),m=a.style("div",e=>Object.assign(Object.assign({textAlign:"center"},d(e.lineHeight)),{color:"white",backgroundColor:e.backgroundColor,cursor:"pointer",filter:e.active?"brightness(80%)":"",transform:e.active?"translateY(2px)":""})),p=a.keyframes({"0%":{transform:"translateX(-5px)"},"20%":{transform:"translateX(0px)"},"100%":{transform:"translateX(-5px)"}}),g=a.style("div",()=>({color:a.colors.WHITE,position:"absolute",top:"0px",left:"-32px",animation:p+" 500ms linear infinite"})),f=()=>i.h(g,null,i.h(n.default,{color:a.colors.BLUE})),y=a.style("div",e=>({textAlign:"center",position:"relative",background:a.colors.DARKBLUE,display:"flex",justifyContent:e.title?"space-around":"center",alignItems:"baseline"})),w=a.style("div",e=>Object.assign(Object.assign({},d(e.lineHeight)),{width:"1rem",cursor:"pointer",background:e.backgroundColor,borderRight:"2px solid "+a.colors.WHITE,marginTop:"0.15rem","&:hover":{filter:"brightness(120%)"},"&:active":{filter:"brightness(80%)"}})),_=a.style("div",e=>Object.assign(Object.assign({},d(e.lineHeight)),{width:"calc(100% - 34px)"})),v=e=>{var t;let r=null!==(t=e.lineHeight)&&void 0!==t?t:s.MEDIUM;return i.h(y,{title:e.title},e.onClick?i.h(w,{backgroundColor:e.backgroundColor,onClick:e.onClick,lineHeight:r},i.h(l.default,{color:a.colors.RED})):null,i.h(_,{lineHeight:r},e.title||""))},b=function(e){var t,r,n;let[{cursorIndex:l,active:c},d]=o.useReducer(({cursorIndex:t,active:i},r)=>{var o;let a=t,n=i;return"Increment"===r.type?a=(a+1)%e.items.length:"Decrement"===r.type?a=(a-1+e.items.length)%e.items.length:"Set"===r.type?i||(a=null!==(o=r.payload)&&void 0!==o?o:0):"Select"===r.type?i||(n=!0,setTimeout(()=>{d({type:"SelectInactive"})},100)):"SelectInactive"===r.type&&(e.onItemClick(e.items[t].value),n=!1),{cursorIndex:a,active:n}},{cursorIndex:null!==(t=e.startingIndex)&&void 0!==t?t:0,active:!1});o.useEffect(()=>{let t=t=>{if(e.open&&!e.isInactive){let i=l;"ArrowDown"===t.code?d({type:"Increment"}):"ArrowUp"===t.code?(d({type:"Decrement"}),i=(i-1+e.items.length)%e.items.length):"Enter"===t.code?d({type:"Select"}):"Escape"===t.code&&e.onClose&&e.onClose()}};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[e.open,e.isInactive]);let p=e.lineHeight||s.MEDIUM;return i.h(h,{backgroundColor:null!==(r=e.backgroundColor)&&void 0!==r?r:a.colors.BLACK,borderColor:null!==(n=e.borderColor)&&void 0!==n?n:a.colors.WHITE,width:e.width,open:e.open},i.h(u,{key:"title",borderColor:e.borderColor},i.h(v,{backgroundColor:e.backgroundColor||a.colors.BLACK,onClick:e.onClose,lineHeight:e.lineHeight,title:e.title})),e.items.map((t,r)=>i.h(u,{key:r,borderColor:e.borderColor},i.h(m,{key:r,backgroundColor:e.backgroundColor,highlighted:l===r,lineHeight:p,active:c&&l===r,onClick:()=>{d({type:"Set",payload:r}),setTimeout(()=>{d({type:"Select"})})},onMouseOver:()=>{d({type:"Set",payload:r})}},t.label),l===r?i.h(f,null):null)))};b.defaultProps=c,t.default=b})),define("model/player",["require","exports","model/character","model/battle","utils"],(function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playerGetCameraOffset=t.playerGetBattlePosition=t.playerSetBattlePosition=t.playerCreate=void 0,t.playerCreate=e=>{let t=i.characterCreateFromTemplate(e);return{leader:t,party:[t],battlePositions:{[r.BattlePosition.FRONT]:[t],[r.BattlePosition.MIDDLE]:[],[r.BattlePosition.BACK]:[]}}},t.playerSetBattlePosition=(e,t,i)=>{if(o.removeIfPresent(e.battlePositions[r.BattlePosition.FRONT],t),o.removeIfPresent(e.battlePositions[r.BattlePosition.MIDDLE],t),o.removeIfPresent(e.battlePositions[r.BattlePosition.BACK],t),!e.party.includes(t))throw console.error(e,t,i),Error("Cannot set battle position for player, the given character is not in the party.");e.battlePositions[i].push(t)},t.playerGetBattlePosition=(e,t)=>{if(e.battlePositions[r.BattlePosition.FRONT].includes(t))return r.BattlePosition.FRONT;if(e.battlePositions[r.BattlePosition.MIDDLE].includes(t))return r.BattlePosition.MIDDLE;if(e.battlePositions[r.BattlePosition.BACK].includes(t))return r.BattlePosition.BACK;throw Error("Cannot get battle position for party member who isn't in the player's party: "+JSON.stringify(t))},t.playerGetCameraOffset=e=>{let t=e.leader,[i,r]=o.isoToPixelCoords(t.x,t.y);return[256-i-16,256-r]}})),define("model/utility",["require","exports","model/generics","utils","model/room"],(function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Transform=t.transformOffsetJumpFar=t.transformOffsetJumpMedium=t.transformOffsetJumpShort=t.transformOffsetFlat=t.TransformEase=t.Gauge=t.Timer=void 0;class a{constructor(e){this.timestampStart=i.getNow(),this.timestampPause=0,this.duration=e,this.shouldRemove=!1,this.isPaused=!1,this.awaits=[]}start(e){this.timestampStart=i.getNow(),this.duration=null!=e?e:this.duration}pause(){this.isPaused||(this.isPaused=!0,this.timestampPause=i.getNow())}unpause(){this.isPaused&&(this.isPaused=!1,this.updateStart(i.getNow()-this.timestampPause))}updateStart(e){this.timestampStart+=e}update(){this.isComplete()&&(this.awaits.forEach(e=>e()),this.awaits=[])}isComplete(){return i.getNow()-this.timestampStart>=this.duration}onCompletion(){return new Promise(e=>{this.isComplete()||this.awaits.push(e)})}getPctComplete(){let e=i.getNow();this.isPaused&&(e-=e-this.timestampPause);let t=e-this.timestampStart;return t>this.duration?t=this.duration:t<0&&(t=0),t/this.duration}markForRemoval(){this.shouldRemove=!0}}var n;t.Timer=a,t.Gauge=class{constructor(e,t){this.max=e,this.current=0,this.decayRate=t}fill(e){this.current+=e,this.current>this.max&&(this.current=this.max)}empty(){this.current=0}isFull(){return this.current>=this.max}getPct(){return this.current/this.max}update(){this.current-=this.decayRate*i.getFrameMultiplier(),this.current<0&&(this.current=0)}},function(e){e.LINEAR="linear",e.EASE_OUT="ease_out"}(n=t.TransformEase||(t.TransformEase={})),t.transformOffsetFlat=e=>[0*e,0*e,0*e],t.transformOffsetJumpShort=e=>[0,0,o.TILE_HEIGHT*Math.sin(e*Math.PI)],t.transformOffsetJumpMedium=e=>[0,0,2*o.TILE_HEIGHT*Math.sin(e*Math.PI)],t.transformOffsetJumpFar=e=>[0,0,4*o.TILE_HEIGHT*Math.sin(e*Math.PI)];class l{constructor(e,i,r,o,n){this.startX=e[0],this.startY=e[1],this.startZ=e[2],this.endX=i[0],this.endY=i[1],this.endZ=i[2],this.timer=new a(r),this.ease=o,this.shouldRemove=!1,this.offsetFunc=n||t.transformOffsetFlat,this.timer.start()}start(){return[this.startX,this.startY,this.endZ]}end(){return[this.endX,this.endY,this.endZ]}current(){let[e,t,i]=this.offsetFunc(this.timer.getPctComplete(),this),o=this.timer.getPctComplete(),a=this.ease===n.EASE_OUT?r.normalizeEaseOutClamp:r.normalizeClamp;return[a(o,0,1,this.startX,this.endX)+e,a(o,0,1,this.startY,this.endY)+t,a(o,0,1,this.startZ,this.endZ)+i]}update(){this.timer.update()}createInverse(){return new l([this.endX,this.endY,this.endZ],[this.startX,this.startY,this.startZ],this.timer.duration,this.ease,this.offsetFunc)}markForRemoval(){this.shouldRemove=!0}}t.Transform=l})),define("model/particle",["require","exports","model/utility","model/animation","utils","model/sprite","model/room"],(function(e,t,i,r,o,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.particleUpdate=t.particleGetSize=t.particleGetPos=t.particleCreateFromTemplate=t.createDamageParticle=t.EFFECT_TEMPLATE_SWORD_LEFT=void 0,t.EFFECT_TEMPLATE_SWORD_LEFT={animName:"effect_sword_left"},t.createDamageParticle=(e,t,r,a)=>{let l={anim:void 0,text:e,textParams:{size:16,color:null!=a?a:"white",align:"center",strokeColor:"black"},timer:new i.Timer(1e3),shouldRemove:!1,transform:new i.Transform([t,r,0],[t+o.getRandBetween(-n.TILE_WIDTH/2,n.TILE_WIDTH/2),r-n.TILE_HEIGHT,0],1e3,i.TransformEase.EASE_OUT),x:t,y:r};return l.timer.start(),l},t.particleCreateFromTemplate=(e,t)=>{var o;let n=r.createAnimation(t.animName+(t.flipped?a.SpriteModification.FLIPPED:a.SpriteModification.NORMAL)),[l,s]=n.getSpriteSize(1),c={anim:n,timer:new i.Timer(null!==(o=t.duration)&&void 0!==o?o:n.getDurationMs()),shouldRemove:!1,x:e[0]-l/2,y:e[1]-s/2};return n.start(),c.timer.start(),c},t.particleGetPos=e=>e.transform?o.truncatePoint3d(e.transform.current()):[e.x,e.y],t.particleGetSize=e=>{let t=e.anim;return(null==t?void 0:t.getSpriteSize(0))||[0,0]},t.particleUpdate=e=>{e.timer.isComplete()&&(e.shouldRemove=!0)}})),define("controller/battle-management",["require","exports","model/battle","model/character","model/room","db/overworlds","model/generics","model/player","model/particle","utils","model/store","controller/ui-actions","model/generics"],(function(e,t,i,r,o,a,n,l,s,c,d,h,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.completeCast=t.interruptCast=t.setCasting=t.calculateStaggerDamage=t.resetCooldownTimer=t.applyWeaponDamage=t.endAction=t.beginAction=t.updateBattleCharacter=t.updateBattle=t.initiateBattle=void 0,t.initiateBattle=(e,s)=>{let c=a.getRoom(s.roomName);c.characters=[];let d=s.enemies.map(e=>{let t=r.characterCreateFromTemplate(e.chTemplate);return o.roomAddCharacter(c,t),i.battleCharacterCreateEnemy(t,e)}),h={room:c,isCompleted:!1,enemies:d,defeated:[],allies:e.party.map(t=>(o.roomAddCharacter(c,t),i.battleCharacterCreateAlly(t,{position:l.playerGetBattlePosition(e,t)})))};return h.allies.forEach(t.resetCooldownTimer),h.enemies.forEach(t.resetCooldownTimer),i.battleSetActorPositions(h),u.setCurrentPlayer(e),n.setCurrentBattle(h),n.setCurrentRoom(c),h},t.updateBattle=e=>{for(let i=0;i<e.allies.length;i++){let r=e.allies[i];t.updateBattleCharacter(e,r),r.shouldRemove&&(e.allies.splice(i,1),i--)}for(let i=0;i<e.enemies.length;i++){let r=e.enemies[i];t.updateBattleCharacter(e,r),r.shouldRemove&&(e.enemies.splice(i,1),i--)}if(!e.isCompleted)if(i.battleIsVictory(e)){e.isCompleted=!0,h.showSection(d.AppSection.BattleVictory,!0);for(let t in e.allies)r.characterSetAnimationState(e.allies[t].ch,r.AnimationState.BATTLE_FLOURISH);setTimeout(()=>{h.showSection(d.AppSection.Debug,!0)},2e3)}else i.battleIsLoss(e)&&(e.isCompleted=!0,h.showSection(d.AppSection.BattleDefeated,!0),setTimeout(()=>{h.showSection(d.AppSection.Debug,!0)},2e3))},t.updateBattleCharacter=(e,o)=>{o.ch.hp<=0?o.isDefeated||(o.isDefeated=!0,r.characterSetAnimationState(o.ch,r.AnimationState.BATTLE_DEFEATED),r.characterOnAnimationCompletion(o.ch,()=>{let t=e.enemies.indexOf(o);if(t>-1)return o.shouldRemove=!0,void e.defeated.push(o);t=e.allies.indexOf(o),t>-1&&(o.shouldRemove=!0,e.defeated.push(o))})):e.isCompleted||(o.isStaggered&&o.staggerTimer.isComplete()&&(o.isStaggered=!1,r.characterSetAnimationState(o.ch,r.AnimationState.BATTLE_IDLE)),o.isCasting&&o.castTimer.isComplete()&&t.completeCast(o),o.staggerGauge.update(),o.canAct?o.canAct=i.battleCharacterCanAct(e,o):i.battleCharacterCanAct(e,o)&&(o.canAct=!0,o.onCanActCb(),o.ai&&o.ai(e,o)))},t.beginAction=(e,t)=>{t.isActing=!0,t.actionTimer.start(),t.actionTimer.pause()},t.endAction=(e,i)=>{i.isActing=!1,t.resetCooldownTimer(i),i.actionTimer.unpause()},t.applyWeaponDamage=(e,a,n,l,d)=>{let h=l+a.ch.stats.POW+a.ch.stats.ACC/4;l=c.getRandBetween(h/2+h/2*a.ch.stats.ACC/100,h),n.isStaggered?(n.staggerTimer.start(),l*=2):(n.staggerGauge.fill(d),n.staggerGauge.isFull()&&i.battleCharacterSetStaggered(n)),n.isCasting&&t.interruptCast(n),l=Math.max(1,Math.floor(l));let[u,m]=r.characterGetPosCenterPx(n.ch);o.roomAddParticle(e.room,s.createDamageParticle(l+"",u,m)),i.battleCharacterApplyDamage(n,l)},t.resetCooldownTimer=e=>{let t=e.ch.skills[e.ch.skillIndex];t&&(e.actionTimer.duration=Math.max(t.cooldown-t.cooldown*(1-1/(1+e.ch.stats.SPD/100)),1e3))},t.calculateStaggerDamage=e=>Math.max(e.stats.STAGGER,1),t.setCasting=(e,t)=>{var i,r;e.isCasting=!0,e.castTimer.duration=t.castTime,e.castTimer.start(),e.onCast=null!==(i=t.onCast)&&void 0!==i?i:function(){},e.onCastInterrupted=null!==(r=t.onInterrupt)&&void 0!==r?r:function(){}},t.interruptCast=e=>{e.isCasting=!1,e.onCastInterrupted()},t.completeCast=e=>{e.isCasting=!1,e.onCast()}})),define("view/components/BattleSelectMenu",["require","exports","preact","view/elements/VerticalMenu","view/style","model/player","model/battle","model/character","controller/battle-management","controller/battle-actions","controller/ui-actions","model/store"],(function(e,t,i,o,a,n,l,s,c,d,h,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r(o);let m=a.style("div",()=>({display:"flex",justifyContent:"center",alignItems:"center",height:"100%"})),p=a.style("div",()=>({display:"flex",justifyContent:"center",alignItems:"center"}));t.default=e=>i.h(m,null,i.h(o.default,{title:"SELECT BATTLE",width:"256px",open:!0,items:e.battles.map(({template:e,label:t})=>({label:i.h(p,null,i.h("span",null,t)),value:e})),onItemClick:e=>{(e=>{let t=n.playerCreate({name:"Ada",spriteBase:"ada",stats:l.battleStatsCreate(),facing:s.Facing.RIGHT,animationState:s.AnimationState.BATTLE_IDLE,skills:[d.BattleActions.Swing,d.BattleActions.Defend]}),i=s.characterCreateFromTemplate({name:"Conscience",spriteBase:"conscience",stats:l.battleStatsCreate(),facing:s.Facing.RIGHT,animationState:s.AnimationState.BATTLE_IDLE,skills:[d.BattleActions.Swing,d.BattleActions.Defend]});t.party.push(i),n.playerSetBattlePosition(t,i,l.BattlePosition.BACK),c.initiateBattle(t,e),h.showSection(u.AppSection.BattleUI,!0)})(e)}}))})),define("db/enemies",["require","exports","model/battle","model/character","controller/battle-actions"],(function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.get=void 0;let a={};t.get=e=>{let t=a[e];if(!t)throw Error("No enemy template exists with name: "+e);return Object.assign(Object.assign({},t),{stats:Object.assign({},t.stats)})},t.init=()=>{a.ENEMY_GUY={name:"guy",spriteBase:"guy",stats:i.battleStatsCreate(),facing:r.Facing.LEFT,animationState:r.AnimationState.BATTLE_IDLE,skills:[o.BattleActions.SwingSlow]}}})),define("db/encounters",["require","exports","model/battle","controller/battle-ai","db/enemies"],(function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.get=t.varyStats=void 0,t.varyStats=e=>{let t=e.stats,i=Object.keys(t);for(let e=0;e<i.length;e++){let r=i[e];"STAGGER"!==r&&Math.random()>.5&&(t[r]++,e--)}return e};let a={};t.get=e=>{let t=a[e];if(!t)throw Error("No encounter exists with name: "+e);return t},t.init=()=>{a.ENCOUNTER_ONE_VS_ONE={roomName:"battle1",enemies:[{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:i.BattlePosition.FRONT,ai:r.BATTLE_AI_ATTACK}]},a.ENCOUNTER_ONE_VS_TWO={roomName:"battle1",enemies:[{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:i.BattlePosition.FRONT,ai:r.BATTLE_AI_ATTACK},{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:i.BattlePosition.FRONT,ai:r.BATTLE_AI_ATTACK}]},a.ENCOUNTER_ONE_VS_THREE={roomName:"battle1",enemies:[{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:i.BattlePosition.FRONT,ai:r.BATTLE_AI_ATTACK},{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:i.BattlePosition.FRONT,ai:r.BATTLE_AI_ATTACK},{chTemplate:t.varyStats(o.get("ENEMY_GUY")),position:i.BattlePosition.MIDDLE,ai:r.BATTLE_AI_ATTACK}]}},t.default=a})),define("controller/arcade-iframe-actions",["require","exports","utils"],(function(e,t,i){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.setScaleWindow=t.setScaleOriginal=t.setButtonUp=t.setButtonDown=t.unmuteAudio=t.muteAudio=t.showControls=t.hideControls=void 0,function(e){e.HIDE_CONTROLS="HIDE_CONTROLS",e.SHOW_CONTROLS="SHOW_CONTROLS",e.MUTE_AUDIO="MUTE_AUDIO",e.UNMUTE_AUDIO="UNMUTE_AUDIO",e.BUTTON_DOWN="BUTTON_DOWN",e.BUTTON_UP="BUTTON_UP",e.SCALE_ORIGINAL="SCALE_ORIGINAL",e.SCALE_WINDOW="SCALE_WINDOW"}(r||(r={}));let o=window.location.origin,a=async()=>{let e=document.getElementById("arcade-iframe");if(e){let t=e;if(!t.contentWindow)for(let e=0;e<100&&(await i.timeoutPromise(33),!t.contentWindow);e++);return t.contentWindow}return console.error("Cannot get iframe contentWindow."),null},n=async(e,t)=>{e.postMessage(JSON.stringify(t),o)};t.hideControls=async()=>{let e=await a();e&&n(e,{action:r.HIDE_CONTROLS})},t.showControls=async()=>{let e=await a();e&&n(e,{action:r.SHOW_CONTROLS})},t.muteAudio=async()=>{let e=await a();e&&n(e,{action:r.MUTE_AUDIO})},t.unmuteAudio=async()=>{let e=await a();e&&n(e,{action:r.UNMUTE_AUDIO})},t.setButtonDown=async e=>{let t=await a();t&&n(t,{action:r.BUTTON_DOWN,payload:e})},t.setButtonUp=async e=>{let t=await a();t&&n(t,{action:r.BUTTON_UP,payload:e})},t.setScaleOriginal=async()=>{let e=await a();e&&n(e,{action:r.SCALE_ORIGINAL})},t.setScaleWindow=async()=>{let e=await a();e&&n(e,{action:r.SCALE_WINDOW})}})),define("view/elements/IframeShim",["require","exports","preact","view/style"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let o=r.style("div",e=>({border:"20px solid black",transition:"width 0.25s, height 0.25s, marginTop 0.25s",borderImage:`url(${e.borderImageUrl}) 20 round`,width:e.expanded?"calc(100% - 40px)":e.width,height:e.expanded?"calc(100% - 40px - 4rem)":e.height,marginTop:e.expanded?"4rem":"0",display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:"all",[r.MEDIA_QUERY_PHONE_WIDTH]:{width:e.expanded?"calc(100% - 40px)":e.width,height:e.expanded?"calc(100% - 40px - 7.75rem)":e.height,marginTop:e.expanded?"7.75rem":"0"}}));t.default=e=>i.h(o,{expanded:e.expanded,borderImageUrl:"res/img/arcade-border-1.png",width:e.width,height:e.height},i.h("iframe",{id:e.id,ref:e.ref,src:e.src,style:{border:"0px",width:e.width,height:e.height}}))})),define("view/icons/Arrow",["require","exports","preact"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>i.h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:"left"===e.direction?"transform: rotate(180deg)":""},i.h("g",{transform:"translate(0,0)"},i.h("path",{d:"M106.854 106.002a26.003 26.003 0 0 0-25.64 29.326c16 124 16 117.344 0 241.344a26.003 26.003 0 0 0 35.776 27.332l298-124a26.003 26.003 0 0 0 0-48.008l-298-124a26.003 26.003 0 0 0-10.136-1.994z",fill:e.color,"fill-opacity":"1"})))})),define("view/icons/Help",["require","exports","preact"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>i.h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",style:"width:100%"},i.h("g",{class:"",transform:"translate(0,0)",style:""},i.h("path",{d:"M256 16C123.45 16 16 123.45 16 256s107.45 240 240 240 240-107.45 240-240S388.55 16 256 16zm0 60c99.41 0 180 80.59 180 180s-80.59 180-180 180S76 355.41 76 256 156.59 76 256 76zm0 30c-66.274 0-120 40.294-120 90 0 30 60 30 60 0 0-16.57 26.862-30 60-30 33.138 0 60 13.43 60 30s-30 15-60 30c-1.875.938-3.478 2.126-4.688 3.28C226.53 244.986 226 271.926 226 286v15c0 16.62 13.38 30 30 30 16.62 0 30-13.38 30-30v-15c0-45 90-40.294 90-90s-53.726-90-120-90zm0 240a30 30 0 0 0-30 30 30 30 0 0 0 30 30 30 30 0 0 0 30-30 30 30 0 0 0-30-30z",fill:e.color,"fill-opacity":"1"})))})),define("view/components/ArcadeCabinet",["require","exports","preact","preact/hooks","view/style","controller/arcade-iframe-actions","view/elements/Button","view/elements/IframeShim","view/icons/Arrow","view/icons/Help"],(function(e,t,o,a,n,l,s,c,d,h){"use strict";var u;Object.defineProperty(t,"__esModule",{value:!0}),t.ArcadeGamePath=void 0,s=i(s),c=r(c),d=r(d),h=r(h),function(e){e[e.Enter=13]="Enter",e[e.Space=32]="Space",e[e.Left=1073741904]="Left",e[e.Right=1073741903]="Right"}(u||(u={}));let m=e=>({onMouseDown:()=>{l.setButtonDown(e)},onMouseUp:()=>{l.setButtonUp(e)},onTouchStart:()=>{l.setButtonDown(e)},onTouchEnd:()=>{l.setButtonUp(e)}});var p;!function(e){e.PRESIDENT="iframes/president/president.html",e.TIC_TAC_TOE="iframes/tic-tac-toe/tic-tac-toe.html",e.INVADERZ="iframes/invaderz/Invaderz.html",e.ELASTICITY="iframes/elasticity/elasticity.html"}(p=t.ArcadeGamePath||(t.ArcadeGamePath={}));let g={[p.PRESIDENT]:{title:"President",controls:()=>o.h("div",null)},[p.TIC_TAC_TOE]:{title:"Tic Tac Toe",controls:()=>o.h(o.Fragment,null,o.h(C,Object.assign({width:"48px",height:"48px",type:"text"},m(u.Enter)),o.h(h.default,{color:n.colors.YELLOW})))},[p.INVADERZ]:{title:"INVADERZ",controls:()=>o.h(o.Fragment,null,o.h(C,Object.assign({width:"48px",height:"48px"},m(u.Left)),o.h(d.default,{color:n.colors.GREEN,direction:"left"})),o.h(C,Object.assign({width:"48px",height:"48px"},m(u.Right)),o.h(d.default,{color:n.colors.GREEN,direction:"right"})),o.h(C,Object.assign({width:"48px",height:"48px",type:"text"},m(u.Space)),"FIRE"),o.h(C,Object.assign({width:"48px",height:"48px",type:"text"},m(u.Enter)),"START"))},[p.ELASTICITY]:{title:"ELASTICITY",controls:()=>o.h(o.Fragment,null,o.h(C,Object.assign({width:"48px",height:"48px"},m(u.Left)),o.h(d.default,{color:n.colors.GREEN,direction:"left"})),o.h(C,Object.assign({width:"48px",height:"48px"},m(u.Right)),o.h(d.default,{color:n.colors.GREEN,direction:"right"})),o.h(C,Object.assign({width:"48px",height:"48px",type:"text"},m(u.Enter)),"START"))}},f=n.style("div",()=>({position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"})),y=n.style("div",e=>({position:"fixed",left:"0px",top:"0px",padding:"1rem",width:"100%",background:n.colors.BLACK,display:"flex",justifyContent:"flex-start",alignItems:"center",[n.MEDIA_QUERY_PHONE_WIDTH]:{padding:"2rem"}})),w=n.style("div",()=>({position:"relative",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"100%",pointerEvents:"none"})),_=n.style("div",e=>({border:"20px solid "+n.colors.BLACK,background:n.colors.DARKBLUE,color:n.colors.WHITE,fontSize:"4rem",width:"646px",boxSizing:"border-box",textAlign:"center"})),v=n.style("div",()=>({backgroundImage:"url(res/img/arcade-cabinet.png)",width:"646px",height:"712px",position:"absolute",left:"0px",top:"0px",zIndex:"-1"})),b=n.style("div",e=>({minHeight:"96px",width:"548px",background:n.colors.GREY,textAlign:"center",zIndex:"1",display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:"all",transform:"perspective(512px) rotateX(24deg) translateY(12px)",border:"2px solid "+n.colors.WHITE})),C=n.style("div",e=>{var t,i;return{tapHighlightColor:"rgba(0, 0, 0, 0)",webkitTapHighlightColor:"rgba(0, 0, 0, 0)",padding:"16px",fontSize:"16px",minWidth:e.width?"unset":"48px",width:e.width,height:e.height,margin:"16px 4px",background:null!==(t=e.backgroundColor)&&void 0!==t?t:n.colors.DARKBLUE,color:null!==(i=e.color)&&void 0!==i?i:n.colors.WHITE,cursor:"pointer",borderRadius:"8px",border:"2px solid "+n.colors.GREY,textAlign:"center",fontFamily:"monospace",userSelect:"none",display:"text"===e.type?"flex":"",justifyContent:"center",touchAction:"manipulate",alignItems:"center","&:hover":{filter:"brightness(120%)"},"&:active":{filter:"brightness(80%)"}}});t.default=e=>{let[t,i]=a.useState(!1),[r,n]=a.useState(!1),d=g[e.game];return o.h(f,null,o.h(y,null,o.h(s.default,{type:s.ButtonType.CANCEL,style:{marginRight:"1rem"}},"Back"),o.h(s.default,{type:s.ButtonType.PRIMARY,style:{marginRight:"1rem"},onClick:()=>{let e=!t;i(e),e?(l.showControls(),l.setScaleWindow()):(l.hideControls(),l.setScaleOriginal())}},t?"Contract":"Expand"),o.h(s.default,{type:s.ButtonType.PRIMARY,style:{marginRight:"1rem"},onClick:()=>{let e=!r;n(e),e?l.muteAudio():l.unmuteAudio()}},r?"Unmute":"Mute")),o.h(w,null,t?null:o.h(_,null,d.title),o.h("div",{style:{transition:"height 0.25s",height:t?"0px":"32px",width:"646px",position:"relative"}},t?null:o.h(v,null)),o.h(c.default,{id:"arcade-iframe",src:e.game+"?cabinet=true&mute=true",width:t?"100%":"512px",height:t?"100%":"512px",expanded:t}),t?null:o.h(b,{id:"controls"},d.controls())))}})),define("controller/events",["require","exports","model/generics","model/canvas"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.popKeyHandler=t.pushKeyHandler=t.getCurrentKeyHandler=t.initEvents=void 0,t.initEvents=()=>{let e=document.getElementById(r.CANVAS_ID),{left:o,top:a,width:n,height:l}=(null==e?void 0:e.getBoundingClientRect())||{left:0,top:0,width:0,height:0};window.addEventListener("mousemove",e=>{let{clientX:t,clientY:r}=e,s=t-o,c=r-a;s>n&&(s=n),c>l&&(c=l),i.setMousePos(s,c)}),window.addEventListener("keydown",e=>{i.setKeyDown(e.key);let r=t.getCurrentKeyHandler();r&&r(e)}),window.addEventListener("keyup",e=>{i.setKeyUp(e.key)}),t.pushKeyHandler(async e=>{})};let o=[];t.getCurrentKeyHandler=()=>o[o.length-1],t.pushKeyHandler=e=>{o.push(e)},t.popKeyHandler=e=>{let t=o.indexOf(e);t>-1&&o.splice(t,1)}})),define("db/tiles",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.getReplacementTemplate=t.getIfExists=t.get=void 0;let i={},r={};t.get=e=>{let t=i[e];if(!t)throw Error("No tile template exists with name: "+e);return Object.assign({},t)},t.getIfExists=e=>{let t=i[e];return t?Object.assign({},t):null},t.getReplacementTemplate=e=>{let i=r[e];if(!i)return null;let o=t.get(i);return Object.assign({},o)},t.init=()=>{i.RED_DOOR_BCK_CLOSED1={baseSprite:"walls_14",animName:"walls-anims_red_door_bck_close1",isWall:!0},r.walls_14="RED_DOOR_BCK_CLOSED1",i.RED_DOOR_BCK_CLOSED2={baseSprite:"walls_14",animName:"walls-anims_red_door_bck_close2",isWall:!0},i.RED_DOOR_FWD_CLOSED1={baseSprite:"walls_13",animName:"walls-anims_red_door_fwd_close1",isWall:!0},r.walls_13="RED_DOOR_FWD_CLOSED1",i.RED_DOOR_FWD_CLOSED2={baseSprite:"walls_13",animName:"walls-anims_red_door_fwd_close2",isWall:!0},i.RED_DOOR_BCK_OPEN1={baseSprite:"walls_14",animName:"walls-anims_red_door_bck_open1",isWall:!1},i.RED_DOOR_BCK_OPEN2={baseSprite:"walls_14",animName:"walls-anims_red_door_bck_open2",isWall:!1},i.RED_DOOR_FWD_OPEN1={baseSprite:"walls_13",animName:"walls-anims_red_door_fwd_open1",isWall:!1},i.RED_DOOR_FWD_OPEN2={baseSprite:"walls_13",animName:"walls-anims_red_door_fwd_open2",isWall:!1}}})),define("db/characters",["require","exports","model/character"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.getIfExists=t.get=void 0;let r={};t.get=e=>{let t=r[e];if(!t)throw Error("No character template exists with name: "+e);return Object.assign({},t)},t.getIfExists=e=>{let t=r[e];return t?Object.assign({},t):null},t.init=()=>{r.Skye={name:"Skye",spriteBase:"skye",talkTrigger:"",facing:i.Facing.LEFT_UP,animationState:i.AnimationState.IDLE},r.Conscience={name:"Conscience",spriteBase:"conscience",talkTrigger:"",facing:i.Facing.LEFT_UP,animationState:i.AnimationState.IDLE},r.Roger={name:"Roger",spriteBase:"guy",talkTrigger:"test-roger",facing:i.Facing.LEFT_DOWN,animationState:i.AnimationState.IDLE},r.Rho={name:"Rho",spriteBase:"rho",talkTrigger:"test-rho",facing:i.Facing.DOWN,animationState:i.AnimationState.IDLE},r.Sigma={name:"Sigma",spriteBase:"sigma",talkTrigger:"test-sigma",facing:i.Facing.LEFT,animationState:i.AnimationState.IDLE}}})),define("controller/scene-commands",["require","exports","view/ui","controller/ui-actions","model/store","controller/events","model/character","model/room","model/generics","controller/scene-management","utils","model/animation","controller/overworld-management","db/tiles","db/characters","db/overworlds"],(function(e,t,i,r,o,a,n,l,s,c,d,h,u,m,p,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeRoom=t.fadeIn=t.fadeOut=t.despawnCharacter=t.spawnCharacterAtMarker=t.spawnCharacterAtCharacter=t.changeTileAtMarker=t.setCharacterAtMarker=t.walkToOffset=t.walkToMarker=t.setCharacterAt=t.shakeScreen=t.setFacing=t.lookAtEachOther=t.lookAtMarker=t.lookAtCharacter=t.callScript=t.setStorage=t.waitMSPreemptible=t.waitMS=t.setConversationSpeaker=t.endConversation=t.setConversation=t.setConversation2=t.playDialogue=void 0,t.playDialogue=(e,t,a)=>{let{cutscene:n}=i.getUiInterface().appState,l=o.CutsceneSpeaker.None;return e=e.toLowerCase(),n.portraitLeft===e?l=o.CutsceneSpeaker.Left:n.portraitLeft2===e?l=o.CutsceneSpeaker.Left2:n.portraitRight===e?l=o.CutsceneSpeaker.Right:n.portraitRight2===e?l=o.CutsceneSpeaker.Right2:n.portraitCenter===e&&(l=o.CutsceneSpeaker.Center),r.setCutsceneText(t,l),y()},t.setConversation2=(e,i)=>{if(e){if(i)return r.startConversation2(""+e.toLowerCase(),""+i.toLowerCase()),t.waitMS(500);console.error("No right actor specified.")}else console.error("No left actor specified.")},t.setConversation=e=>(r.startConversation(""+e.toLowerCase()),t.waitMS(100)),t.endConversation=e=>(r.setCutsceneText(""),r.hideConversation(),t.waitMS(null!=e?e:500)),t.setConversationSpeaker=e=>{r.setCutsceneText("",e)},t.waitMS=(e,t)=>{let i=s.getCurrentScene();return i.isWaitingForTime=!0,clearTimeout(i.waitTimeoutId),i.waitTimeoutId=setTimeout(()=>{i.isWaitingForTime=!1,t&&t()},e),!0},t.waitMSPreemptible=(e,t)=>{let i=s.getCurrentScene(),r=e=>{switch(e.key){case"Return":case"Enter":case" ":clearTimeout(i.waitTimeoutId),a.popKeyHandler(r),o()}};a.pushKeyHandler(r);let o=()=>{i.isWaitingForTime=!1,t&&t(),a.popKeyHandler(r)};return i.isWaitingForTime=!0,clearTimeout(i.waitTimeoutId),i.waitTimeoutId=setTimeout(o,e),!0};let f=()=>{let e=s.getCurrentScene();return e.isWaitingForTime=!0,()=>{e.isWaitingForTime=!1}},y=e=>{let t=s.getCurrentScene();t.isWaitingForInput=!0;let i=e=>{switch(e.key){case"Return":case"Enter":case" ":clearTimeout(t.waitTimeoutId),a.popKeyHandler(i),r()}};a.pushKeyHandler(i);let r=()=>{t.isWaitingForInput=!1,e&&e(),a.popKeyHandler(i)};return r};t.setStorage=(e,t)=>{s.getCurrentScene()[e]=t},t.callScript=e=>{let t=s.getCurrentScene();return c.callScript(t,e),!0},t.lookAtCharacter=(e,t)=>{let i=s.getCurrentRoom(),r=l.roomGetCharacterByName(i,e),o=l.roomGetCharacterByName(i,t);if(r)if(o){if(r&&o){let e=n.characterGetPosCenterPx(r),t=n.characterGetPosCenterPx(o),i=d.getAngleTowards(e,t);n.characterSetFacingFromAngle(r,i)}}else console.error("Could not find target character with name: "+t);else console.error("Could not find character with name: "+e)},t.lookAtMarker=(e,t)=>{let i=s.getCurrentRoom(),r=l.roomGetCharacterByName(i,e),o=i.markers[t];if(r)if(o){if(r&&o){let e=n.characterGetPosCenterPx(r),t=d.getAngleTowards(e,[o.x,o.y]);n.characterSetFacingFromAngle(r,t)}}else console.error("Could not find target marker with name: "+t);else console.error("Could not find character with name: "+e)},t.lookAtEachOther=(e,i)=>{t.lookAtCharacter(e,i),t.lookAtCharacter(i,e)},t.setFacing=(e,t)=>{let i=l.roomGetCharacterByName(s.getCurrentRoom(),e);i?(t===n.Facing.RIGHT2?t=n.Facing.RIGHT:t===n.Facing.RIGHT_UP2?t=n.Facing.RIGHT_UP:t===n.Facing.RIGHT_DOWN2&&(t=n.Facing.RIGHT_DOWN),n.characterSetFacing(i,t)):console.error("Cannot set facing, no character named:",e,"facing=",t)},t.shakeScreen=e=>{let i=document.getElementById("canvas-container");return i&&(i.className="shake"),t.waitMS(null!=e?e:1e3,()=>{i&&(i.className="")})},t.setCharacterAt=(e,t,i,r)=>{let o=s.getCurrentRoom(),a=l.roomGetCharacterByName(o,e);a?n.characterSetPos(a,[t,i,null!=r?r:0]):console.error("Could not find character with name: "+e)},t.walkToMarker=(e,t,i,r,o)=>{let a=s.getCurrentRoom(),c=l.roomGetCharacterByName(a,e),d=a.markers[t];if(!c)return void console.error("Could not find character with name: "+e);if(!d)return void console.error("Could not find target marker with name: "+t);let h=[d.x+(null!=i?i:0),d.y+(null!=r?r:0)];if(!o)return n.characterSetWalkTarget(c,h,f()),!0;n.characterSetWalkTarget(c,h,()=>{})},t.walkToOffset=(e,t,i,r)=>{let o=s.getCurrentRoom(),a=l.roomGetCharacterByName(o,e);if(!a)return void console.error("Could not find character with name: "+e);let c=[a.x+t,a.y+i];if(!r)return n.characterSetWalkTarget(a,c,f()),!0;n.characterSetWalkTarget(a,c,()=>{})},t.setCharacterAtMarker=(e,t,i,r)=>{let o=s.getCurrentRoom(),a=l.roomGetCharacterByName(o,e),c=o.markers[t];a?c?a&&c&&n.characterSetPos(a,d.extrapolatePoint([c.x+(null!=i?i:0),c.y+(null!=r?r:0)])):console.error("Could not find target marker with name: "+t):console.error("Could not find character with name: "+e)},t.changeTileAtMarker=(e,t,i,r)=>{var o;let a=s.getCurrentRoom(),n=a.markers[e],c=m.getIfExists(t);if(c)if(n){if(n){let t=l.roomGetTileBelow(a,[n.x+(null!=i?i:0),n.y+(null!=r?r:0)]);if(!t)return void console.error("Could not get a tile below the provided marker: "+e);if(t.isWall=null!==(o=c.isWall)&&void 0!==o?o:t.isWall,t.ro&&(t.ro.sprite=c.baseSprite,t.animName!==c.animName))if(t.animName=c.animName,c.animName){let e=h.createAnimation(c.animName);e.start(),t.ro.anim=e}else t.ro.anim=void 0}}else console.error("Could not find target marker with name: "+e);else console.error("Could not get a tile template with name: "+t)},t.spawnCharacterAtCharacter=(e,t,i,r)=>{let o=s.getCurrentRoom(),a=l.roomGetCharacterByName(o,t),c=p.getIfExists(e);if(!c)return void console.error("Could not get a character template with name: "+e);if(!a)return void console.error("Could not find target character with name: "+t);if(l.roomGetCharacterByName(o,c.name))return void console.error("The character to be spawned already exists in the current room: "+c.name);let d=[a.x+(null!=i?i:0),a.y+(null!=r?r:0),0],h=n.characterCreateFromTemplate(c);n.characterSetPos(h,d),l.roomAddCharacter(o,h)},t.spawnCharacterAtMarker=(e,t,i,r)=>{let o=s.getCurrentRoom(),a=o.markers[t],c=p.getIfExists(e);if(!c)return void console.error("Could not get a character template with name: "+e);if(!a)return void console.error("Could not find target marker with name: "+t);if(l.roomGetCharacterByName(o,c.name))return void console.error("The character to be spawned already exists in the current room: "+c.name);let d=[a.x+(null!=i?i:0),a.y+(null!=r?r:0),0],h=n.characterCreateFromTemplate(c);n.characterSetPos(h,d),l.roomAddCharacter(o,h)},t.despawnCharacter=e=>{let t=s.getCurrentRoom(),i=l.roomGetCharacterByName(t,e);i?l.roomRemoveCharacter(t,i):console.error("Could not find character with name: "+e)},t.fadeOut=(e,i)=>{let r=null!=e?e:750,o=document.getElementById("fade");if(o&&(o.style.transition=`background-color ${r}ms`,o.style["background-color"]="rgba(0, 0, 0, 255)"),!i)return t.waitMS(r)},t.fadeIn=(e,i)=>{let r=null!=e?e:1e3,o=document.getElementById("fade");if(o&&(o.style.transition=`background-color ${r}ms`,o.style["background-color"]="rgba(0, 0, 0, 0)"),!i)return t.waitMS(r)},t.changeRoom=e=>{let t=s.getCurrentPlayer(),i=g.getIfExists(e);t?i?u.initiateOverworld(t,i):console.error("No overworld template exists with name:",e):console.error("Player has not been initialized.")},t.default={playDialogue:t.playDialogue,setConversation2:t.setConversation2,setConversation:t.setConversation,endConversation:t.endConversation,setConversationSpeaker:t.setConversationSpeaker,waitMS:t.waitMS,waitMSPreemptible:t.waitMSPreemptible,waitUntil:f,waitForUserInput:y,setStorage:t.setStorage,callScript:t.callScript,lookAtCharacter:t.lookAtCharacter,lookAtMarker:t.lookAtMarker,lookAtEachOther:t.lookAtEachOther,setFacing:t.setFacing,shakeScreen:t.shakeScreen,setCharacterAt:t.setCharacterAt,walkToMarker:t.walkToMarker,walkToOffset:t.walkToOffset,setCharacterAtMarker:t.setCharacterAtMarker,changeTileAtMarker:t.changeTileAtMarker,spawnCharacterAtCharacter:t.spawnCharacterAtCharacter,spawnCharacterAtMarker:t.spawnCharacterAtMarker,despawnCharacter:t.despawnCharacter,fadeOut:t.fadeOut,fadeIn:t.fadeIn,changeRoom:t.changeRoom}})),define("controller/overworld-management",["require","exports","model/room","model/generics","model/overworld","model/character","controller/scene-management","controller/scene-commands","lib/rpgscript","controller/ui-actions","model/store","controller/events","db/overworlds"],(function(e,t,i,r,o,a,n,l,s,c,d,h,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateOverworld=t.overworldKeyHandler=t.initiateOverworld=void 0,t.initiateOverworld=(e,o,n)=>{let c=u.getRoom(o.roomName);c||console.error("Cannot initiate overworld, no room exists with name: ",o.roomName);let d=e.leader;i.roomAddCharacter(c,d);let p={room:c,triggersEnabled:!0,characterCollisionEnabled:!0,loadTriggerName:o.loadTriggerName};return r.setCurrentRoom(c),r.setCurrentPlayer(e),r.setCurrentOverworld(p),r.setRenderBackgroundColor(o.backgroundColor),n?a.characterSetPos(d,n):c.markers.MarkerPlayer?l.setCharacterAtMarker(d.name,"MarkerPlayer"):a.characterSetPos(d,[0,0,0]),h.pushKeyHandler(t.overworldKeyHandler),p.loadTriggerName&&m(p.loadTriggerName,s.TriggerType.ACTION),p};let m=async(e,t)=>{let i=r.getCurrentOverworld(),a=n.invokeTrigger(r.getCurrentScene(),e,t);null!==a&&(o.overworldDisableTriggers(i),r.disableKeyUpdate(),await a(),o.overworldEnableTriggers(i),r.enableKeyUpdate(),c.showSection(d.AppSection.Debug,!0))},p=async e=>{let t=r.getCurrentPlayer(),i=r.getCurrentRoom(),o=t.leader;for(let t=0;t<i.triggerActivators.length;t++){let l=i.triggerActivators[t];if(a.characterCollidesWithRect(o,[l.x,l.y,l.width,l.height])&&null!==n.invokeTrigger(r.getCurrentScene(),l.name,e))return e===s.TriggerType.ACTION&&a.characterSetAnimationState(o,a.AnimationState.IDLE),await m(l.name,e),!0}return!1};t.overworldKeyHandler=async e=>{let t=r.getCurrentOverworld();switch(e.key){case" ":t.triggersEnabled&&(await p(s.TriggerType.ACTION)||(async()=>{let e=r.getCurrentPlayer(),t=r.getCurrentRoom(),i=e.leader;for(let e=0;e<t.characters.length;e++){let r=t.characters[e],[o,n]=a.characterGetPosBottom(r);if(r.talkTrigger&&a.characterCollidesWithPoint(i,[o,n,25]))return await m(r.talkTrigger,s.TriggerType.ACTION),!0}})());break;case"c":r.getKeyUpdateEnabled()&&(r.disableKeyUpdate(),await n.callScript(r.getCurrentScene(),"test-vivi"),c.showSection(d.AppSection.Debug,!0),r.enableKeyUpdate())}},t.updateOverworld=e=>{let t=r.getCurrentPlayer().leader,i=!1,o=0,n=0;r.getKeyUpdateEnabled()&&(r.isKeyDown("ArrowLeft")?(i=!0,o-=1,n+=1):r.isKeyDown("ArrowRight")&&(i=!0,o+=1,n-=1),r.isKeyDown("ArrowUp")?(i=!0,o-=1,n-=1):r.isKeyDown("ArrowDown")&&(i=!0,o+=1,n+=1),a.characterSetAnimationState(t,i?a.AnimationState.WALK:a.AnimationState.IDLE),t.vx=o,t.vy=n),e.triggersEnabled&&p(s.TriggerType.STEP)}})),define("controller/loop",["require","exports","model/generics","view/draw","model/character","model/particle","view/ui","controller/battle-management","controller/overworld-management","controller/scene-management","model/player"],(function(e,t,i,r,o,a,n,l,s,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runMainLoop=t.unpause=t.pause=void 0,t.pause=()=>{if(i.getIsPaused())return;i.setIsPaused(!0),n.renderUi();let e=i.getCurrentRoom();e&&e.characters.forEach(e=>{e.transform&&e.transform.timer.pause()});let t=i.getCurrentBattle();t&&t.allies.concat(t.enemies).forEach(e=>{e.actionTimer.pause(),e.staggerTimer.pause(),e.castTimer.pause()})},t.unpause=()=>{if(!i.getIsPaused())return;i.setIsPaused(!1),n.renderUi();let e=i.getCurrentRoom();e&&e.characters.forEach(e=>{e.transform&&e.transform.timer.unpause()});let t=i.getCurrentBattle();t&&t.allies.concat(t.enemies).forEach(e=>{e.actionTimer.unpause(),e.staggerTimer.unpause(),e.castTimer.unpause()})},t.runMainLoop=async()=>{let e=performance.now(),t=e;window.running=!0;let n=e=>{let h=e-t,u=h/13;if(i.setFrameMultiplier(u>2?2:u),i.setDeltaT(h),t=e,i.setNow(e),i.getIsPaused())return void(window.running&&requestAnimationFrame(n));let m=i.getCurrentScene(),p=i.getCurrentBattle(),g=i.getCurrentOverworld(),f=i.getCurrentRoom();if(m&&c.updateScene(m),f){for(let e=0;e<f.tiles.length;e++)f.tiles[e].highlighted=!1;g&&s.updateOverworld(g),p&&l.updateBattle(p);for(let e=0;e<f.characters.length;e++)o.characterUpdate(f.characters[e]);for(let e=0;e<f.particles.length;e++)a.particleUpdate(f.particles[e]),f.particles[e].shouldRemove&&(f.particles.splice(e,1),e--);let e=0,t=0;if(p)e=240,t=50;else{let r=i.getCurrentPlayer();if(r){let[i,o]=d.playerGetCameraOffset(r);e=i,t=o}}r.drawRoom(f,[e,t])}let y=i.getRenderables();for(let e in y)(0,y[e])();window.running&&requestAnimationFrame(n)};n(e)}})),define("view/components/OverworldSection",["require","exports","preact","view/style","view/elements/Button","model/generics"],(function(e,t,r,o,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=i(a);let l=o.style("div",{position:"absolute",top:"0px"});t.default=()=>r.h(r.Fragment,null,r.h(l,null,r.h(a.default,{type:a.ButtonType.PRIMARY,onClick:()=>{n.getTriggersVisible()?(n.hideTriggers(),n.hideMarkers()):(n.showTriggers(),n.showMarkers())}},"Toggle Debug")))})),define("view/components/Debug",["require","exports","preact","view/style","view/components/OverworldSection"],(function(e,t,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r(a),o.style("div",()=>({position:"absolute",left:"0px",top:"0px"})),t.default=()=>i.h("div",{id:"debug"},i.h(a.default,null))})),define("view/components/BattleConclusion",["require","exports","preact","view/style"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let o=r.style("div",()=>({display:"flex",justifyContent:"center",alignItems:"center",height:"100%",fontSize:"4rem",color:r.colors.WHITE}));t.default=e=>i.h(o,null,i.h("span",null,e.isVictory?"VICTORY!":"DEFEATED!"))})),define("view/elements/AnimDiv",["require","exports","preact","preact/hooks","view/draw","model/animation"],(function(e,t,i,r,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>{let t=r.useRef(null),[n,l]=r.useState(a.createAnimation(e.animName)),s=e.width,c=e.height,d=e.scale,h=e.animName;return r.useEffect(()=>{let e=t.current;if(n.name!==h)l(a.createAnimation(h));else if(e){let[t,i]=n.getSpriteSize(0),r=null!=d?d:1;e.width=(null!=s?s:t)*r,e.height=(null!=c?c:i)*r;let a=e.getContext("2d");a.imageSmoothingEnabled=!1,a.clearRect(0,0,e.width,e.height),o.drawAnimation(n,0,0,r,a)}},[d,s,c,h,n]),i.h("div",null,i.h("canvas",{ref:t}))}})),define("view/hooks",["require","exports","preact/hooks","model/generics"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useInputEventStack=t.useRenderLoop=t.useReRender=t.initHooks=void 0,t.initHooks=()=>{window.addEventListener("keydown",e=>{let t=o[o.length-1];t&&t(e)})},t.useReRender=()=>{let[e,t]=i.useState(!1);return()=>{t(!e)}},t.useRenderLoop=(e,t)=>{let[,o]=i.useReducer(e=>!e,!1),a=()=>{o("")};return i.useEffect(()=>(r.addRenderable(e,t||a),()=>{r.removeRenderable(e)}),[]),a};let o=[];t.useInputEventStack=e=>{i.useEffect(()=>(o.push(e),()=>{let t=o.indexOf(e);t>-1&&o.splice(t,1)}),[])}})),define("view/elements/ProgressBar",["require","exports","preact","view/hooks","view/style"],(function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressBarWithRender=void 0;let a=o.style("div",e=>({background:e.backgroundColor,position:"relative",height:e.height+"px",width:"100%"})),n=o.style("div",e=>({background:e.backgroundColor,position:"absolute",left:"0",top:"0",width:e.pct+"%",height:"100%"})),l=o.style("div",{textAlign:"center",fontSize:"16px",position:"absolute",left:"0",top:"0",width:"100%",color:"white"}),s=e=>{var t;return i.h(a,{backgroundColor:e.backgroundColor,height:e.height},i.h(n,{pct:100*(null!==(t=e.pct)&&void 0!==t?t:0),backgroundColor:e.color}),i.h(l,null,e.label))};t.ProgressBarWithRender=e=>(r.useRenderLoop(e.renderKey),i.h(s,Object.assign({},e,{pct:e.renderFunc()}))),t.default=s})),define("view/components/BattleCharacterStatus",["require","exports","preact","view/style","view/elements/AnimDiv","view/elements/ProgressBar","model/character"],(function(e,t,i,o,a,n,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a=r(a);let s=o.colors.GREEN,c=o.colors.BLUE,d=o.style("div",e=>({display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",width:"64px",boxShadow:e.highlighted?"0px 0px 67px 21px rgba(255, 255, 255,0.75)":"unset"})),h=o.style("div",{background:"black",border:"2px solid "+o.colors.GREY,position:"relative"}),u=o.style("div",{position:"absolute",top:"0",left:"1px"}),m=o.style("div",e=>({border:e.omitBorder?"":"2px solid "+o.colors.WHITE,width:"100%",borderBottomLeftRadius:e.bottom?"4px":0,borderBottomRightRadius:e.bottom?"4px":0,borderTopLeftRadius:e.top?"4px":0,borderTopRightRadius:e.top?"4px":0}));t.default=e=>{let t=t=>`${e.bCh.ch.name}_${t}`,r=e.bCh.ch.skills[e.bCh.ch.skillIndex];return i.h(d,null,i.h(m,{top:!0},i.h(n.ProgressBarWithRender,{renderFunc:()=>e.bCh.actionTimer.getPctComplete(),renderKey:t("action"),backgroundColor:o.colors.BLACK,color:c,height:20,label:null==r?void 0:r.name})),i.h(h,null,i.h(a.default,{animName:"battlePortraits_"+e.bCh.ch.spriteBase}),i.h(u,null,e.bCh.ch.name)),i.h(m,{top:!0,omitBorder:!0},i.h(n.ProgressBarWithRender,{renderFunc:()=>e.bCh.isStaggered?1:e.bCh.staggerGauge.getPct(),renderKey:t("stagger"),backgroundColor:o.colors.BLACK,color:e.bCh.isStaggered?o.colors.WHITE:o.colors.ORANGE,height:4,label:""})),i.h(m,{bottom:!0},i.h(n.ProgressBarWithRender,{renderFunc:()=>l.characterGetHpPct(e.bCh.ch),renderKey:t("hp"),backgroundColor:o.colors.BLACK,color:s,height:20,label:"HP: "+e.bCh.ch.hp})))}})),define("view/components/BattleActionMenu",["require","exports","preact","view/elements/VerticalMenu","view/style"],(function(e,t,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r(o);let n=a.style("div",()=>({})),l=a.style("div",()=>({display:"flex",justifyContent:"space-between",alignItems:"center"})),s=a.style("div",()=>({width:"24px",height:"24px"}));t.default=e=>i.h(n,null,i.h(o.default,{title:"ACTION",open:!0,onClose:e.onClose,width:"8rem",items:e.bCh.ch.skills.map((e,t)=>({label:i.h(l,null,i.h("span",null,e.name),i.h(s,null,i.h(e.icon,{color:a.colors.WHITE}))),value:t})),onItemClick:t=>{e.bCh.ch.skillIndex=t,e.onClose()}}))})),define("view/components/BattleUISection",["require","exports","preact","preact/hooks","view/style","view/components/BattleCharacterStatus","view/components/BattleActionMenu","view/elements/Button","controller/ui-actions","controller/loop","model/generics"],(function(e,t,o,a,n,l,s,c,d,h,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),l=r(l),s=r(s),c=i(c);let m=n.style("div",{position:"absolute",bottom:"0px",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",width:"100%"}),p=n.style("div",{display:"flex",justifyContent:"center",alignItems:"center",width:"100%"}),g=n.style("div",{position:"absolute",bottom:"150px",width:"100%",display:"flex",justifyContent:"center"}),f=n.style("div",{margin:"16px"});t.default=()=>{let[e,t]=a.useState(!1),i=u.getCurrentBattle();return o.h(o.Fragment,null,e?null:o.h(g,null,o.h(c.default,{type:c.ButtonType.PRIMARY,onClick:()=>{t(!e),h.pause()}},"Don't Click Me")),o.h(m,null,o.h(p,null,i.allies.map(e=>o.h(f,null,o.h(l.default,{battle:i,bCh:e})))),e?o.h(s.default,{onClose:()=>{h.unpause(),d.battleSetChButtonsStatus(!0),t(!1)},open:e,bCh:i.allies[0]}):null))}})),define("view/components/CutsceneSection",["require","exports","preact","view/style","preact/hooks","view/elements/AnimDiv","view/ui","model/store"],(function(e,t,i,o,a,n,l,s){"use strict";var c;Object.defineProperty(t,"__esModule",{value:!0}),t.PortraitActiveState=void 0,n=r(n),function(e){e.Active="active",e.Inactive="inactive",e.Passive="passive",e.Invisible="invisible"}(c=t.PortraitActiveState||(t.PortraitActiveState={}));let d=(e,t,i)=>{let r="";return r=t?`${e}_portrait_${t}`:e+"_portrait","right"===i&&(r+="_f"),r},h=o.style("div",{position:"absolute",top:"0px",overflow:"hidden",width:"100%",height:"100%"}),u=o.style("div",e=>({position:"absolute",top:"0px",width:"100%",height:e.visible?"12.5%":"0%",transition:"height 0.25s",background:o.colors.DARKGREY})),m=o.style("div",e=>({position:"absolute",bottom:"0px",width:"100%",height:e.visible?"17%":"0%",transition:"height 0.25s",background:o.colors.DARKGREY})),p=o.style("div",e=>{let t="1",i="0%",r="0%",o="left 0.2s, right 0.2s, bottom 0.2s";return e.activeState===c.Active?i="3.125%":e.activeState===c.Inactive?(i="-3.125%",r="-3.125%",t="0.5"):e.activeState===c.Passive?r="-3.125%":e.activeState===c.Invisible&&(t="0",i="-50%",o=""),{position:"absolute",minWidth:"50%",minHeight:"50%",transition:o,left:"left"===e.align?i:"",right:"right"===e.align?i:"",bottom:r,opacity:t}}),g=o.style("div",e=>{let t="left"===e.align?"6.25%":"calc(100% - 6.25% - 50%)",i="20%",r="height 0.1s, left 0.1s, transform 0.25s ease-in";return"center"===e.align?(t="25%",i="75%",r="height 0.25s, left 0.25s, transform 0.25s ease-in"):"center-low"===e.align?(t="25%",i="35%"):e.visible||(r=""),{position:"absolute",width:"50%",height:i,left:t,display:"flex",justifyContent:"center",alignItems:"center",transition:r,bottom:"0px",transform:e.visible?"scale(1)":"scale(0)"}}),f=o.style("div",e=>{let t="unset",i="unset",r="solid",a="solid",n="2.5%",l="2.5%",s=o.colors.WHITE,c=o.colors.WHITE;return"right"===e.align?(n="5%",t="48px",r="16px solid",c=o.colors.BLUE):"left"===e.align&&(l="5%",i="48px",a="16px solid",s=o.colors.BLUE),{border:"2px solid "+o.colors.WHITE,background:o.colors.BLACK,boxShadow:"0px 0px 24px 16px rgba(0, 0, 0, 0.75)",boxSizing:"border-box",width:"100%",padding:"2.5%",color:o.colors.WHITE,fontSize:"24px",textAlign:"left",transition:"height 0.25s, width 0.25s",borderBottomLeftRadius:t,borderBottomRightRadius:i,borderLeft:r,borderRight:a,paddingLeft:n,paddingRight:l,borderRightColor:s,borderLeftColor:c,borderTopColor:o.colors.BLUE}}),y=o.style("div",e=>({position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%",transform:e.visible?"translateY(0%)":"translateY(55%)",transition:"transform 0.15s"}));t.default=()=>{let[e,t]=a.useState(!1),r=a.useRef(null);a.useEffect(()=>{t(!0)},[]),a.useEffect(()=>{let e=null==r?void 0:r.current;e&&(e.style.transition="",e.style.opacity="0",e.innerHTML=o.text,setTimeout(()=>{e.style.transition="opacity 0.15s linear",e.style.opacity="1"},25))});let o=l.getUiInterface().appState.cutscene,w="center";return[s.CutsceneSpeaker.Left].includes(o.speaker)||[s.CutsceneSpeaker.Center].includes(o.speaker)?w="right":[s.CutsceneSpeaker.Right].includes(o.speaker)?w="left":o.portraitCenter&&(w="center-low"),i.h(h,null,i.h(u,{visible:o.visible&&e}),i.h(m,{visible:o.visible&&e}),i.h(y,{visible:o.visible&&e},""!==o.portraitLeft?i.h(p,{align:"left",activeState:o.speaker===s.CutsceneSpeaker.Left?c.Active:c.Inactive},i.h(n.default,{animName:d(o.portraitLeft,o.portraitLeftEmotion,"right")})):null,""!==o.portraitCenter?i.h(p,{align:"left",activeState:o.speaker===s.CutsceneSpeaker.Center?c.Active:c.Invisible},i.h(n.default,{animName:d(o.portraitCenter,o.portraitCenterEmotion,"right")})):null,""!==o.portraitRight?i.h(p,{align:"right",activeState:o.speaker===s.CutsceneSpeaker.Right?c.Active:c.Inactive},i.h(n.default,{animName:d(o.portraitRight,o.portraitRightEmotion,"left")})):null),i.h(g,{visible:e&&o.text.length>0,align:w},i.h(f,{align:w},i.h("span",{style:{opacity:"0",transition:"unset"},ref:r}))))}})),define("view/ui",["require","exports","preact","preact/hooks","view/style","model/generics","model/store","controller/ui-actions","model/canvas","view/components/Debug","view/components/BattleConclusion","view/components/BattleUISection","view/components/CutsceneSection","model/store"],(function(e,t,i,o,a,n,l,s,c,d,h,u,m,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mountUi=t.renderUi=t.getUiInterface=t.uiInterface=void 0,d=r(d),h=r(h),u=r(u),m=r(m);let g=a.style("div",{position:"relative",height:"100%"}),f=a.style("div",()=>({position:"absolute",left:"0",top:"0",background:"black",opacity:"0.3",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:a.colors.WHITE,fontSize:"24px",width:"100%",height:"100%",pointerEvents:"none"})),y=a.style("div",()=>({marginBottom:"256px"}));t.uiInterface=null,t.getUiInterface=()=>t.uiInterface;let w=()=>{let[e,r]=o.useState(!1),[a,w]=o.useReducer(s.appReducer,l.AppStateInitial);o.useEffect(()=>{t.uiInterface=window.uiInterface={appState:a,render:()=>{r(!e)},dispatch:w}});let _=c.getDrawScale();return i.h("div",{style:{position:"absolute",top:"0px",width:512*(_>2?2:_),height:512*(_>2?2:_)}},i.h(g,null,n.getIsPaused()?i.h(f,null,i.h(y,null,"PAUSED")):null,a.sections.map((e,t)=>{switch(e){case p.AppSection.BattleVictory:return i.h(h.default,{key:t,isVictory:!0});case p.AppSection.BattleDefeated:return i.h(h.default,{key:t,isVictory:!1});case p.AppSection.BattleUI:return i.h(u.default,{key:t});case p.AppSection.Cutscene:return i.h(m.default,{key:t});case p.AppSection.Debug:return i.h(d.default,null);default:return i.h("div",null)}})))};t.renderUi=()=>{t.uiInterface&&t.uiInterface.render()},t.mountUi=()=>{let e=document.getElementById("ui");e&&i.render(i.h(w,null),e)}})),define("controller/scene-management",["require","exports","lib/rpgscript","model/scene","controller/scene-commands"],(function(e,t,i,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSceneCommands=t.createAndCallScript=t.callScript=t.invokeTrigger=t.evalCondition=t.updateScene=void 0,a=r(a),t.updateScene=e=>{if(e.currentScript&&!o.sceneIsWaiting(e)){let i=null;for(;null!==(i=e.currentScript.getNextCommand());)if(t.evalCondition(e,i.conditional)){let t=o.sceneGetCommands(e)[i.type];if(!t)throw Error(`Script runtime error.  No command exists with name '${i.type}'`);if(t(...i.args))break}if(null===i)if(e.onScriptCompleted&&e.onScriptCompleted(),e.scriptStack.length){let i=e.scriptStack.shift();if(i){let{script:r,onScriptCompleted:o}=i;e.currentScript=r,e.onScriptCompleted=o,setTimeout(()=>t.updateScene(e))}}else e.currentScript=null,e.currentTrigger=null}},t.evalCondition=(e,r)=>{var o;if(!0===r)return!0;if("object"==typeof r){let{type:a,args:n}=r,l=i.formatArgs(n).map(t=>{if("object"==typeof t)return t;if("scene"===t&&e.currentTrigger)return e.storage[e.currentTrigger.name];if("string"==typeof t&&t.indexOf(".")>-1){let[i,r]=t.split(".");return"storage"===i?e.storage[r]:e.storage[i]?e.storage[i][r]:(console.error("No storage in scene called:",i),!1)}return t});if("is"===a)return!!l[0];if("isnot"===a)return"object"==typeof l[0]?!t.evalCondition(e,l[0]):!l[0];if("gt"===a)return l[0]>l[1];if("lt"===a)return l[0]<l[1];if("eq"===a)return l[0]===l[1];if("any"===a){for(let i=0;i<l.length;i++)if(t.evalCondition(e,l[i]))return!0;return!1}if("all"===a){for(let i=0;i<l.length;i++)if(!t.evalCondition(e,l[i]))return!1;return!0}if("as"===a)return console.error('conditional "as" is not defined for this scene.'),!1;if("once"===a){let t=l[0]||(null===(o=e.currentScript||e.currentTrigger)||void 0===o?void 0:o.name)+"-once";return!e.storageOnceKeys[t]&&(e.storageOnceKeys[t]=!0,!0)}return"with"===a&&(console.error('conditional "with" is not defined for this scene.'),!1)}},t.invokeTrigger=(e,r,o)=>{let a=i.getTrigger(r);if(!e.currentScript&&a)for(let i=0;i<a.scriptCalls.length;i++){let r=a.scriptCalls[i];e.currentTrigger=a;let n=t.evalCondition(e,r.condition);if(r.type===o&&n)return async()=>{await t.callScript(e,r.scriptName),e.storage[a.name]=!0};e.currentTrigger=null}return null},t.callScript=async(e,r)=>new Promise(o=>{let a=i.getScript(r);a.reset(),e.currentScript&&e.scriptStack.unshift({script:e.currentScript,onScriptCompleted:e.onScriptCompleted}),e.currentScript=a,e.onScriptCompleted=o,t.updateScene(e)}),t.createAndCallScript=(e,t)=>{let r=e.commands,o=new i.Script(t,"internal",-1);o.addCommandBlock().commands=r.slice(),o.reset(),e.currentScript&&e.scriptStack.unshift({script:e.currentScript,onScriptCompleted:function(){}}),e.currentScript=o},t.getSceneCommands=e=>a.default})),define("model/scene",["require","exports","controller/scene-management","model/generics"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sceneGetCommands=t.sceneHasCommand=t.sceneIsWaiting=t.initScene=t.sceneCreate=void 0,t.sceneCreate=()=>{let e={storage:{},storageOnce:{},storageOnceKeys:{},commands:{},currentScript:null,currentTrigger:null,scriptStack:[],isWaitingForInput:!1,isWaitingForTime:!1,isWaitingForAnimation:!1,waitTimeoutId:-1};return Object.assign(e.commands,i.getSceneCommands(e)),e},t.initScene=()=>{r.setCurrentScene(t.sceneCreate())},t.sceneIsWaiting=e=>e.isWaitingForInput||e.isWaitingForTime||e.isWaitingForAnimation,t.sceneHasCommand=(e,i)=>!!t.sceneGetCommands(e)[i],t.sceneGetCommands=e=>e.commands})),define("lib/rpgscript",["require","exports","model/scene"],(function(e,t,i){"use strict";function r(e){return function(e){return e.map(e=>'"'===e[0]||"'"===e[0]?e.slice(1,-1):e)}(e).map(e=>isNaN(parseFloat(e))?e:parseFloat(e))}var o;Object.defineProperty(t,"__esModule",{value:!0}),t.getTrigger=t.getScript=t.loadRPGScript=t.ScriptParser=t.Script=t.Trigger=t.TriggerType=t.formatArgs=void 0,t.formatArgs=r,(o=t.TriggerType||(t.TriggerType={})).STEP="step",o.ACTION="action";class a{constructor(e,t,i){this.name=e,this.filename=t,this.lineNum=i,this.scriptCalls=[]}addScriptCall(e,t,i){this.scriptCalls.push({type:e,condition:t,scriptName:i})}}t.Trigger=a;class n{constructor(e,t,i){this.name=e,this.filename=t,this.lineNum=i,this.blocks=[],this.soundNameStorage={},this.currentBlockIndex=0,this.currentCommandIndex=0,this.sounds=0,this.soundsPerCharacter={}}reset(){this.currentBlockIndex=0,this.currentCommandIndex=0}isValid(e){if(!e)return!0;for(let t=0;t<this.blocks.length;t++){let r=this.blocks[t];for(let t=0;t<r.commands.length;t++){let o=r.commands[t];if(!i.sceneHasCommand(e,o.type))return`Error in script "${this.name}"\n\nNo command exists with name "${o.type}" and args "${o.args.join(",")}" `}}return!0}getNextCommand(){let e=this.blocks[this.currentBlockIndex];if(e){let t=e.commands[this.currentCommandIndex];return t?(this.currentCommandIndex++,{args:t.args,type:t.type,conditional:e.conditional}):(this.currentBlockIndex++,this.currentCommandIndex=0,this.getNextCommand())}return null}getNextDialog(e){this.soundsPerCharacter[e]?this.soundsPerCharacter[e]++:this.soundsPerCharacter[e]=1;let t=this.soundsPerCharacter[e];t<10&&(t="0"+t);let i=this.name+"/"+this.sounds,r=this.name+"/"+e+"-"+t;return this.sounds++,{soundNameIndexed:i,soundNameCh:r}}addCommandBlock(){let e={conditional:!0,commands:[]};return this.blocks.push(e),e}}t.Script=n;class l{constructor(e){this.name=e,this.soundsToLoad=[]}throwParsingError(e,t,i){throw console.error(`{Line ${t}} Script parsing error ${this.name}: ${e} CONTENTS [\n"${i}"\n]`),Error("Parsing error")}parseCommand(e,t,i){let o=(e=e.trim()).indexOf("("),a=e.lastIndexOf(")");if(e.match(/^(\w)+:/)&&i)return this.createDialogCommand(e,i);-1!==o&&0!==o||this.throwParsingError("Invalid command, no name provided",t,e),-1!==a&&0!==a||this.throwParsingError("Invalid command, no end parens",t,e);let n=e.substr(o+1,e.length-(o+1)-(e.length-a));return n=function(e,t){let i=[],r="",o="",a=!1;for(let t=0;t<e.length;t++){let n=e[t];o?n===o&&(o="",a=!1):'"'===n||"'"===n?(o=n,a=!0):"("===n?a=!0:")"===n&&(a=!1),a||","!==e[t]?r+=n:(i.push(r),r="")}return r&&i.push(r),i}(n).map(e=>e.trim()),n.forEach(i=>{"'"===i[0]?"'"!==i[i.length-1]&&this.throwParsingError('Invalid command, unterminated single quote "\'"',t,e):'"'===i[0]&&'"'!==i[i.length-1]&&this.throwParsingError("Invalid command, unterminated double quote '\"'",t,e)}),{type:e.substr(0,o),args:r(n)}}parseConditional(e,t,i){let{type:r,args:o}=this.parseCommand(e,t,i);return["is","isnot","gt","lt","eq","any","all","as","once","with"].includes(r)||this.throwParsingError(`Invalid conditional, no type named "${r}"`,t,e),{type:r,args:o.map(e=>"string"==typeof e&&-1!==e.indexOf("(")?this.parseCommand(e,t,i):e)}}combineConditionals(e,t,i){return{type:i,args:[e,t]}}getConditionalFromLine(e,t,i){let r=function(e,t){let i="",r=!1;for(let t=0;t<e.length;t++){let o=e[t];if(i?o===i&&(i="",r=!1):'"'===o||"'"===o?(i=o,r=!0):"("===o?r=!0:")"===o&&(r=!1),!r&&"?"===e[t])return t}return-1}(e);if(r>-1){let o=e.indexOf(":");-1===o&&this.throwParsingError("Invalid conditional, no ending ':'",t,e);let a=e.slice(r+1,o);return{conditional:this.parseConditional(a.trim(),t,i),endIndex:o+1}}return{conditional:!0,endIndex:0}}createDialogCommand(e,t){let[i,o]=e.split(":"),a="playDialogue";"_"===i[0]&&(i=i.slice(1),a="playDialogueInterruptable"),o=o.trim();let{soundNameCh:n,soundNameIndexed:l}=t.getNextDialog(i);return this.soundsToLoad.push({soundNameCh:n,soundNameIndexed:l}),{type:a,args:r([i,o,n])}}parse(e,t){let i={},r={},o=!1,l=!1,s=!1,c=null,d=null,h=null,u=null,m=e.split("\n");if(m.forEach((e,m)=>{if(m+=1,0===(e=e.trim()).length)return;if("/"===e[0]&&"/"===e[1])return;let p=e[0];if("{"===p)o=!0;else if("}"===p)o=!1,c=null;else if("@"!==p||o){if("$"===p)s=!0,l=!1,d&&(c=d.addCommandBlock(),c.conditional=!0,c.commands.push({type:"showChoices",args:[]}));else if("#"===p)l=!0,s=!1,u=e.substr(1),h=new a(e.substr(1),this.name,m),((e,t)=>{i[e]=t})(e.substr(1),h);else if("+"===p||o){let t=e.substr(o?0:1);if(d){let{conditional:e,endIndex:i}=this.getConditionalFromLine(t,m,d);if("object"==typeof e){if("{"===t[i])return o=!0,c=d.addCommandBlock(),void(c.conditional=e);if(i===t.length)return c=d.addCommandBlock(),void(c.conditional=e)}let r=t.substr(i);"+"===r[0]&&(r=r.slice(1));let{type:a,args:n}=this.parseCommand(r,m,d),l=null;o?(null===c&&(c=d.addCommandBlock(),c.conditional=e),l=c):(l=c=d.addCommandBlock(),l.conditional=e),l.commands.push({type:a,args:n})}}else if(s){let t=e.indexOf(":");-1===t&&this.throwParsingError("Invalid choice definition, no colon '\"'",m,e);let i=e.substr(0,t),r=e.substr(t+1);c&&c.commands[0].args.push({text:i,target:r})}else if(l){let t=e.indexOf(",");-1===t&&this.throwParsingError("Invalid trigger script call, invalid number of arguments",m,e);let i=e.substr(0,t),r=e.substr(t+1),o=null;"item"===i&&(o={type:"with",args:[r.slice(0,r.indexOf(","))]},r=r.slice(r.indexOf(",")+1));let{conditional:a,endIndex:n}=this.getConditionalFromLine(r,m,d),l=a;o&&(l=this.combineConditionals(o,a,"and"));let s=r.substr(n);"this"===s&&u&&(s=u),h&&h.addScriptCall(i,l,s)}else if(">"===p)c&&c.commands.push({type:"callScript",args:[e.substr(1)]});else if(l=!1,d){let t=d.addCommandBlock(),i=this.createDialogCommand(e,d);t.commands.push(i)}}else{let i=e.substr(1,e.length-1);if("this"===i&&(i=u||""),0===i.length&&this.throwParsingError("Invalid script name",m,e),d){let e=d.isValid(t);!0!==e&&this.throwParsingError(e,m-1,"")}d=new n(i,this.name,m),r[i]=d,l=!1,s=!1}}),d){let e=d.isValid(t);!0!==e&&this.throwParsingError(e,m.length,m[m.length-1])}return{triggers:i,scripts:r}}}t.ScriptParser=l;let s=window.scripts={},c=window.triggers={};t.loadRPGScript=async(e,t)=>{let i=`res/rpgscript/${e}.rpgscript`,r=await(await fetch(i)).text(),o=new l(e),{triggers:a,scripts:n}=o.parse(r,t);Object.assign(s,n),Object.assign(c,a)},t.getScript=e=>{let t=s[e];if(!t)throw Error("Cannot get script with name "+e);return t},t.getTrigger=e=>{let t=c[e];if(!t)throw Error("Cannot get trigger with name "+e);return t}})),define("model/overworld",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overworldCharacterCreate=t.overworldEnableTriggers=t.overworldDisableTriggers=void 0,t.overworldDisableTriggers=e=>{e.triggersEnabled=!1},t.overworldEnableTriggers=e=>{e.triggersEnabled=!0},t.overworldCharacterCreate=e=>({ch:e.ch})})),define("map/battle1",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"battle1.json"}},height:16,infinite:!1,layers:[{data:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],height:16,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:16,x:0,y:0},{draworder:"topdown",id:5,name:"Props",objects:[{gid:17,height:64,id:4,name:"",rotation:0,type:"",visible:!0,width:32,x:32,y:96},{gid:17,height:64,id:7,name:"",rotation:0,type:"",visible:!0,width:32,x:224,y:240},{gid:17,height:64,id:8,name:"",rotation:0,type:"",visible:!0,width:32,x:64,y:32},{gid:18,height:32,id:9,name:"1",rotation:0,type:"",visible:!0,width:32,x:96,y:128},{gid:18,height:32,id:10,name:"3",rotation:0,type:"",visible:!0,width:32,x:80,y:240},{gid:18,height:32,id:11,name:"4",rotation:0,type:"",visible:!0,width:32,x:64,y:160},{gid:18,height:32,id:12,name:"2",rotation:0,type:"",visible:!0,width:32,x:144,y:176},{gid:19,height:32,id:13,name:"2",rotation:0,type:"",visible:!0,width:32,x:160,y:64},{gid:19,height:32,id:14,name:"4",rotation:0,type:"",visible:!0,width:32,x:192,y:32},{gid:19,height:32,id:15,name:"1",rotation:0,type:"",visible:!0,width:32,x:176,y:144},{gid:19,height:32,id:16,name:"3",rotation:0,type:"",visible:!0,width:32,x:128,y:96},{gid:18,height:32,id:24,name:"4",rotation:0,type:"",visible:!0,width:32,x:112,y:208},{gid:18,height:32,id:25,name:"3",rotation:0,type:"",visible:!0,width:32,x:32,y:192},{gid:19,height:32,id:26,name:"2",rotation:0,type:"",visible:!0,width:32,x:208,y:112},{gid:19,height:32,id:27,name:"4",rotation:0,type:"",visible:!0,width:32,x:240,y:80}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:7,nextobjectid:28,orientation:"isometric",renderorder:"left-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:4,firstgid:1,image:"../../res/battle-terrain1.png",imageheight:128,imagewidth:128,margin:0,name:"battle-terrain1",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:0,firstgid:17,grid:{height:1,orientation:"orthogonal",width:1},margin:0,name:"props-dynamic",spacing:0,tilecount:4,tileheight:64,tiles:[{id:0,image:"../../res/tree1.png",imageheight:64,imagewidth:32},{id:1,image:"../../res/markerGreen.png",imageheight:32,imagewidth:32},{id:2,image:"../../res/markerOrange.png",imageheight:32,imagewidth:32},{id:3,image:"../../res/test-prop.png",imageheight:32,imagewidth:96}],tilewidth:96}],tilewidth:32,type:"map",version:1.4,width:16}),define("map/test",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"test.json"}},height:64,infinite:!1,layers:[{data:[129,2,2,11,2,2,2,13,2,2,2,11,2,2,2,2,2,5,5,5,5,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,12,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,8,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,6,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,6,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,10,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,5,5,5,5,5,5,5,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129],height:64,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:64,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:193,height:32,id:1,name:"Skye",rotation:0,type:"",visible:!0,width:32,x:288,y:112}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:4,nextobjectid:3,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:2,firstgid:193,image:"../../res/control.png",imageheight:64,imagewidth:64,margin:0,name:"control",spacing:0,tilecount:4,tileheight:32,tilewidth:32},{columns:16,firstgid:197,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:64}),define("map/test2",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"test2.json"}},height:40,infinite:!1,layers:[{data:[130,2,2,11,2,2,2,13,2,2,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,2,2,2,2,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,12,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,8,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,6,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,6,130,130,130,130,130,130,130,130,16,16,16,16,16,16,16,16,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,10,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,1,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,215,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,209,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,2,2,2,2,2,2,15,15,2,2,2,2,2,2,2,3,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,16,130,130,16,129,129,129,129,129,129,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,16,130,130,16,129,129,129,129,129,129,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,129,129,129,129,129,16,130,130,16,129,129,129,129,129,129,1,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,2,2,2,2,2,16,15,15,16,2,2,2,2,2,2,3,129,129,129,4,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,2,2,2,2,2,2,16,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,16,2,2,2,5,5,5,5,5,5,5,5,5,5,5,2,2,3,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129],height:40,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:40,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:193,height:32,id:3,name:"Skye",rotation:0,type:"",visible:!0,width:32,x:44,y:248},{gid:194,height:32,id:5,name:"MarkerWalkTest1",rotation:0,type:"",visible:!0,width:32,x:76,y:72},{gid:194,height:32,id:6,name:"MarkerWalkTest2",rotation:0,type:"",visible:!0,width:32,x:76,y:276},{gid:195,height:32,id:9,name:"#floor1-vendingPanel",rotation:0,type:"",visible:!0,width:32,x:28,y:268},{height:44,id:11,name:"#floor1-vendingPanel",rotation:0,type:"",visible:!0,width:140,x:12,y:152},{gid:193,height:32,id:18,name:"Roger",rotation:0,type:"",visible:!0,width:32,x:97.25,y:35.75},{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:392,y:160},{height:64,id:20,name:"#floor1-openDoorA",rotation:0,type:"",visible:!0,width:32,x:428,y:280},{height:60,id:21,name:"#floor1-openDoorB",rotation:0,type:"",visible:!0,width:32,x:428,y:220},{gid:194,height:32,id:22,name:"markerDoorA",rotation:0,type:"",visible:!0,width:32,x:436,y:308},{gid:194,height:32,id:23,name:"markerDoorB",rotation:0,type:"",visible:!0,width:32,x:436,y:244},{height:164,id:26,name:"#floor1-closeDoorsAB",rotation:0,type:"",visible:!0,width:64,x:412,y:200},{gid:194,height:32,id:29,name:"MarkerSpawnAtMarker",rotation:0,type:"",visible:!0,width:32,x:440.375,y:41.125},{gid:193,height:32,id:33,name:"Rho",rotation:0,type:"",visible:!0,width:32,x:465.75,y:103.75},{gid:193,height:32,id:35,name:"Sigma",rotation:0,type:"",visible:!0,width:32,x:554.5,y:37},{height:0,id:44,name:"",rotation:0,type:"",visible:!0,width:0,x:459.625,y:232.875},{height:0,id:45,name:"",rotation:0,type:"",visible:!0,width:0,x:473.25,y:218.75},{height:0,id:46,name:"",rotation:0,type:"",visible:!0,width:0,x:476.75,y:221.75},{height:0,id:47,name:"",rotation:0,type:"",visible:!0,width:0,x:459.375,y:220.625},{height:100,id:52,name:"#rho-look-area",rotation:0,type:"",visible:!0,width:100,x:415.875,y:55.125}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:53,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:40}),define("map/floor1-outside",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor1-outside.json"}},height:32,infinite:!1,layers:[{data:[337,338,337,338,337,337,337,337,337,337,337,337,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,17,16,16,338,337,338,337,338,337,337,337,337,337,337,337,358,357,357,357,357,357,357,357,357,357,358,337,337,338,33,132,132,17,16,16,337,338,337,338,337,337,337,337,337,337,337,337,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,17,16,16,338,337,338,337,338,337,337,337,337,337,337,337,358,357,357,357,357,357,357,357,357,357,358,337,337,338,33,132,132,17,16,16,337,338,337,338,337,338,337,337,337,337,337,337,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,17,16,16,338,337,338,337,338,337,338,337,337,337,337,358,358,357,357,357,357,357,357,357,357,357,358,337,337,338,33,132,132,16,16,16,337,338,337,338,337,338,337,337,337,337,337,358,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,16,16,16,338,337,338,337,338,337,338,337,337,337,337,358,358,357,357,357,357,357,357,357,357,357,358,337,337,338,33,132,132,16,16,16,337,338,337,338,337,338,337,338,337,337,337,337,358,358,357,357,357,357,357,357,357,358,358,337,338,33,33,33,132,16,16,16,338,337,338,337,338,337,338,337,338,337,337,337,358,357,358,357,358,357,358,357,358,357,358,337,337,338,33,132,132,16,16,16,337,338,337,338,337,338,337,338,337,338,337,358,358,358,358,358,358,358,358,358,358,358,358,337,338,33,33,33,132,16,16,16,338,337,338,337,338,337,338,337,338,337,337,338,339,339,338,339,339,338,339,339,338,339,338,337,337,338,33,132,132,16,16,16,131,33,131,33,131,33,131,33,131,33,131,131,131,131,131,131,131,131,131,131,131,131,131,33,131,33,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,136,136,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,136,136,131,131,131,131,131,131,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,133,131,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,133,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,134,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,131,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,132,131,131,131,131,131,131,131,131,131,132,132,132,132,132,132,132,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,132,132,132,132,132,132,132,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131,131],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:216,y:240},{gid:356,height:108,id:45,name:"",rotation:0,type:"front",visible:!0,width:177,x:260,y:180},{gid:353,height:64,id:46,name:"",rotation:0,type:"",visible:!0,width:32,x:396,y:248},{gid:353,height:64,id:47,name:"",rotation:0,type:"",visible:!0,width:32,x:44,y:248}],offsetx:4,offsety:4,opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:48,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:337,image:"../../res/walls128.png",imageheight:256,imagewidth:256,margin:0,name:"walls128",spacing:0,tilecount:16,tileheight:128,tilewidth:32},{firstgid:353,source:"../../res/props-dynamic.tiled-sheet.tsx"},{columns:8,firstgid:357,image:"../../res/walls256.png",imageheight:256,imagewidth:256,margin:0,name:"walls256",spacing:0,tilecount:8,tileheight:256,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor1-atrium",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor1-atrium.json"}},height:32,infinite:!1,layers:[{data:[129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,16,130,130,16,129,129,129,129,129,129,129,129,129,16,16,16,16,16,16,16,16,2,2,2,2,2,2,2,2,2,2,2,16,15,15,16,2,2,16,16,16,16,16,16,129,16,130,130,16,130,130,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,130,1,129,16,130,130,16,7,7,9,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,130,1,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,130,1,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,130,1,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,130,1,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,16,16,16,16,16,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,1,2,2,2,130,130,130,130,2,2,2,2,130,130,130,130,130,2,2,2,130,130,2,2,3,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,16,130,130,16,130,1,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,1,2,2,2,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,3,129,129,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,1,130,130,130,130,1,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,129,129,16,2,2,2,2,2,2,2,3,130,130,130,130,1,2,2,2,2,2,2,2,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,130,130,130,130,130,130,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,130,130,130,130,130,130,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,130,130,130,130,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:152,y:124},{gid:198,height:32,id:41,name:"MarkerDoorA",rotation:0,type:"",visible:!0,width:32,x:100,y:92},{gid:200,height:32,id:42,name:"MarkerDoorB",rotation:0,type:"",visible:!0,width:32,x:244,y:412},{gid:198,height:32,id:43,name:"MarkerDoorC",rotation:0,type:"",visible:!0,width:32,x:356,y:64}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:44,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor1-bowlingalley",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor1-bowlingalley.json"}},height:16,infinite:!1,layers:[{data:[16,2,2,2,2,2,2,2,2,2,2,2,2,2,2,16,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,16,17,17,17,17,17,17,17,17,17,17,17,130,130,130,17],height:16,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:16,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:204,y:156},{gid:200,height:32,id:43,name:"MarkerDoorA",rotation:0,type:"",visible:!0,width:32,x:216,y:228}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:44,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:16}),define("map/floor2-entrance",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor2-entrance.json"}},height:32,infinite:!1,layers:[{data:[2,2,2,2,2,2,2,2,2,2,2,129,129,129,129,129,129,129,129,2,2,2,2,2,2,2,2,2,2,2,2,2,16,130,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,16,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,16,129,129,16,130,130,16,129,129,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,16,129,129,16,130,130,16,129,129,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,16,129,129,16,130,130,16,129,129,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,16,129,129,16,129,130,16,129,129,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,16,129,129,16,129,129,16,129,129,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,16,16,16,16,15,15,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,16,130,130,130,130,130,130,130,130,16,130,130,130,130,130,130,130,130,16,130,130,130,130,130,130,130,130,130,130,130,14,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,14,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,16,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,16,130,130,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,16,7,7,9,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,16,2,2,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,2,2,3,129,129,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,16,129,129,129,129,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,16,129,129,129,129,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,16,129,129,129,129,16,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,16,129,129],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:264,y:416},{gid:198,height:32,id:41,name:"MarkerDoorElevatorDown",rotation:0,type:"",visible:!0,width:32,x:152,y:424},{gid:198,height:32,id:43,name:"MarkerDoorCafeteria",rotation:0,type:"",visible:!0,width:32,x:248,y:200},{gid:199,height:32,id:45,name:"MarkerDoorB",rotation:0,type:"",visible:!0,width:32,x:476,y:260}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:46,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor2-cafeteria",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor2-cafeteria.json"}},height:32,infinite:!1,layers:[{data:[129,129,129,2,2,2,2,2,2,2,130,130,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,129,129,129,129,129,129,129,129,16,130,130,130,130,130,16,130,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,16,130,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,16,130,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,16,130,130,16,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,16,15,15,16,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,12,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,10,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,1,129,129,129,129,129,129,129,129,1,130,130,130,130,130,2,15,15,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,129,129,129,129,129,129,129,129,1,17,17,17,17,17,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,16,129,129,129,129,129,129,129,129,1,130,130,130,130,130,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,16,129,129,129,129,129,129,129,129,1,130,130,130,130,130,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,16,129,129,129,129,129,129,129,129,1,130,130,130,130,130,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,16,129,129,129,129,129,129,129,129,1,17,17,17,17,17,16,130,130,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,129,129,129,129,129],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:256,y:280},{gid:198,height:32,id:43,name:"MarkerDoorNorth",rotation:0,type:"",visible:!0,width:32,x:184,y:128},{gid:200,height:32,id:46,name:"MarkerDoorSouth",rotation:0,type:"",visible:!0,width:32,x:184,y:396}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:47,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor2-north",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor2-north.json"}},height:32,infinite:!1,layers:[{data:[1,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,15,15,16,16,16,16,16,16,1,210,130,130,130,130,130,16,130,130,130,16,130,130,130,16,130,130,130,16,130,130,130,16,130,130,16,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,210,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,209,130,130,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,17,17,17,17,17,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,17,130,130,130,17,130,130,130,130,130,130,130,130,130,130,130,130,17,130,130,130,130,17,1,130,130,130,130,130,130,17,130,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,17,1,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,210,210,210,210,210,210,17,1,2,15,15,2,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,1,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,1,16,130,130,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,16,16,130,130,16,16,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129,129],height:32,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:104,y:356},{gid:198,height:32,id:43,name:"MarkerDoorPrepRoom",rotation:0,type:"",visible:!0,width:32,x:408,y:48},{gid:200,height:32,id:46,name:"MarkerDoorCafeteria",rotation:0,type:"",visible:!0,width:32,x:56,y:396}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:47,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:32}),define("map/floor2-preproom",[],{compressionlevel:-1,editorsettings:{export:{format:"json",target:"floor2-preproom.json"}},height:21,infinite:!1,layers:[{data:[17,16,17,16,17,16,17,16,17,16,17,16,17,16,17,16,17,16,17,16,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,16,16,130,130,16,130,130,130,130,130,16,130,130,16,16,16,16,16,17,16,16,16,16,130,130,16,7,7,9,7,7,16,130,130,16,16,16,16,17,16,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,16,17,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,17,16,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,16,17,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,17,16,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,16,17,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,17,16,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,16,17,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,17,16,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,16,17,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,17,16,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,16,17,16,16,16,16,130,130,130,130,130,130,130,130,130,130,130,16,16,16,16,17,16,17,16,17,16,17,17,17,17,15,15,17,17,17,17,17,16,17,16,17,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],height:21,id:1,name:"Tiles",opacity:1,type:"tilelayer",visible:!0,width:21,x:0,y:0},{draworder:"topdown",id:2,name:"Objects",objects:[{gid:194,height:32,id:19,name:"MarkerPlayer",rotation:0,type:"",visible:!0,width:32,x:164,y:208},{gid:200,height:32,id:47,name:"MarkerDoorNorthRoom",rotation:0,type:"",visible:!0,width:32,x:164,y:292}],opacity:1,type:"objectgroup",visible:!0,x:0,y:0}],nextlayerid:6,nextobjectid:48,orientation:"isometric",renderorder:"right-down",tiledversion:"1.4.3",tileheight:16,tilesets:[{columns:16,firstgid:1,image:"../../res/walls.png",imageheight:512,imagewidth:512,margin:0,name:"walls",spacing:0,tilecount:128,tileheight:64,tilewidth:32},{columns:8,firstgid:129,image:"../../res/floors.png",imageheight:256,imagewidth:256,margin:0,name:"floors",spacing:0,tilecount:64,tileheight:32,tilewidth:32},{columns:4,firstgid:193,image:"../../res/control.png",imageheight:128,imagewidth:128,margin:0,name:"control",spacing:0,tilecount:16,tileheight:32,tilewidth:32},{columns:16,firstgid:209,image:"../../res/props.png",imageheight:512,imagewidth:512,margin:0,name:"props",spacing:0,tilecount:128,tileheight:64,tilewidth:32}],tilewidth:32,type:"map",version:1.4,width:21}),define("db/overworlds",["require","exports","model/room","view/style","map/battle1","map/test","map/test2","map/floor1-outside","map/floor1-atrium","map/floor1-bowlingalley","map/floor2-entrance","map/floor2-cafeteria","map/floor2-north","map/floor2-preproom"],(function(e,t,r,o,a,n,l,s,c,d,h,u,m,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=t.getIfExists=t.get=t.getRoom=t.loadRooms=void 0,a=i(a),n=i(n),l=i(l),s=i(s),c=i(c),d=i(d),h=i(h),u=i(u),m=i(m),p=i(p);let g=window.rooms={},f={floor1Outside:s,floor1Atrium:c,floor1Bowling:d,floor2Entrance:h,floor2Cafeteria:u,floor2North:m,floor2preproom:p},y=async(e,t)=>{g[e]=await r.createRoom(e,t)};t.loadRooms=async()=>{await y("battle1",a),await y("test",n),await y("test2",l);for(let e in f)await y(e,f[e])},t.getRoom=e=>g[e];let w=window.overworlds={};t.get=e=>{let t=w[e];if(!t)throw Error("No overworld exists with name: "+e);return Object.assign({},t)},t.getIfExists=e=>{let t=w[e];return t?Object.assign({},t):null},t.init=async()=>{await t.loadRooms(),w.TEST={roomName:"test",backgroundColor:"black"},w.TEST2={roomName:"test2",loadTriggerName:"floor1",backgroundColor:"black"};for(let e in f)w[e]={roomName:e,loadTriggerName:e,backgroundColor:"black"};w.floor1Outside.backgroundColor=o.colors.DARKBLUE}})),define("view/icons/Shield",["require","exports","preact"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>i.h("svg",{fill:e.color,stroke:e.color,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},i.h("path",{d:"M0 0h512v512H0z",fill:"rgba(0, 0, 0, 0)","fill-opacity":"0"}),i.h("g",{class:"",transform:"translate(0,0)",style:""},i.h("path",{d:"M256 16c25 24 100 72 150 72v96c0 96-75 240-150 312-75-72-150-216-150-312V88c50 0 125-48 150-72z",fill:e.color,"fill-opacity":"1"})))})),define("view/icons/Sword",["require","exports","preact"],(function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>i.h("svg",{fill:e.color,stroke:e.color,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},i.h("g",{class:"",transform:"translate(0,0)",style:""},i.h("path",{d:"M491.844 22.533l-83.42 14.865L196.572 249.25c3.262 4.815 5.37 10.72 5.37 16.932 0 5.863-1.71 11.35-4.643 15.996-5.065-1.606-10.448-2.477-16.027-2.477-15.724 0-29.904 6.89-39.69 17.796l-9.112-9.113 17.237-17.237c-4.515-5.772-8.907-11.645-13.19-17.6l-19.443 19.44-13.215-13.215 21.828-21.827c-4.403-6.59-8.67-13.278-12.792-20.068l-40.802 40.803 58.314 58.314c-1.613 5.075-2.49 10.47-2.49 16.063 0 7.666 1.65 14.96 4.592 21.564l-72.14 72.14-14.56-14.56L21.013 437l14.558 14.56-8.607 8.608 27.246 27.246 8.606-8.61 14.56 14.56 24.798-24.8-14.557-14.556 72.158-72.16c6.586 2.922 13.858 4.562 21.498 4.562 5.593 0 10.988-.877 16.063-2.49l58.363 58.363L296.5 401.48c-6.797-4.127-13.486-8.395-20.068-12.793l-21.83 21.83L241.39 397.3l19.442-19.44c-5.962-4.29-11.835-8.683-17.603-13.194l-17.238 17.238-9.16-9.16c10.905-9.785 17.795-23.965 17.795-39.69 0-5.346-.806-10.51-2.285-15.39 4.703-3.04 10.288-4.817 16.265-4.816 6.21 0 11.776 1.77 16.52 4.955L476.98 105.95l14.864-83.417zm-66.227 53.012l13.215 13.215-191.684 191.68-13.214-13.213L425.617 75.545zM181.273 298.39c19.257 0 34.665 15.41 34.665 34.665 0 19.256-15.408 34.666-34.665 34.666-19.256 0-34.666-15.41-34.666-34.665s15.41-34.666 34.666-34.666z",fill:"#fff","fill-opacity":"1"})))})),define("controller/battle-actions",["require","exports","model/battle","model/character","model/room","model/utility","utils","model/particle","controller/battle-management","view/icons/Shield","view/icons/Sword"],(function(e,t,i,o,a,n,l,s,c,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BattleActions=void 0,d=r(d),h=r(h);let u=(e,t)=>!!i.battleCharacterCanAct(e,t);t.BattleActions={Swing:{name:"Swing",description:"Jump to target and swing your weapon.",cooldown:1e4,icon:h.default,cb:async(e,t)=>{if(!u(e,t))return;let r=t.ch,d=i.battleGetAllegiance(e,r),h=i.battleGetNearestAttackable(e,d);if(h){c.beginAction(e,t);let u=o.characterGetPos(r),m=o.characterGetPos(h.ch);d===i.BattleAllegiance.ALLY?(m[0]-=a.TILE_WIDTH/2,i.battleCharacterGetRow(t)===i.BattleRow.BOTTOM&&(m[0]+=a.TILE_WIDTH/2,m[1]+=a.TILE_WIDTH/2)):(m[0]+=a.TILE_WIDTH/2,i.battleCharacterGetRow(t)===i.BattleRow.TOP&&(m[0]-=a.TILE_WIDTH/2,m[1]-=a.TILE_WIDTH/2));let p=l.calculateDistance(u,m),g=new n.Transform(u,m,250*l.normalize(p,35,125,1,1.75),n.TransformEase.LINEAR,(e=>e<45?n.transformOffsetJumpShort:e<100?n.transformOffsetJumpMedium:n.transformOffsetJumpFar)(p));o.characterSetTransform(r,g),o.characterSetAnimationState(r,o.AnimationState.BATTLE_JUMP),await g.timer.onCompletion(),l.timeoutPromise(300).then(()=>{let[i,r]=o.characterGetPosCenterPx(h.ch),n=s.particleCreateFromTemplate([i,r],s.EFFECT_TEMPLATE_SWORD_LEFT);a.roomAddParticle(e.room,n),c.applyWeaponDamage(e,t,h,1,1)}),o.characterSetAnimationState(r,o.AnimationState.BATTLE_ATTACK);let f=o.characterGetAnimation(r);await f.onCompletion();let y=g.createInverse();o.characterSetTransform(r,y),o.characterSetAnimationState(r,o.AnimationState.BATTLE_JUMP),await y.timer.onCompletion(),y.markForRemoval(),o.characterSetAnimationState(r,o.AnimationState.BATTLE_IDLE),c.endAction(e,t)}}},SwingSlow:{name:"SwingSlow",description:"A slower version of the swing.",cooldown:1e5,icon:h.default,cb:async(e,i)=>t.BattleActions.Swing.cb(e,i)},Defend:{name:"Defend",description:"Brace yourself for an attack, taking less damage and reducing stagger for a short time.",cooldown:5e3,icon:d.default,cb:async(e,t)=>{if(!u(e,t))return;c.beginAction(e,t);let r=t.ch,l=await(async(e,t)=>{let r=t.ch,l=i.battleGetAllegiance(e,r),s=o.characterGetPos(r),c=[...s];l===i.BattleAllegiance.ALLY?(c[0]+=a.TILE_WIDTH/2,c[1]-=a.TILE_WIDTH/2):(c[0]-=a.TILE_WIDTH/2,c[1]+=a.TILE_WIDTH/2);let d=new n.Transform(s,c,200,n.TransformEase.LINEAR,n.transformOffsetJumpShort);return o.characterSetTransform(r,d),o.characterSetAnimationState(r,o.AnimationState.BATTLE_JUMP),await d.timer.onCompletion(),d})(e,t);o.characterSetAnimationState(r,o.AnimationState.BATTLE_ITEM);let s=o.characterGetAnimation(r);await s.onCompletion(),i.battleCharacterAddStatus(t,i.Status.DEFEND);let d=l.createInverse();o.characterSetTransform(r,d),o.characterSetAnimationState(r,o.AnimationState.BATTLE_JUMP),await d.timer.onCompletion(),d.markForRemoval(),o.characterSetAnimationState(r,o.AnimationState.BATTLE_IDLE),c.setCasting(t,{castTime:5e3,onCast:()=>{i.battleCharacterRemoveStatus(t,i.Status.DEFEND)},onInterrupt:()=>{i.battleCharacterRemoveStatus(t,i.Status.DEFEND)}}),c.endAction(e,t)}}}})),define("controller/battle-ai",["require","exports","model/battle","controller/battle-actions"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BATTLE_AI_ATTACK=void 0,t.BATTLE_AI_ATTACK=(e,t)=>{let o=i.battleGetAllegiance(e,t.ch);i.battleGetNearestAttackable(e,o)&&r.BattleActions.Swing.cb(e,t)}})),define("model/battle",["require","exports","model/room","model/character","controller/battle-management","model/utility"],(function(e,t,i,r,o,a){"use strict";var n,l,s;Object.defineProperty(t,"__esModule",{value:!0}),t.battleGetNearestAttackable=t.battleGetCharactersOfAllegiance=t.battleGetOppositeAllegiance=t.battleGetAllegiance=t.battleIsLoss=t.battleIsVictory=t.battleSetActorPositions=t.battleCharacterGetRow=t.battleCharacterGetSelectedSkill=t.battleCharacterRemoveStatus=t.battleCharacterAddStatus=t.battleCharacterRemoveCanActCb=t.battleCharacterSetCanActCb=t.battleCharacterCanAct=t.battleCharacterApplyDamage=t.battleCharacterSetStaggered=t.battleCharacterCreateAlly=t.battleCharacterCreateEnemy=t.battleStatsCreate=t.Status=t.BattleAllegiance=t.BattleRow=t.BattlePosition=void 0,function(e){e.FRONT="front",e.MIDDLE="middle",e.BACK="back"}(n=t.BattlePosition||(t.BattlePosition={})),function(e){e.TOP="top",e.BOTTOM="bottom",e.NONE="none"}(l=t.BattleRow||(t.BattleRow={})),function(e){e.ALLY="ally",e.ENEMY="enemy"}(s=t.BattleAllegiance||(t.BattleAllegiance={})),(t.Status||(t.Status={})).DEFEND="defend",t.battleStatsCreate=()=>({POW:5,ACC:1,SPD:1,FOR:1,HP:1,STAGGER:2});let c=(e,t,i)=>{var r;let n=e.skills[e.skillIndex],s=o.calculateStaggerDamage(e);return{ch:e,isDefeated:!1,shouldRemove:!1,actionTimer:new a.Timer(null!==(r=null==n?void 0:n.cooldown)&&void 0!==r?r:2e3),staggerTimer:new a.Timer(1e3),staggerGauge:new a.Gauge(s,.02),castTimer:new a.Timer(1e3),position:t,isActing:!1,isCasting:!1,canAct:!1,isStaggered:!1,statuses:[],row:l.NONE,onCanActCb:function(){},onCast:function(){},onCastInterrupted:function(){},ai:i}};t.battleCharacterCreateEnemy=(e,t)=>c(e,t.position,t.ai),t.battleCharacterCreateAlly=(e,t)=>c(e,t.position),t.battleCharacterSetStaggered=e=>{e.isStaggered=!0,e.staggerTimer.start(),e.staggerGauge.empty(),r.characterSetAnimationState(e.ch,r.AnimationState.BATTLE_STAGGERED)},t.battleCharacterApplyDamage=(e,t)=>{r.characterModifyHp(e.ch,-t),e.isStaggered?r.characterSetAnimationState(e.ch,r.AnimationState.BATTLE_STAGGERED):(r.characterSetAnimationState(e.ch,r.AnimationState.BATTLE_DAMAGED),r.characterOnAnimationCompletion(e.ch,()=>{r.characterSetAnimationState(e.ch,e.isStaggered?r.AnimationState.BATTLE_STAGGERED:r.AnimationState.BATTLE_IDLE)}))},t.battleCharacterCanAct=(e,i)=>{if(i.isActing)return!1;let r=t.battleGetAllegiance(e,i.ch)===s.ALLY?e.enemies:e.allies;for(let e=0;e<r.length;e++)if(r[e].isActing)return!1;return i.actionTimer.isComplete()},t.battleCharacterSetCanActCb=(e,t)=>{e.onCanActCb=t},t.battleCharacterRemoveCanActCb=e=>{e.onCanActCb=function(){}},t.battleCharacterAddStatus=(e,t)=>{e.statuses.includes(t)||e.statuses.push(t)},t.battleCharacterRemoveStatus=(e,t)=>{let i=e.statuses.indexOf(t);i>-1&&e.statuses.splice(i,1)},t.battleCharacterGetSelectedSkill=e=>e.ch.skills[e.ch.skillIndex],t.battleCharacterGetRow=e=>e.row;let d={[n.FRONT]:[[5,7],[8,10]],[n.MIDDLE]:[[3,9],[6,12]],[n.BACK]:[[1,11],[4,14]]},h={[n.FRONT]:[[7,5],[10,8]],[n.MIDDLE]:[[9,3],[12,6]],[n.BACK]:[[11,1],[14,4]]};t.battleSetActorPositions=e=>{let t={[n.FRONT]:0,[n.MIDDLE]:0,[n.BACK]:0},r=(e,t)=>r=>{let o=[0,0],a=0;switch(r.position){case n.FRONT:a=e[n.FRONT],o=t[n.FRONT][e[n.FRONT]++];break;case n.MIDDLE:a=e[n.MIDDLE],o=t[n.MIDDLE][e[n.MIDDLE]++];break;case n.BACK:a=e[n.BACK],o=t[n.BACK][e[n.BACK]++]}let[s,c]=i.tilePosToWorldPos(o[0],o[1]);a<=1?(r.row=0===a?l.TOP:l.BOTTOM,r.ch.x=s,r.ch.y=c):console.error("Error setting actor position for battle, Row number is greater than 1 (most likely more than 2 actors in a battle position)",r)};e.allies.forEach(r({[n.FRONT]:0,[n.MIDDLE]:0,[n.BACK]:0},d)),e.enemies.forEach(r(t,h))},t.battleIsVictory=e=>0===e.enemies.length,t.battleIsLoss=e=>0===e.allies.length,t.battleGetAllegiance=(e,t)=>{if(e.enemies.find(e=>e.ch===t))return s.ENEMY;if(e.allies.find(e=>e.ch===t))return s.ALLY;throw Error(`Cannot get battle allegiance for character '${t.name}' that does not exist in battle.`)},t.battleGetOppositeAllegiance=e=>e===s.ALLY?s.ENEMY:s.ALLY,t.battleGetCharactersOfAllegiance=(e,t)=>{switch(t){case s.ALLY:return e.allies;case s.ENEMY:return e.enemies;default:return e.allies}},t.battleGetNearestAttackable=(e,i)=>{let r,o=t.battleGetCharactersOfAllegiance(e,t.battleGetOppositeAllegiance(i));return r=o.find(e=>e.position===n.FRONT),r||(r=o.find(e=>e.position===n.MIDDLE)),r||(r=o.find(e=>e.position===n.BACK)),null!=r?r:null}})),define("model/render-object",["require","exports","model/sprite","utils","model/room"],(function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTileRenderObject=t.createTriggerActivatorRenderObject=t.createMarkerRenderObject=t.createPropRenderObject=void 0,t.createPropRenderObject=e=>{if(e.isDynamic){let[,,,t,o]=i.getSprite(e.sprite),[a,n]=r.isoToPixelCoords(e.x,e.y);return n=n-o+20,a=a-t/2+20,{sprite:e.sprite,px:a,py:n,sortY:e.isFront?1/0:n+o,visible:!0}}{let[t,a]=r.isoToPixelCoords(e.x,e.y),[,,,n,l]=i.getSprite(e.sprite);return t-=t-n/2+o.TILE_WIDTH/2,a=a-l+o.TILE_HEIGHT/2,{sprite:e.sprite,px:t,py:a,sortY:a+l,visible:!0}}},t.createMarkerRenderObject=e=>{let{x:t,y:i}=e,[o,a]=r.isoToPixelCoords(t,i,0);return{name:e.name,sprite:"control_1",px:o,py:a,sortY:a+32,visible:!0,isMarker:!0}},t.createTriggerActivatorRenderObject=e=>{if(e.polygon)return{name:e.name,polygon:e.polygon,sortY:1/0,visible:!0,isTrigger:!0};{let{x:t,y:i}=e,[o,a]=r.isoToPixelCoords(t,i,0);return{name:e.name,sprite:"control_2",px:o,py:a,sortY:a+32,visible:!0,isTrigger:!0}}},t.createTileRenderObject=e=>{let[t,i]=r.isoToPixelCoords(e.x*o.TILE_WIDTH/2,e.y*o.TILE_HEIGHT/2),a=i;return i-=e.tileHeight-32,{sprite:e.sprite,origPy:a,px:t,py:i,highlighted:e.highlighted,isFloor:e.sprite.indexOf("floors")>-1,sortY:i+(e.tileHeight-32)+(e.tileHeight>32?20:16),visible:!0}}})),define("model/character",["require","exports","model/animation","model/battle","utils","controller/battle-actions","model/generics","model/room","model/canvas","view/draw","model/player"],(function(e,t,i,r,o,a,n,l,s,c,d){"use strict";var h,u;Object.defineProperty(t,"__esModule",{value:!0}),t.characterUpdate=t.characterCollidesWithRect=t.characterCollidesWithPoint=t.characterResetSpeed=t.characterSetSpeed=t.characterSetWalkTarget=t.characterGetSize=t.characterGetPosCenterPx=t.characterGetPosPx=t.characterGetPosBottom=t.characterGetPos=t.characterSetTransform=t.characterGetHpPct=t.characterModifyHp=t.characterSetFacingFromAngle=t.characterSetFacing=t.characterOnAnimationCompletion=t.characterSetPos=t.characterSetAnimationState=t.characterGetAnimation=t.characterGetAnimKey=t.characterCreateFromTemplate=t.characterCreate=t.ANIMATIONS_WITHOUT_FACING=t.AnimationState=t.Facing=t.DEFAULT_SPEED=void 0,t.DEFAULT_SPEED=1,function(e){e.LEFT="left",e.UP="up",e.DOWN="down",e.LEFT_UP="leftup",e.LEFT_DOWN="leftdown",e.RIGHT="left_f",e.RIGHT_UP="leftup_f",e.RIGHT_DOWN="leftdown_f",e.RIGHT2="right",e.RIGHT_UP2="rightup",e.RIGHT_DOWN2="rightdown"}(h=t.Facing||(t.Facing={})),function(e){e.IDLE="idle",e.WALK="walk",e.BATTLE_IDLE="battle_idle",e.BATTLE_JUMP="battle_jump",e.BATTLE_ATTACK="battle_attack",e.BATTLE_DAMAGED="battle_damaged",e.BATTLE_STAGGERED="battle_staggered",e.BATTLE_ITEM="battle_item",e.BATTLE_FLOURISH="battle_flourish",e.BATTLE_DEFEATED="battle_defeated"}(u=t.AnimationState||(t.AnimationState={})),t.ANIMATIONS_WITHOUT_FACING=[u.BATTLE_FLOURISH],t.characterCreate=e=>{let i={name:e,spriteBase:"ada",x:0,y:0,z:0,vx:0,vy:0,speed:t.DEFAULT_SPEED,transform:null,hp:10,stats:r.battleStatsCreate(),skills:[a.BattleActions.SWING],skillIndex:0,facing:h.LEFT,animationState:u.IDLE,animationKey:"",storedAnimations:{},walkTarget:null,walkAngle:0,walkDistance:0,walkRetries:0,onReachWalkTarget:null,talkTrigger:""};return i.ro={character:i,sortY:0,visible:!0},i.animationKey=t.characterGetAnimKey(i),i},t.characterCreateFromTemplate=e=>{var i;let r=t.characterCreate(e.name);return r.spriteBase=e.spriteBase,r.facing=e.facing||r.facing,r.animationState=e.animationState||r.animationState,r.animationKey=t.characterGetAnimKey(r),r.hp=r.stats.HP,r.stats=Object.assign({},e.stats||r.stats),r.skills=e.skills||r.skills,r.talkTrigger=null!==(i=e.talkTrigger)&&void 0!==i?i:"",r},t.characterGetAnimKey=e=>{let{spriteBase:i,facing:r,animationState:o}=e;return t.ANIMATIONS_WITHOUT_FACING.includes(o)?`${i}_${o}`:`${i}_${o}_${r}`},t.characterGetAnimation=e=>{let{storedAnimations:r}=e,o=t.characterGetAnimKey(e),a=r[o];if(a)return a;{let e=i.createAnimation(o);return r[o]=e,e}},t.characterSetAnimationState=(e,i)=>{e.animationState=i;let r=t.characterGetAnimKey(e);if(r!==e.animationKey){e.animationPromise&&(e.animationPromise.reject(),e.animationPromise=void 0),e.animationKey=r;let i=t.characterGetAnimation(e);i.reset(),i.start()}},t.characterSetPos=(e,t)=>{e.x=t[0],e.y=t[1],e.z=t[2]},t.characterOnAnimationCompletion=(e,i)=>{e.animationPromise&&e.animationPromise.reject();let r=t.characterGetAnimation(e),o={},a=new Promise((t,i)=>{o.resolve=t,o.reject=i,(async()=>{await r.onCompletion(),e.animationPromise=void 0,t()})()}).then(()=>{i()}).catch(e=>{});return e.animationPromise=o,a},t.characterSetFacing=(e,i)=>{e.facing=i,t.characterSetAnimationState(e,e.animationState)},t.characterSetFacingFromAngle=(e,i)=>{if(i>337.5||i<22.5)return void t.characterSetFacing(e,h.UP);let r=[h.UP,h.RIGHT_UP,h.RIGHT,h.RIGHT_DOWN,h.DOWN,h.LEFT_DOWN,h.LEFT,h.LEFT_UP];for(let o=1;o<8;o++)i>=45*o-22.5&&i<45*(o+1)-22.5&&t.characterSetFacing(e,r[o])},t.characterModifyHp=(e,t)=>{e.hp+=t,e.hp>e.stats.HP?e.hp=e.stats.HP:e.hp<0&&(e.hp=0)},t.characterGetHpPct=e=>+(e.hp/e.stats.HP).toFixed(2),t.characterSetTransform=(e,t)=>{e.transform=t},t.characterGetPos=e=>e.transform?e.transform.current():[e.x,e.y,e.z],t.characterGetPosBottom=e=>{let{x:t,y:i}=e;return[t+16,i+16-4]},t.characterGetPosPx=e=>{let[i,r,a]=t.characterGetPos(e);return o.isoToPixelCoords(i,r,a)},t.characterGetPosCenterPx=e=>{let[i,r]=t.characterGetPosPx(e),[o,a]=t.characterGetSize(e);return[i+o/2,r+a/2]},t.characterGetSize=e=>t.characterGetAnimation(e).getSpriteSize(0),t.characterSetWalkTarget=(e,i,r)=>{e.walkTarget=i,e.onReachWalkTarget=r;let a=t.characterGetPosBottom(e),n=m(e),l=o.getAngleTowards(a,n);e.walkAngle=l,e.walkDistance=o.calculateDistance(o.extrapolatePoint(a),o.extrapolatePoint(n)),e.walkRetries=0};let m=e=>e.walkTarget?[e.walkTarget[0]+16,e.walkTarget[1]+16-4]:[0,0];t.characterSetSpeed=(e,t)=>{e.speed=t},t.characterResetSpeed=e=>{e.speed=t.DEFAULT_SPEED},t.characterCollidesWithPoint=(e,i)=>{let r=[...t.characterGetPosBottom(e),1];return o.circleCircleCollision(r,i)},t.characterCollidesWithRect=(e,i)=>{let r=[...t.characterGetPosBottom(e),2];return"none"!==o.circleRectCollision(r,i)},t.characterUpdate=e=>{let i=n.getCurrentRoom(),r=n.getFrameMultiplier();if(e.transform&&(e.transform.update(),e.transform.shouldRemove&&(e.transform=null)),e.walkTarget){let i=t.characterGetPosBottom(e),r=m(e),a=o.getAngleTowards(i,r);e.walkAngle=a;let n=Math.sin(e.walkAngle*Math.PI/180),l=-Math.cos(e.walkAngle*Math.PI/180),s=e.walkDistance;e.walkDistance=o.calculateDistance(o.extrapolatePoint(i),o.extrapolatePoint(r)),s<=e.walkDistance&&e.walkRetries++,e.vx=n,e.vy=l,t.characterSetAnimationState(e,u.WALK),(e.walkRetries>10||t.characterCollidesWithPoint(e,[...r,1.5]))&&(t.characterSetAnimationState(e,u.IDLE),t.characterSetPos(e,[...e.walkTarget,e.z]),e.onReachWalkTarget&&e.onReachWalkTarget(),e.walkTarget=null,e.onReachWalkTarget=null)}if(0!==e.vx||0!==e.vy){let[a,n]=o.getNormalizedVec(e.vx,e.vy),s=a*r*e.speed,c=n*r*e.speed;e.x+=s,e.y+=c;let d=o.getAngleFromVector(-s,-c)-45;d<0&&(d+=360),t.characterSetFacingFromAngle(e,d);let h=l.roomGetTileBelow(i,[e.x,e.y]),u=null,m=null;h&&(u=l.roomGetTileAt(i,h.x,Math.floor((e.y+22)/l.TILE_HEIGHT_WORLD)),m=l.roomGetTileAt(i,Math.floor((e.x+22)/l.TILE_WIDTH_WORLD),h.y)),((null==h?void 0:h.isWall)||(null==u?void 0:u.isWall)||(null==m?void 0:m.isWall))&&(e.x-=s,e.y-=c),e.vx=0,e.vy=0}let[a,s,c]=t.characterGetPos(e),[,d]=o.isoToPixelCoords(a,s,c);e.ro&&(e.ro.sortY=d+32)}})),define("model/room",["require","exports","model/sprite","utils","model/character","db/characters","view/draw","lib/rpgscript","db/tiles","model/animation","model/render-object","model/canvas"],(function(e,t,i,r,o,a,n,l,s,c,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.roomRemoveCharacter=t.roomAddCharacter=t.roomGetCharacterByName=t.roomGetTileBelow=t.roomAddParticle=t.roomGetTileAt=t.createRoom=t.tilePosToWorldPos=t.TILE_HEIGHT_WORLD=t.TILE_WIDTH_WORLD=t.TILE_HEIGHT=t.TILE_WIDTH=void 0,t.TILE_WIDTH=32,t.TILE_HEIGHT=32,t.TILE_WIDTH_WORLD=16,t.TILE_HEIGHT_WORLD=16,t.tilePosToWorldPos=(e,i)=>[e*t.TILE_WIDTH/2,i*t.TILE_HEIGHT/2];let u=null;t.createRoom=async(e,m)=>{u||await(async()=>{var e,t;let i=await fetch("res/props-dynamic.tiled-sheet.tsx").then(e=>e.text());i&&(u=null!==(t=null===(e=i.match(/source="(.*)\.[\w]+"/g))||void 0===e?void 0:e.map(e=>e.slice(e.indexOf('"')+1,e.lastIndexOf('"')-4)))&&void 0!==t?t:null)})();let{width:p,height:g,data:f}=m.layers[0],{objects:y}=m.layers.find(e=>"Props"===e.name)||{},{objects:w}=m.layers.find(e=>"Objects"===e.name)||{},{firstgid:_}=m.tilesets.find(e=>{var t;return"props-dynamic"===e.name||(null!==(t=e.source)&&void 0!==t?t:"").indexOf("props-dynamic")>-1})||{firstGid:-9999999},v=p*t.TILE_WIDTH,b=g*t.TILE_HEIGHT/2,[C,T]=h.createCanvas(v,b+t.TILE_HEIGHT),S={tiledJson:m,width:p,height:g,widthPx:v,heightPx:b,props:[],tiles:[],characters:[],particles:[],markers:{},triggerActivators:[],renderObjects:[],floorTileObjects:[],floor:i.createSprite(C),defaultFloorSprite:"floors_1"},x=[];f.forEach((e,t)=>{var i;let{sprite:r,tileWidth:o,tileHeight:a}=((e,t)=>{if(0===t)return{sprite:"invisible",tileWidth:32,tileHeight:32};let i=0;do{let r=e[i],o=e[i+1];if(!o||t>=r.firstgid&&t<o.firstgid)return{sprite:r.name+"_"+(t-r.firstgid),tileWidth:r.tilewidth,tileHeight:r.tileheight};i++}while(i<e.length);throw Error("Could not determine sprite from gid:"+t)})(m.tilesets,e),n=r.indexOf("wall")>-1,l=r.indexOf("props")>-1,h={sprite:r,tileWidth:o,tileHeight:a,isWall:n||l,id:e-1,x:t%p,y:Math.floor(t/p),highlighted:!1};S.tiles.push(h);let u=d.createTileRenderObject(h);if(u.isFloor)S.renderObjects.push(u);else{if(n)Object.assign(Object.assign({},h),{tileWidth:32,tileHeight:32,sprite:"floors_1",id:1});else if(l){let e=Object.assign(Object.assign({},h),{tileWidth:32,tileHeight:32,sprite:"floors_1",id:1,x:h.x+1,y:h.y}),t=Object.assign(Object.assign({},e),{x:h.x,y:h.y+1}),i=d.createTileRenderObject(e),r=d.createTileRenderObject(t);S.renderObjects.push(i,r)}S.renderObjects.push(u)}h.ro=u;let g=s.getReplacementTemplate(h.sprite);g&&(h.ro.sprite=g.baseSprite,h.isWall=null!==(i=g.isWall)&&void 0!==i?i:h.isWall,(null==g?void 0:g.animName)&&(h.animName=g.animName,h.ro.anim=c.createAnimation(g.animName),h.ro.anim.start()))});let E=t=>{let o=t.x,a=t.y,n=t.gid,l=n-_;if(n>=_&&n<_+(null==u?void 0:u.length)&&u){let s=u[l];if(!s)throw Error(`Could not load prop in room definition '${e}', the propIndex '${l}' has no associated tilesetTile. (gid=${n} startingGid=${_})`);x.push(new Promise(async e=>{await i.loadImageAsSprite(s,r.removeFileExtension(s));let n={x:o,y:a,sprite:s,isDynamic:!0,isFront:"front"===t.type};S.props.push(n),S.renderObjects.push(d.createPropRenderObject(n)),e()}))}};y&&y.forEach(E),w&&w.forEach(i=>{let n=i.name.toLowerCase().indexOf("marker")>-1,s=0===i.name.toLowerCase().indexOf("#");n?(t=>{let i=t.x,o=t.y,[a,n]=r.isoToPixelCoords(i,o),[l,s]=r.pixelToIsoCoords(a,n-16);if(S.markers[t.name])throw Error(`Could not load marker '${t.name}' in room definition '${e}', a marker with that name already exists.)`);let c={name:t.name,x:l,y:s};S.markers[t.name]=c,S.renderObjects.push(d.createMarkerRenderObject(c))})(i):s?(t=>{let i=t.x,o=t.y,a=t.width,n=t.height,s=t.name.slice(1);if(void 0===t.gid){let e=8,t=24,r={polygon:[[t+i,e+o],[t+i+a,e+o],[t+i+a,e+o+n],[t+i,e+o+n]],name:s,x:i,y:o,width:a,height:n,isTrigger:!0};S.triggerActivators.push(r),S.renderObjects.push(d.createTriggerActivatorRenderObject(r))}else{let[a,n]=r.isoToPixelCoords(i,o),[c,h]=r.pixelToIsoCoords(a,n-16);if(!l.getTrigger(s))throw Error(`Could not load trigger '${t.name}' in room definition '${e}', a trigger with that name does not exist.)`);let u={name:s,x:c,y:h,width:16,height:16,isTrigger:!0};S.triggerActivators.push(u),S.renderObjects.push(d.createTriggerActivatorRenderObject(u))}})(i):i.name?(i=>{let n=i.x,l=i.y,[s,c]=r.isoToPixelCoords(n,l),[d,h]=r.pixelToIsoCoords(s,c-16),u=a.get(i.name);if(!u)throw Error(`Could not load character '${i.name}' in room definition '${e}', no entry in the db.`);let m=o.characterCreateFromTemplate(u);o.characterSetPos(m,[d,h,0]),t.roomAddCharacter(S,m)})(i):E(i)}),S.floorTileObjects=S.floorTileObjects.sort((e,t)=>e.sortY<t.sortY?-1:1);for(let e=0;e<S.floorTileObjects.length;e++){let{sprite:t,px:i,py:r}=S.floorTileObjects[e];t&&n.drawSprite(t,i+S.widthPx/2,r,1,T)}return await Promise.all(x),S},t.roomGetTileAt=(e,t,i)=>t<0||t>=e.width||i<0||i>=e.height?null:e.tiles[i*e.width+t],t.roomAddParticle=(e,t)=>{e.particles.push(t)},t.roomGetTileBelow=(e,i)=>{let[r,o]=i;return t.roomGetTileAt(e,Math.floor((r+t.TILE_WIDTH_WORLD-3)/t.TILE_WIDTH*2),Math.floor((o+t.TILE_HEIGHT_WORLD-3)/t.TILE_HEIGHT*2))},t.roomGetCharacterByName=(e,t)=>{for(let i=0;i<e.characters.length;i++){let r=e.characters[i];if(r.name===t)return r}return null},t.roomAddCharacter=(e,t)=>{e.characters.push(t),t.ro&&e.renderObjects.push(t.ro)},t.roomRemoveCharacter=(e,t)=>{let i=e.characters.indexOf(t);if(i>-1&&e.characters.splice(i,1),t.ro){let i=e.renderObjects.indexOf(t.ro);i>-1&&e.renderObjects.splice(i,1)}}})),define("model/generics",["require","exports"],(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRenderBackgroundColor=t.getRenderBackgroundColor=t.hideMarkers=t.showMarkers=t.getMarkersVisible=t.hideTriggers=t.showTriggers=t.getTriggersVisible=t.disableKeyUpdate=t.enableKeyUpdate=t.getKeyUpdateEnabled=t.getRenderables=t.removeRenderable=t.addRenderable=t.setIsPaused=t.getIsPaused=t.isKeyDown=t.setKeyUp=t.setKeyDown=t.setMousePos=t.getMousePos=t.setFrameMultiplier=t.getFrameMultiplier=t.setDeltaT=t.getDeltaT=t.setNow=t.getNow=t.setCurrentPlayer=t.getCurrentPlayer=t.setCurrentScene=t.getCurrentScene=t.setCurrentOverworld=t.getCurrentOverworld=t.setCurrentBattle=t.getCurrentBattle=t.setCurrentRoom=t.getCurrentRoom=void 0;let i=window.room=null;t.getCurrentRoom=()=>i,t.setCurrentRoom=e=>{i=window.room=e};let r=window.battle=null;t.getCurrentBattle=()=>r,t.setCurrentBattle=e=>{r=window.battle=e};let o=window.overworld=null;t.getCurrentOverworld=()=>o,t.setCurrentOverworld=e=>{o=window.overworld=e};let a=window.scene=null;t.getCurrentScene=()=>a,t.setCurrentScene=e=>{a=window.scene=e};let n=window.player=null;t.getCurrentPlayer=()=>n,t.setCurrentPlayer=e=>{n=window.player=e};let l=0;t.getNow=()=>l,t.setNow=e=>{l=e};let s=0;t.getDeltaT=()=>s,t.setDeltaT=e=>{s=e};let c=0;t.getFrameMultiplier=()=>c,t.setFrameMultiplier=e=>{c=e};let d=[0,0];t.getMousePos=()=>d,t.setMousePos=(e,t)=>{d=[e,t]};let h={};t.setKeyDown=e=>{h[e]=!0},t.setKeyUp=e=>{h[e]=!1},t.isKeyDown=e=>{var t;return null!==(t=h[e])&&void 0!==t&&t};let u=!1;t.getIsPaused=()=>u,t.setIsPaused=e=>{u=e};let m={};t.addRenderable=(e,t)=>{m[e]=t},t.removeRenderable=e=>{delete m[e]},t.getRenderables=()=>m;let p=!0;t.getKeyUpdateEnabled=()=>p,t.enableKeyUpdate=()=>{p=!0},t.disableKeyUpdate=()=>{p=!1};let g=!0;t.getTriggersVisible=()=>g,t.showTriggers=()=>g=!0,t.hideTriggers=()=>g=!1;let f=!0;t.getMarkersVisible=()=>f,t.showMarkers=()=>f=!0,t.hideMarkers=()=>f=!1;let y="black";t.getRenderBackgroundColor=()=>y,t.setRenderBackgroundColor=e=>y=e})),define("model/animation",["require","exports","model/generics","model/sprite"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnimation=t.createAnimationBuilder=t.Animation=void 0,t.Animation=class{constructor(e){this.loop=e||!1,this.sprites=[],this.done=!1,this.totalDurationMs=0,this.currentSpriteIndex=0,this.timestampStart=0,this.name="",this.awaits=[]}reset(){this.done=!1,this.currentSpriteIndex=0}start(){this.timestampStart=i.getNow()}getDurationMs(){return this.totalDurationMs}addSprite({name:e,duration:t,offsetX:i,offsetY:r,opacity:o}){this.sprites.push({name:e,timestampBegin:this.totalDurationMs,timestampEnd:this.totalDurationMs+t,duration:t,offsetX:i||0,offsetY:r||0,opacity:o}),this.totalDurationMs+=t}getAnimIndex(e){let t=0,i=this.currentSpriteIndex,r=this.sprites.length-1;for(;i<=r;){let o=i+Math.floor((r-i)/2);t=o;let{timestampEnd:a,timestampBegin:n}=this.sprites[o],l=(n||0)+this.timestampStart,s=(a||0)+this.timestampStart;if(e<s&&e>l)return o;e>=s?i=o+1:r=o-1}return t}update(){let e=i.getNow();if(this.currentSpriteIndex===this.sprites.length-1&&this.loop&&e-this.timestampStart>this.totalDurationMs){let t=this.timestampStart+this.totalDurationMs;this.reset(),this.start(),e-t<this.totalDurationMs&&(this.timestampStart=t)}this.currentSpriteIndex=this.getAnimIndex(e),this.loop||e-this.timestampStart>=this.totalDurationMs&&(this.done=!0,this.awaits.forEach(e=>e()),this.awaits=[])}onCompletion(){return new Promise(e=>{this.isDone()||this.loop||this.awaits.push(e)})}getSprite(){var e;return null===(e=this.sprites[this.currentSpriteIndex])||void 0===e?void 0:e.name}getSpriteSize(e){let t=i.getNow();e=null!=e?e:this.getAnimIndex(t);let{name:o}=this.sprites[e],[,,,a,n]=r.getSprite(o);return[a,n]}isDone(){return this.done}};let o=window.animations={};t.createAnimationBuilder=(e,t)=>{o[e]=t},t.createAnimation=e=>{let t=o[e];if(t){let i=t();return i.name=e,i}throw Error(`No animation exists which is named '${e}'`)}})),define("view/draw",["require","exports","model/sprite","model/canvas","utils","model/character","model/particle","view/style","model/generics"],(function(e,t,i,r,o,a,n,l,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.drawRoom=t.drawParticle=t.drawCharacter=t.drawPolygon=t.drawAnimation=t.drawSprite=t.drawText=t.measureText=t.drawRect=t.clearScreen=void 0;let c={font:"monospace",color:"#fff",size:14,align:"left",strokeColor:""};t.clearScreen=e=>{(e=e||r.getCtx()).clearRect(0,0,r.getScreenSize(),r.getScreenSize())},t.drawRect=(e,t,i,o,a,n,l)=>{(l=l||r.getCtx()).lineWidth=1,l[n?"strokeStyle":"fillStyle"]=a,l[n?"strokeRect":"fillRect"](Math.floor(e),Math.floor(t),i,o)},t.measureText=(e,t,i)=>{i=i||r.getCtx();let{font:o,size:a}=Object.assign(Object.assign({},c),t||{});return i.textAlign="left",i.textBaseline="top",i.font=a+"px "+o,[i.measureText(e).width,a]},t.drawText=(e,t,i,o,a)=>{let{font:n,size:l,color:s,align:d,strokeColor:h}=Object.assign(Object.assign({},c),o||{});(a=a||r.getCtx()).font=`${l}px ${n}`,a.fillStyle=s,a.textAlign=d,a.textBaseline="middle",a.fillText(e,t,i),h&&(a.strokeStyle=h,a.lineWidth=.5,a.strokeText(e,Math.floor(t),Math.floor(i)))},t.drawSprite=(e,t,o,a,n)=>{if(a=a||1,n=n||r.getCtx(),"invisible"!==e)try{n.fillStyle="black",n.strokeStyle="black";let[r,l,s,c,d]="string"==typeof e?i.getSprite(e):e;n.drawImage(r,l,s,c,d,Math.floor(t),Math.floor(o),c*a,d*a)}catch(t){throw console.error(e),Error("Could not draw sprite: "+t)}},t.drawAnimation=(e,t,o,a,n)=>{a=a||1,n=n||r.getCtx(),e.update();let l=e.getSprite();if(!l)throw console.error(e),Error("Cannot draw animation that did not provide a sprite.");try{n.fillStyle="black",n.strokeStyle="black";let[e,r,s,c,d]="string"==typeof l?i.getSprite(l):l;n.drawImage(e,r,s,c,d,Math.floor(t),Math.floor(o),c*a,d*a)}catch(e){throw Error(`Error attempting to draw animation sprite: "${l}"`)}},t.drawPolygon=(e,t,i,a)=>{i=i||1,(a=a||r.getCtx()).fillStyle=t,a.beginPath();let n=e[0],[l,s]=n,[c,d]=o.isoToPixelCoords(l,s,0);a.moveTo(c,d);for(let t=1;t<e.length;t++){let i=e[t],[r,n]=i,[l,s]=o.isoToPixelCoords(r,n,0);a.lineTo(l,s)}a.closePath(),a.lineWidth=2,a.stroke()},t.drawCharacter=(e,i,r)=>{let[n,l,s]=a.characterGetPos(e),c=a.characterGetAnimation(e),[d,h]=o.isoToPixelCoords(n,l,s);t.drawAnimation(c,d,h,i,r)},t.drawParticle=(e,i,r)=>{let[o,a]=n.particleGetPos(e),{anim:l,text:s,textParams:c}=e;l&&t.drawAnimation(l,o,a,i,r),s&&c&&t.drawText(s,o,a,c)},t.drawRoom=(e,i,a)=>{let{particles:n}=e,[c,d]=i;(a=a||r.getCtx()).save(),a.translate(Math.floor(c),Math.floor(d)),e.renderObjects=e.renderObjects.sort((e,t)=>e.sortY<t.sortY?-1:1);for(let i=0;i<e.renderObjects.length;i++){let{name:r,sprite:a,anim:n,character:c,px:d,py:h,origPy:u,highlighted:m,visible:p,isMarker:g,isTrigger:f,polygon:y}=e.renderObjects[i];if(p)if(g)s.getMarkersVisible()&&(t.drawText(r||"",d+16,h,{align:"center",color:l.colors.WHITE,size:12}),t.drawSprite(a,d,h));else if(f){if(s.getTriggersVisible())if(y){let e=y[0],[i,a]=e,[n,s]=o.isoToPixelCoords(i,a,0);t.drawPolygon(y,"rgba(0, 0, 0, 0.5)"),t.drawText(r||"",n,s,{align:"center",color:l.colors.PINK,size:12})}else t.drawSprite(a,d,h),t.drawText(r||"",d+16,h,{align:"center",color:l.colors.PINK,size:12})}else n?t.drawAnimation(n,d,h):a?(t.drawSprite(a,d,h),m&&t.drawSprite("indicator",d,u-3)):c&&t.drawCharacter(c)}for(let e=0;e<n.length;e++)t.drawParticle(n[e]);a.restore()}})),define("model/sprite",["require","exports","view/draw","model/canvas","model/room"],(function(e,t,i,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSprite=t.loadImageAsSpritesheet=t.loadImageAsSprite=t.loadTiles=t.SpriteModification=t.loadImage=t.createSprite=void 0;let a={};var n;window.sprites=a,t.createSprite=(e,t,i,r,o)=>[e,null!=t?t:0,null!=i?i:0,null!=r?r:e.width,null!=o?o:e.height],t.loadImage=async e=>new Promise((t,i)=>{let r=new Image;r.onload=()=>{t(r)},r.onerror=()=>{i("Failed to load image: "+e)},r.src="res/"+e}),function(e){e.NORMAL="",e.FLIPPED="_f",e.ROT90="_r1",e.ROT180="_r2",e.ROT270="_r3"}(n=t.SpriteModification||(t.SpriteModification={}));let l=e=>{let[t,i,o,a]=r.createCanvas(e.width,e.height),n=o/2,l=a/2;return i.translate(n,l),i.rotate(Math.PI/2),i.drawImage(e,-n,-l),t},s=e=>{let[,,,t,o]=e,[a,n]=r.createCanvas(t,o);return i.drawSprite(e,0,0,1,n),a},c=(e,i,o,a,c)=>{let d=(i,r,o,a,n,l)=>e[i]=t.createSprite(r,o,a,n,l),h=(e,t,i)=>{let r=e;for(let e=0;e<i;e++)r=l(r);d(`${t}_r${i}`,r,0,0,a,c)},u=(e,t,o)=>{let l=d(e,i,o*a,t*c,a,c);h(s(l),e,1),h(s(l),e,2),h(s(l),e,3),d(`${e}${n.FLIPPED}`,(e=>{let[t,i,o]=r.createCanvas(e.width,e.height);return i.translate(o,0),i.scale(-1,1),i.drawImage(e,0,0),t})(s(l)),0,0,a,c)},m=i.width/a,p=i.height/c;for(let e=0;e<p;e++)for(let t=0;t<m;t++){let i=`${o}_${e*m+t}`;1!==m||1!==p||i.includes("512")||(i=o),u(i,e,t)}};t.loadTiles=async()=>{let e=await t.loadImage("battle-terrain1.png");c(a,e,"terrain",o.TILE_WIDTH,o.TILE_HEIGHT)},t.loadImageAsSprite=async(e,i)=>{let r=t.getSprite(i);if(r)return r[0];{a[i]=[new Image,0,0,0,0];let r=await t.loadImage(e);return c(a,r,i,r.width,r.height),r}},t.loadImageAsSpritesheet=async(e,i,r,o)=>{let n=t.getSprite(i);if(n)return n[0];{a[i]=[new Image,0,0,0,0];let n=await t.loadImage(e);return c(a,n,i,r,o),c(a,n,i,n.width,n.height),n}};let d=t.createSprite(document.createElement("canvas"),0,0,1,1);t.getSprite=e=>0===e.indexOf("invisible")?d:a[e]})),define("controller/res-loader",["require","exports","model/animation","model/sprite"],(function(e,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadRes=void 0;class o{async processAssetFile(e){let t=[],o=async function(e){throw Error("cannot load sounds yet: "+e)},a=async function(e){let[,t,i,o,a]=e;if("invisible"!==t)return await r.loadImageAsSpritesheet(i,t,+o,+a)},n=function(e,t){let i=e[1],r=e[2].trim();t.name=i,t.loop=r.indexOf("true")>=0},l=function(e,t){t.sprites.push({name:e[1],duration:parseFloat(e[2])})},s=e.split("\n"),c=new i.Animation(!1),d=function(){i.createAnimationBuilder(c.name,function(e){let t=new i.Animation(e.loop);return e.sprites.forEach(e=>{t.addSprite({name:e.name,duration:e.duration,opacity:e.opacity,offsetX:e.offsetX,offsetY:e.offsetY})}),t}.bind(this,c)),i.createAnimationBuilder(c.name+r.SpriteModification.FLIPPED,function(e){let t=new i.Animation(e.loop);return e.sprites.forEach(e=>{t.addSprite({name:e.name+r.SpriteModification.FLIPPED,duration:e.duration,opacity:e.opacity,offsetX:e.offsetX,offsetY:e.offsetY})}),t}.bind(this,c))};for(let e of s){let r=e.split(","),[s]=r;if("AnimSprite"!==s)switch(c&&d(),s){case"Picture":t.push(()=>a(r));break;case"Animation":c=new i.Animation(!1),n(r,c);continue;case"Sound":t.push(()=>o(r))}else{if(!c)throw console.error("Error reading res.txt, AnimSprite without Anim",r),Error("display loading error");l(r,c)}}c&&d();for(let e=0;e<t.length;e++)await t[e]()}async loadAssets(e){await this.processAssetFile(e)}}t.loadRes=async()=>{let e=await(await fetch("res/res.txt")).text();return(new o).loadAssets(e)}})),define("db/index",["require","exports","db/enemies","db/encounters","db/characters","db/overworlds","db/tiles"],(function(e,t,i,r,o,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=async()=>{i.init(),r.init(),o.init(),n.init(),await a.init()}})),define("main",["require","exports","model/sprite","controller/loop","controller/res-loader","model/canvas","controller/events","view/ui","view/hooks","model/scene","db/index","lib/rpgscript","model/generics","db/overworlds","controller/overworld-management","model/player","model/character"],(function(e,t,i,o,a,n,l,s,c,d,h,u,m,p,g,f,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.main=void 0,h=r(h),t.main=async()=>{s.mountUi(),d.initScene();let e=m.getCurrentScene();await u.loadRPGScript("floor1",e),await u.loadRPGScript("test",e),await u.loadRPGScript("example",e),await a.loadRes(),await h.default(),await i.loadTiles(),n.getCanvas(),n.setDrawScale(2),l.initEvents(),c.initHooks(),o.runMainLoop();let t=f.playerCreate({name:"Ada",spriteBase:"ada",facing:y.Facing.LEFT_DOWN,animationState:y.AnimationState.IDLE,skills:[]}),r=function(e){let t={},i=("?"===e[0]?e.substr(1):e).split("&");for(let e=0;e<i.length;e++){let r=i[e].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||"")}return t}(window.location.search);if(r.room){let e=p.get(r.room);g.initiateOverworld(t,e)}else g.initiateOverworld(t,p.get("TEST2"))}})),define("lib/picostyle",["require","exports"],(function(e,t){"use strict";function i(e,t){var i="p"+a++,r=t+i;return e.forEach((function(e){if(/^@/.test(e)){var t=e.indexOf("{")+1;e=e.slice(0,t)+r+e.slice(t)}else e=r+e;n.insertRule(e,n.cssRules.length)})),i}function r(e,t){return t+"{"+e+"}"}function o(e,t){var i=[""];for(var a in t=t||0,e){var n=e[a];a=a.replace(/[A-Z]/g,"-$&").toLowerCase(),n.sub||Array.isArray(n)?(n=Array.isArray(n)?n:[n]).forEach((function(e){return i[0]+=a+":"+e+";"})):(a=a.replace(/&/g,""),i.push(r(o(n,!/^@/.test(a)).join(""),a)))}return t||(i[0]=r(i[0],"")),i}Object.defineProperty(t,"__esModule",{value:!0}),t.keyframes=void 0;var a=0,n=document.head.appendChild(document.createElement("style")).sheet;t.default=function(e,t){function r(t){return function(i){return function(r,o){o=(r=r||{}).children||o;var n="function"==typeof i?i(r):i;return r.class=[a(n),r.class].filter(Boolean).join(" "),e(t,r,o)}}}function a(e){var t=o(e),r=t.join("");return n[r]||(n[r]=i(t,"."))}var n={};return(t=t||{}).returnObject?{style:r,css:a}:r},t.keyframes=function(e){return i([r(o(e,1).join(""),"")],"@keyframes ")}})),define("lib/preact-hooks",["require","exports","preact"],(function(e,t,i){"use strict";function r(e,t){i.options.__h&&i.options.__h(p,e,f||t),f=0;var r=p.__H||(p.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function o(e){return f=1,a(u,e)}function a(e,t,i){var o=r(m++,2);return o.t=e,o.__c||(o.__=[i?i(t):u(void 0,t),function(e){var t=o.t(o.__[0],e);o.__[0]!==t&&(o.__=[t,o.__[1]],o.__c.setState({}))}],o.__c=p),o.__}function n(e,t){var o=r(m++,4);!i.options.__s&&h(o.__H,t)&&(o.__=e,o.__H=t,p.__h.push(o))}function l(e,t){var i=r(m++,7);return h(i.__H,t)&&(i.__=e(),i.__H=t,i.__h=e),i.__}function s(){y.forEach((function(e){if(e.__P)try{e.__H.__h.forEach(c),e.__H.__h.forEach(d),e.__H.__h=[]}catch(t){e.__H.__h=[],i.options.__e(t,e.__v)}})),y=[]}function c(e){var t=p;"function"==typeof e.__c&&e.__c(),p=t}function d(e){var t=p;e.__c=e.__(),p=t}function h(e,t){return!e||e.length!==t.length||t.some((function(t,i){return t!==e[i]}))}function u(e,t){return"function"==typeof t?t(e):t}Object.defineProperty(t,"__esModule",{value:!0}),t.useErrorBoundary=t.useDebugValue=t.useContext=t.useCallback=t.useMemo=t.useImperativeHandle=t.useRef=t.useLayoutEffect=t.useEffect=t.useReducer=t.useState=void 0;var m,p,g,f=0,y=[],w=i.options.__b,_=i.options.__r,v=i.options.diffed,b=i.options.__c,C=i.options.unmount;t.useState=o,t.useReducer=a,t.useEffect=function(e,t){var o=r(m++,3);!i.options.__s&&h(o.__H,t)&&(o.__=e,o.__H=t,p.__H.__h.push(o))},t.useLayoutEffect=n,t.useRef=function(e){return f=5,l((function(){return{current:e}}),[])},t.useImperativeHandle=function(e,t,i){f=6,n((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==i?i:i.concat(e))},t.useMemo=l,t.useCallback=function(e,t){return f=8,l((function(){return e}),t)},t.useContext=function(e){var t=p.context[e.__c],i=r(m++,9);return i.__c=e,t?(null==i.__&&(i.__=!0,t.sub(p)),t.props.value):e.__},t.useDebugValue=function(e,t){i.options.useDebugValue&&i.options.useDebugValue(t?t(e):e)},t.useErrorBoundary=function(e){var t=r(m++,10),i=o();return t.__=e,p.componentDidCatch||(p.componentDidCatch=function(e){t.__&&t.__(e),i[1](e)}),[i[0],function(){i[1](void 0)}]},i.options.__b=function(e){p=null,w&&w(e)},i.options.__r=function(e){_&&_(e),m=0;var t=(p=e.__c).__H;t&&(t.__h.forEach(c),t.__h.forEach(d),t.__h=[])},i.options.diffed=function(e){v&&v(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==y.push(t)&&g===i.options.requestAnimationFrame||((g=i.options.requestAnimationFrame)||function(e){var t,i=function(){clearTimeout(r),T&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(i,100);T&&(t=requestAnimationFrame(i))})(s)),p=void 0},i.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(c),e.__h=e.__h.filter((function(e){return!e.__||d(e)}))}catch(r){t.some((function(e){e.__h&&(e.__h=[])})),t=[],i.options.__e(r,e.__v)}})),b&&b(e,t)},i.options.unmount=function(e){C&&C(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(c)}catch(e){i.options.__e(e,t.__v)}};var T="function"==typeof requestAnimationFrame})),define("lib/preact",["require","exports"],(function(e,t){"use strict";function i(e,t){for(var i in t)e[i]=t[i];return e}function r(e){var t=e.parentNode;t&&t.removeChild(e)}function o(e,t,i){var r,o,n,l=arguments,s={};for(n in t)"key"==n?r=t[n]:"ref"==n?o=t[n]:s[n]=t[n];if(arguments.length>3)for(i=[i],n=3;n<arguments.length;n++)i.push(l[n]);if(null!=i&&(s.children=i),"function"==typeof e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===s[n]&&(s[n]=e.defaultProps[n]);return a(e,s,r,o,null)}function a(e,t,i,r,o){var a={type:e,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++E.__v:o};return null!=E.vnode&&E.vnode(a),a}function n(e){return e.children}function l(e,t){this.props=e,this.context=t}function s(e,t){if(null==t)return e.__?s(e.__,e.__.__k.indexOf(e)+1):null;for(var i;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e)return i.__e;return"function"==typeof e.type?s(e):null}function c(e){var t,i;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e){e.__e=e.__c.base=i.__e;break}return c(e)}}function d(e){(!e.__d&&(e.__d=!0)&&I.push(e)&&!h.__r++||P!==E.debounceRendering)&&((P=E.debounceRendering)||k)(h)}function h(){for(var e;h.__r=I.length;)e=I.sort((function(e,t){return e.__v.__b-t.__v.__b})),I=[],e.some((function(e){var t,r,o,a,n,l,d;e.__d&&(l=(n=(t=e).__v).__e,(d=t.__P)&&(r=[],(o=i({},n)).__v=n.__v+1,a=_(d,n,o,t.__n,void 0!==d.ownerSVGElement,null!=n.__h?[l]:null,r,null==l?s(n):l,n.__h),v(r,n),a!=l&&c(n)))}))}function u(e,t,i,o,l,c,d,h,u,p){var g,f,y,w,v,b,S,x=o&&o.__k||L,E=x.length;for(u==D&&(u=null!=d?d[0]:E?s(o,0):null),i.__k=[],g=0;g<t.length;g++)if(null!=(w=i.__k[g]=null==(w=t[g])||"boolean"==typeof w?null:"string"==typeof w||"number"==typeof w?a(null,w,null,null,w):Array.isArray(w)?a(n,{children:w},null,null,null):null!=w.__e||null!=w.__c?a(w.type,w.props,w.key,null,w.__v):w)){if(w.__=i,w.__b=i.__b+1,null===(y=x[g])||y&&w.key==y.key&&w.type===y.type)x[g]=void 0;else for(f=0;f<E;f++){if((y=x[f])&&w.key==y.key&&w.type===y.type){x[f]=void 0;break}y=null}v=_(e,w,y=y||D,l,c,d,h,u,p),(f=w.ref)&&y.ref!=f&&(S||(S=[]),y.ref&&S.push(y.ref,null,w),S.push(f,w.__c||v,w)),null!=v?(null==b&&(b=v),u=m(e,w,y,x,d,v,u),p||"option"!=i.type?"function"==typeof i.type&&(i.__d=u):e.value=""):u&&y.__e==u&&u.parentNode!=e&&(u=s(y))}if(i.__e=b,null!=d&&"function"!=typeof i.type)for(g=d.length;g--;)null!=d[g]&&r(d[g]);for(g=E;g--;)null!=x[g]&&T(x[g],x[g]);if(S)for(g=0;g<S.length;g++)C(S[g],S[++g],S[++g])}function m(e,t,i,r,o,a,n){var l,s,c;if(void 0!==t.__d)l=t.__d,t.__d=void 0;else if(o==i||a!=n||null==a.parentNode)e:if(null==n||n.parentNode!==e)e.appendChild(a),l=null;else{for(s=n,c=0;(s=s.nextSibling)&&c<r.length;c+=2)if(s==a)break e;e.insertBefore(a,n),l=n}return void 0!==l?l:a.nextSibling}function p(e,t,i){"-"===t[0]?e.setProperty(t,i):e[t]=null==i?"":"number"!=typeof i||M.test(t)?i:i+"px"}function g(e,t,i,r,o){var a,n,l;if(o&&"className"==t&&(t="class"),"style"===t)if("string"==typeof i)e.style.cssText=i;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)i&&t in i||p(e.style,t,"");if(i)for(t in i)r&&i[t]===r[t]||p(e.style,t,i[t])}else"o"===t[0]&&"n"===t[1]?(a=t!==(t=t.replace(/Capture$/,"")),(n=t.toLowerCase())in e&&(t=n),t=t.slice(2),e.l||(e.l={}),e.l[t+a]=i,l=a?y:f,i?r||e.addEventListener(t,l,a):e.removeEventListener(t,l,a)):"list"!==t&&"tagName"!==t&&"form"!==t&&"type"!==t&&"size"!==t&&"download"!==t&&"href"!==t&&!o&&t in e?e[t]=null==i?"":i:"function"!=typeof i&&"dangerouslySetInnerHTML"!==t&&(t!==(t=t.replace(/xlink:?/,""))?null==i||!1===i?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),i):null==i||!1===i&&!/^ar/.test(t)?e.removeAttribute(t):e.setAttribute(t,i))}function f(e){this.l[e.type+!1](E.event?E.event(e):e)}function y(e){this.l[e.type+!0](E.event?E.event(e):e)}function w(e,t,i){var r,o;for(r=0;r<e.__k.length;r++)(o=e.__k[r])&&(o.__=e,o.__e&&("function"==typeof o.type&&o.__k.length>1&&w(o,t,i),t=m(i,o,o,e.__k,null,o.__e,t),"function"==typeof e.type&&(e.__d=t)))}function _(e,t,r,o,a,s,c,d,h){var m,p,g,f,y,_,v,C,T,x,A,I=t.type;if(void 0!==t.constructor)return null;null!=r.__h&&(h=r.__h,d=t.__e=r.__e,t.__h=null,s=[d]),(m=E.__b)&&m(t);try{e:if("function"==typeof I){if(C=t.props,T=(m=I.contextType)&&o[m.__c],x=m?T?T.props.value:m.__:o,r.__c?v=(p=t.__c=r.__c).__=p.__E:("prototype"in I&&I.prototype.render?t.__c=p=new I(C,x):(t.__c=p=new l(C,x),p.constructor=I,p.render=S),T&&T.sub(p),p.props=C,p.state||(p.state={}),p.context=x,p.__n=o,g=p.__d=!0,p.__h=[]),null==p.__s&&(p.__s=p.state),null!=I.getDerivedStateFromProps&&(p.__s==p.state&&(p.__s=i({},p.__s)),i(p.__s,I.getDerivedStateFromProps(C,p.__s))),f=p.props,y=p.state,g)null==I.getDerivedStateFromProps&&null!=p.componentWillMount&&p.componentWillMount(),null!=p.componentDidMount&&p.__h.push(p.componentDidMount);else{if(null==I.getDerivedStateFromProps&&C!==f&&null!=p.componentWillReceiveProps&&p.componentWillReceiveProps(C,x),!p.__e&&null!=p.shouldComponentUpdate&&!1===p.shouldComponentUpdate(C,p.__s,x)||t.__v===r.__v){p.props=C,p.state=p.__s,t.__v!==r.__v&&(p.__d=!1),p.__v=t,t.__e=r.__e,t.__k=r.__k,p.__h.length&&c.push(p),w(t,d,e);break e}null!=p.componentWillUpdate&&p.componentWillUpdate(C,p.__s,x),null!=p.componentDidUpdate&&p.__h.push((function(){p.componentDidUpdate(f,y,_)}))}p.context=x,p.props=C,p.state=p.__s,(m=E.__r)&&m(t),p.__d=!1,p.__v=t,p.__P=e,m=p.render(p.props,p.state,p.context),p.state=p.__s,null!=p.getChildContext&&(o=i(i({},o),p.getChildContext())),g||null==p.getSnapshotBeforeUpdate||(_=p.getSnapshotBeforeUpdate(f,y)),u(e,Array.isArray(A=null!=m&&m.type==n&&null==m.key?m.props.children:m)?A:[A],t,r,o,a,s,c,d,h),p.base=t.__e,t.__h=null,p.__h.length&&c.push(p),v&&(p.__E=p.__=null),p.__e=!1}else null==s&&t.__v===r.__v?(t.__k=r.__k,t.__e=r.__e):t.__e=b(r.__e,t,r,o,a,s,c,h);(m=E.diffed)&&m(t)}catch(e){t.__v=null,(h||null!=s)&&(t.__e=d,t.__h=!!h,s[s.indexOf(d)]=null),E.__e(e,t,r)}return t.__e}function v(e,t){E.__c&&E.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){E.__e(e,t.__v)}}))}function b(e,t,i,r,o,a,n,l){var s,c,d,h,m,p=i.props,f=t.props;if(o="svg"===t.type||o,null!=a)for(s=0;s<a.length;s++)if(null!=(c=a[s])&&((null===t.type?3===c.nodeType:c.localName===t.type)||e==c)){e=c,a[s]=null;break}if(null==e){if(null===t.type)return document.createTextNode(f);e=o?document.createElementNS("http://www.w3.org/2000/svg",t.type):document.createElement(t.type,f.is&&{is:f.is}),a=null,l=!1}if(null===t.type)p===f||l&&e.data===f||(e.data=f);else{if(null!=a&&(a=L.slice.call(e.childNodes)),d=(p=i.props||D).dangerouslySetInnerHTML,h=f.dangerouslySetInnerHTML,!l){if(null!=a)for(p={},m=0;m<e.attributes.length;m++)p[e.attributes[m].name]=e.attributes[m].value;(h||d)&&(h&&(d&&h.__html==d.__html||h.__html===e.innerHTML)||(e.innerHTML=h&&h.__html||""))}(function(e,t,i,r,o){var a;for(a in i)"children"===a||"key"===a||a in t||g(e,a,null,i[a],r);for(a in t)o&&"function"!=typeof t[a]||"children"===a||"key"===a||"value"===a||"checked"===a||i[a]===t[a]||g(e,a,t[a],i[a],r)})(e,f,p,o,l),h?t.__k=[]:u(e,Array.isArray(s=t.props.children)?s:[s],t,i,r,"foreignObject"!==t.type&&o,a,n,D,l),l||("value"in f&&void 0!==(s=f.value)&&(s!==e.value||"progress"===t.type&&!s)&&g(e,"value",s,p.value,!1),"checked"in f&&void 0!==(s=f.checked)&&s!==e.checked&&g(e,"checked",s,p.checked,!1))}return e}function C(e,t,i){try{"function"==typeof e?e(t):e.current=t}catch(e){E.__e(e,i)}}function T(e,t,i){var o,a,n;if(E.unmount&&E.unmount(e),(o=e.ref)&&(o.current&&o.current!==e.__e||C(o,null,t)),i||"function"==typeof e.type||(i=null!=(a=e.__e)),e.__e=e.__d=void 0,null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){E.__e(e,t)}o.base=o.__P=null}if(o=e.__k)for(n=0;n<o.length;n++)o[n]&&T(o[n],t,i);null!=a&&r(a)}function S(e,t,i){return this.constructor(e,i)}function x(e,t,i){var r,a,l;E.__&&E.__(e,t),a=(r=i===R)?null:i&&i.__k||t.__k,e=o(n,null,[e]),l=[],_(t,(r?t:i||t).__k=e,a||D,D,void 0!==t.ownerSVGElement,i&&!r?[i]:a?null:t.childNodes.length?L.slice.call(t.childNodes):null,l,i||D,r),v(l,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.options=t.__u=t.toChildArray=t.createContext=t.cloneElement=t.Component=t.isValidElement=t.createRef=t.Fragment=t.h=t.createElement=t.hydrate=t.render=void 0;var E,A,I,k,P,R,O,D={},L=[],M=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;t.options=E,t.isValidElement=A,t.createElement=o,t.h=o,t.createRef=function(){return{current:null}},t.Fragment=n,t.Component=l,t.toChildArray=function e(t,i){return i=i||[],null==t||"boolean"==typeof t||(Array.isArray(t)?t.some((function(t){e(t,i)})):i.push(t)),i},t.__u=T,t.render=x,t.hydrate=function(e,t){x(e,t,R)},t.cloneElement=function(e,t,r){var o,n,l,s=arguments,c=i({},e.props);for(l in t)"key"==l?o=t[l]:"ref"==l?n=t[l]:c[l]=t[l];if(arguments.length>3)for(r=[r],l=3;l<arguments.length;l++)r.push(s[l]);return null!=r&&(c.children=r),a(e.type,c,o||e.key,n||e.ref,null)},t.createContext=function(e,t){var i={__c:t="__cC"+O++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e,i,r){return this.getChildContext||(i=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&i.some(d)},this.sub=function(e){i.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){i.splice(i.indexOf(e),1),t&&t.call(e)}}),e.children}};return i.Provider.__=i.Consumer.contextType=i},t.options=E={__e:function(e,t){for(var i,r,o,a=t.__h;t=t.__;)if((i=t.__c)&&!i.__)try{if((r=i.constructor)&&null!=r.getDerivedStateFromError&&(i.setState(r.getDerivedStateFromError(e)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e),o=i.__d),o)return t.__h=a,i.__E=i}catch(t){e=t}throw e},__v:0},t.isValidElement=A=function(e){return null!=e&&void 0===e.constructor},l.prototype.setState=function(e,t){var r;r=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=i({},this.state),"function"==typeof e&&(e=e(i({},r),this.props)),e&&i(r,e),null!=e&&this.__v&&(t&&this.__h.push(t),d(this))},l.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),d(this))},l.prototype.render=n,I=[],k="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,h.__r=0,R=D,O=0}))})();